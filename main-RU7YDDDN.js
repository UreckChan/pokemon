import{$ as gt,A as Db,B as Tb,C as Dn,D as di,E as zd,F as Pc,G as vy,H as bb,I as Sb,J as q,K as Jt,L as ut,M as wy,N as Ab,O as kc,P as ue,Q as un,R as Kd,S as Ey,T as Tn,U as hi,V as ls,W as Qd,X as Yd,Y as xb,Z as To,_ as Zd,a as x,aa as Tt,b as de,c as gy,d as _,e as mb,f as $d,g as yb,h as _b,i as b,j as Do,k as Hd,l as vb,m as wb,n as my,o as pt,p as qd,q as Nc,r as yy,s as Eb,t as ar,u as _y,v as Gd,w as Ib,x as Cb,y as Wd,z as nt}from"./chunk-CYQ6L5LV.js";var Mb=null;var Iy=1,Cy=Symbol("SIGNAL");function Ee(t){let e=Mb;return Mb=t,e}var Rb={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function KV(t){if(!(by(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Iy)){if(!t.producerMustRecompute(t)&&!Dy(t)){t.dirty=!1,t.lastCleanEpoch=Iy;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Iy}}function Nb(t){return t&&(t.nextProducerIndex=0),Ee(t)}function Pb(t,e){if(Ee(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(by(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Ty(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Dy(t){Xd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(KV(n),r!==n.version))return!0}return!1}function kb(t){if(Xd(t),by(t))for(let e=0;e<t.producerNode.length;e++)Ty(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Ty(t,e){if(QV(t),Xd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Ty(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Xd(i),i.producerIndexOfThis[r]=e}}function by(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Xd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function QV(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function YV(){throw new Error}var ZV=YV;function Ob(t){ZV=t}function z(t){return typeof t=="function"}function bo(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Jd=bo(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function ds(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Ye=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(z(r))try{r()}catch(s){e=s instanceof Jd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Fb(s)}catch(o){e=e??[],o instanceof Jd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Jd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Fb(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&ds(n,e)}remove(e){let{_finalizers:n}=this;n&&ds(n,e),e instanceof t&&e._removeParent(this)}};Ye.EMPTY=(()=>{let t=new Ye;return t.closed=!0,t})();var Sy=Ye.EMPTY;function eh(t){return t instanceof Ye||t&&"closed"in t&&z(t.remove)&&z(t.add)&&z(t.unsubscribe)}function Fb(t){z(t)?t():t.unsubscribe()}var Gn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var So={setTimeout(t,e,...n){let{delegate:r}=So;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=So;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function th(t){So.setTimeout(()=>{let{onUnhandledError:e}=Gn;if(e)e(t);else throw t})}function hs(){}var Vb=Ay("C",void 0,void 0);function Lb(t){return Ay("E",void 0,t)}function jb(t){return Ay("N",t,void 0)}function Ay(t,e,n){return{kind:t,value:e,error:n}}var fs=null;function Ao(t){if(Gn.useDeprecatedSynchronousErrorHandling){let e=!fs;if(e&&(fs={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=fs;if(fs=null,n)throw r}}else t()}function Ub(t){Gn.useDeprecatedSynchronousErrorHandling&&fs&&(fs.errorThrown=!0,fs.error=t)}var ps=class extends Ye{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,eh(e)&&e.add(this)):this.destination=eL}static create(e,n,r){return new Br(e,n,r)}next(e){this.isStopped?My(jb(e),this):this._next(e)}error(e){this.isStopped?My(Lb(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?My(Vb,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},XV=Function.prototype.bind;function xy(t,e){return XV.call(t,e)}var Ry=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){nh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){nh(r)}else nh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){nh(n)}}},Br=class extends ps{constructor(e,n,r){super();let i;if(z(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Gn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&xy(e.next,s),error:e.error&&xy(e.error,s),complete:e.complete&&xy(e.complete,s)}):i=e}this.destination=new Ry(i)}};function nh(t){Gn.useDeprecatedSynchronousErrorHandling?Ub(t):th(t)}function JV(t){throw t}function My(t,e){let{onStoppedNotification:n}=Gn;n&&So.setTimeout(()=>n(t,e))}var eL={closed:!0,next:hs,error:JV,complete:hs};var xo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function bt(t){return t}function Ny(...t){return Py(t)}function Py(t){return t.length===0?bt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ne=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=nL(n)?n:new Br(n,r,i);return Ao(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=Bb(r),new r((i,s)=>{let o=new Br({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[xo](){return this}pipe(...n){return Py(n)(this)}toPromise(n){return n=Bb(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function Bb(t){var e;return(e=t??Gn.Promise)!==null&&e!==void 0?e:Promise}function tL(t){return t&&z(t.next)&&z(t.error)&&z(t.complete)}function nL(t){return t&&t instanceof ps||tL(t)&&eh(t)}function ky(t){return z(t?.lift)}function Z(t){return e=>{if(ky(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function K(t,e,n,r,i){return new Oy(t,e,n,r,i)}var Oy=class extends ps{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Mo(){return Z((t,e)=>{let n=null;t._refCount++;let r=K(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Ro=class extends ne{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,ky(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ye;let n=this.getSubject();e.add(this.source.subscribe(K(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ye.EMPTY)}return e}refCount(){return Mo()(this)}};var $b=bo(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var qe=(()=>{class t extends ne{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new rh(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new $b}next(n){Ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Sy:(this.currentObservers=null,s.push(n),new Ye(()=>{this.currentObservers=null,ds(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ne;return n.source=this,n}}return t.create=(e,n)=>new rh(e,n),t})(),rh=class extends qe{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Sy}};var St=class extends qe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Oc={now(){return(Oc.delegate||Date).now()},delegate:void 0};var ih=class extends qe{constructor(e=1/0,n=1/0,r=Oc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var sh=class extends Ye{constructor(e,n){super()}schedule(e,n=0){return this}};var Fc={setInterval(t,e,...n){let{delegate:r}=Fc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Fc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var No=class extends sh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Fc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Fc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,ds(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Po=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Po.now=Oc.now;var ko=class extends Po{constructor(e,n=Po.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var gs=new ko(No);var oh=class extends No{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var ah=class extends ko{};var Fy=new ah(oh);var Lt=new ne(t=>t.complete());function Hb(t){return t&&z(t.schedule)}function Vy(t){return t[t.length-1]}function Oo(t){return z(Vy(t))?t.pop():void 0}function cr(t){return Hb(Vy(t))?t.pop():void 0}function qb(t,e){return typeof Vy(t)=="number"?t.pop():e}var ch=t=>t&&typeof t.length=="number"&&typeof t!="function";function uh(t){return z(t?.then)}function lh(t){return z(t[xo])}function dh(t){return Symbol.asyncIterator&&z(t?.[Symbol.asyncIterator])}function hh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function rL(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var fh=rL();function ph(t){return z(t?.[fh])}function gh(t){return yb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield $d(n.read());if(i)return yield $d(void 0);yield yield $d(r)}}finally{n.releaseLock()}})}function mh(t){return z(t?.getReader)}function be(t){if(t instanceof ne)return t;if(t!=null){if(lh(t))return iL(t);if(ch(t))return sL(t);if(uh(t))return oL(t);if(dh(t))return Gb(t);if(ph(t))return aL(t);if(mh(t))return cL(t)}throw hh(t)}function iL(t){return new ne(e=>{let n=t[xo]();if(z(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function sL(t){return new ne(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function oL(t){return new ne(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,th)})}function aL(t){return new ne(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function Gb(t){return new ne(e=>{uL(t,e).catch(n=>e.error(n))})}function cL(t){return Gb(gh(t))}function uL(t,e){var n,r,i,s;return mb(this,void 0,void 0,function*(){try{for(n=_b(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function en(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function ln(t,e=0){return Z((n,r)=>{n.subscribe(K(r,i=>en(r,t,()=>r.next(i),e),()=>en(r,t,()=>r.complete(),e),i=>en(r,t,()=>r.error(i),e)))})}function bn(t,e=0){return Z((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function Wb(t,e){return be(t).pipe(bn(e),ln(e))}function zb(t,e){return be(t).pipe(bn(e),ln(e))}function Kb(t,e){return new ne(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Qb(t,e){return new ne(n=>{let r;return en(n,e,()=>{r=t[fh](),en(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>z(r?.return)&&r.return()})}function yh(t,e){if(!t)throw new Error("Iterable cannot be null");return new ne(n=>{en(n,e,()=>{let r=t[Symbol.asyncIterator]();en(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function Yb(t,e){return yh(gh(t),e)}function Zb(t,e){if(t!=null){if(lh(t))return Wb(t,e);if(ch(t))return Kb(t,e);if(uh(t))return zb(t,e);if(dh(t))return yh(t,e);if(ph(t))return Qb(t,e);if(mh(t))return Yb(t,e)}throw hh(t)}function _e(t,e){return e?Zb(t,e):be(t)}function U(...t){let e=cr(t);return _e(t,e)}function Fo(t,e){let n=z(t)?t:()=>t,r=i=>i.error(n());return new ne(e?i=>e.schedule(r,0,i):r)}function Ly(t){return!!t&&(t instanceof ne||z(t.lift)&&z(t.subscribe))}var $r=bo(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function j(t,e){return Z((n,r)=>{let i=0;n.subscribe(K(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:lL}=Array;function dL(t,e){return lL(e)?t(...e):t(e)}function _h(t){return j(e=>dL(t,e))}var{isArray:hL}=Array,{getPrototypeOf:fL,prototype:pL,keys:gL}=Object;function vh(t){if(t.length===1){let e=t[0];if(hL(e))return{args:e,keys:null};if(mL(e)){let n=gL(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function mL(t){return t&&typeof t=="object"&&fL(t)===pL}function wh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Vc(...t){let e=cr(t),n=Oo(t),{args:r,keys:i}=vh(t);if(r.length===0)return _e([],e);let s=new ne(yL(r,e,i?o=>wh(i,o):bt));return n?s.pipe(_h(n)):s}function yL(t,e,n=bt){return r=>{Xb(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)Xb(e,()=>{let u=_e(t[c],e),l=!1;u.subscribe(K(r,d=>{s[c]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function Xb(t,e,n){t?en(n,t,e):e()}function Jb(t,e,n,r,i,s,o,a){let c=[],u=0,l=0,d=!1,h=()=>{d&&!c.length&&!u&&e.complete()},f=g=>u<r?p(g):c.push(g),p=g=>{s&&e.next(g),u++;let v=!1;be(n(g,l++)).subscribe(K(e,T=>{i?.(T),s?f(T):e.next(T)},()=>{v=!0},void 0,()=>{if(v)try{for(u--;c.length&&u<r;){let T=c.shift();o?en(e,o,()=>p(T)):p(T)}h()}catch(T){e.error(T)}}))};return t.subscribe(K(e,f,()=>{d=!0,h()})),()=>{a?.()}}function rt(t,e,n=1/0){return z(e)?rt((r,i)=>j((s,o)=>e(r,s,i,o))(be(t(r,i))),n):(typeof e=="number"&&(n=e),Z((r,i)=>Jb(r,i,t,n)))}function fi(t=1/0){return rt(bt,t)}function eS(){return fi(1)}function Vo(...t){return eS()(_e(t,cr(t)))}function Eh(t){return new ne(e=>{be(t()).subscribe(e)})}function jy(...t){let e=Oo(t),{args:n,keys:r}=vh(t),i=new ne(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,u=o;for(let l=0;l<o;l++){let d=!1;be(n[l]).subscribe(K(s,h=>{d||(d=!0,u--),a[l]=h},()=>c--,void 0,()=>{(!c||!d)&&(u||s.next(r?wh(r,a):a),s.complete())}))}});return e?i.pipe(_h(e)):i}function Lo(...t){let e=cr(t),n=qb(t,1/0),r=t;return r.length?r.length===1?be(r[0]):fi(n)(_e(r,e)):Lt}function At(t,e){return Z((n,r)=>{let i=0;n.subscribe(K(r,s=>t.call(e,s,i++)&&r.next(s)))})}function pi(t){return Z((e,n)=>{let r=null,i=!1,s;r=e.subscribe(K(n,void 0,void 0,o=>{s=be(t(o,pi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function tS(t,e,n,r,i){return(s,o)=>{let a=n,c=e,u=0;s.subscribe(K(o,l=>{let d=u++;c=a?t(c,l,d):(a=!0,l),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function ms(t,e){return z(e)?rt(t,e,1):rt(t,1)}function gi(t){return Z((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Hr(t){return t<=0?()=>Lt:Z((e,n)=>{let r=0;e.subscribe(K(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Uy(t){return j(()=>t)}function Lc(t,e=bt){return t=t??_L,Z((n,r)=>{let i,s=!0;n.subscribe(K(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function _L(t,e){return t===e}function Ih(t=vL){return Z((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function vL(){return new $r}function jc(t){return Z((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Sn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?At((i,s)=>t(i,s,r)):bt,Hr(1),n?gi(e):Ih(()=>new $r))}function jo(t){return t<=0?()=>Lt:Z((e,n)=>{let r=[];e.subscribe(K(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function By(t,e){let n=arguments.length>=2;return r=>r.pipe(t?At((i,s)=>t(i,s,r)):bt,jo(1),n?gi(e):Ih(()=>new $r))}function Uc(){return Z((t,e)=>{let n,r=!1;t.subscribe(K(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function ur(t,e){return Z(tS(t,e,arguments.length>=2,!0))}function Bc(t={}){let{connector:e=()=>new qe,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,u=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return Z((g,v)=>{u++,!d&&!l&&h();let T=c=c??e();v.add(()=>{u--,u===0&&!d&&!l&&(a=$y(p,i))}),T.subscribe(v),!o&&u>0&&(o=new Br({next:F=>T.next(F),error:F=>{d=!0,h(),a=$y(f,n,F),T.error(F)},complete:()=>{l=!0,h(),a=$y(f,r),T.complete()}}),be(g).subscribe(o))})(s)}}function $y(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Br({next:()=>{r.unsubscribe(),t()}});return be(e(...n)).subscribe(r)}function Ch(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Bc({connector:()=>new ih(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Hy(t){return Z((e,n)=>{let r=!1,i=0;e.subscribe(K(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function ys(...t){let e=cr(t);return Z((n,r)=>{(e?Vo(t,n,e):Vo(t,n)).subscribe(r)})}function Ve(t,e){return Z((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(K(r,c=>{i?.unsubscribe();let u=0,l=s++;be(t(c,l)).subscribe(i=K(r,d=>r.next(e?e(c,d,l,u++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Dh(t,e){return z(e)?Ve(()=>t,e):Ve(()=>t)}function qy(t){return Z((e,n)=>{be(t).subscribe(K(n,()=>n.complete(),hs)),!n.closed&&e.subscribe(n)})}function lt(t,e,n){let r=z(t)||e||n?{next:t,error:e,complete:n}:t;return r?Z((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(K(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):bt}function Gy(...t){let e=Oo(t);return Z((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)be(t[c]).subscribe(K(r,u=>{s[c]=u,!a&&!o[c]&&(o[c]=!0,(a=o.every(bt))&&(o=null))},hs));n.subscribe(K(r,c=>{if(a){let u=[c,...s];r.next(e?e(...u):u)}}))})}var BS="https://g.co/ng/security#xss",$=class extends Error{constructor(e,n){super(z_(e,n)),this.code=e}};function z_(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function eu(t){return{toString:t}.toString()}var Th="__parameters__";function wL(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function $S(t,e,n){return eu(()=>{let r=wL(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,l){let d=c.hasOwnProperty(Th)?c[Th]:Object.defineProperty(c,Th,{value:[]})[Th];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var Ut=globalThis;function Se(t){for(let e in t)if(t[e]===Se)return e;throw Error("Could not find renamed property on target object.")}function EL(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function tn(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(tn).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function nS(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var IL=Se({__forward_ref__:Se});function Rn(t){return t.__forward_ref__=Rn,t.toString=function(){return tn(this())},t}function jt(t){return HS(t)?t():t}function HS(t){return typeof t=="function"&&t.hasOwnProperty(IL)&&t.__forward_ref__===Rn}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Le(t){return{providers:t.providers||[],imports:t.imports||[]}}function sf(t){return rS(t,GS)||rS(t,WS)}function qS(t){return sf(t)!==null}function rS(t,e){return t.hasOwnProperty(e)?t[e]:null}function CL(t){let e=t&&(t[GS]||t[WS]);return e||null}function iS(t){return t&&(t.hasOwnProperty(sS)||t.hasOwnProperty(DL))?t[sS]:null}var GS=Se({\u0275prov:Se}),sS=Se({\u0275inj:Se}),WS=Se({ngInjectableDef:Se}),DL=Se({ngInjectorDef:Se}),k=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function zS(t){return t&&!!t.\u0275providers}var TL=Se({\u0275cmp:Se}),bL=Se({\u0275dir:Se}),SL=Se({\u0275pipe:Se}),AL=Se({\u0275mod:Se}),Oh=Se({\u0275fac:Se}),$c=Se({__NG_ELEMENT_ID__:Se}),oS=Se({__NG_ENV_ID__:Se});function of(t){return typeof t=="string"?t:t==null?"":String(t)}function xL(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():of(t)}function ML(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new $(-200,t)}function K_(t,e){throw new $(-201,!1)}var ae=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ae||{}),o_;function KS(){return o_}function An(t){let e=o_;return o_=t,e}function QS(t,e,n){let r=sf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ae.Optional)return null;if(e!==void 0)return e;K_(t,"Injector")}var RL={},qc=RL,a_="__NG_DI_FLAG__",Fh="ngTempTokenPath",NL="ngTokenPath",PL=/\n/gm,kL="\u0275",aS="__source",qo;function OL(){return qo}function mi(t){let e=qo;return qo=t,e}function FL(t,e=ae.Default){if(qo===void 0)throw new $(-203,!1);return qo===null?QS(t,void 0,e):qo.get(t,e&ae.Optional?null:void 0,e)}function E(t,e=ae.Default){return(KS()||FL)(jt(t),e)}function P(t,e=ae.Default){return E(t,af(e))}function af(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function c_(t){let e=[];for(let n=0;n<t.length;n++){let r=jt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=ae.Default;for(let o=0;o<r.length;o++){let a=r[o],c=VL(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(E(i,s))}else e.push(E(r))}return e}function YS(t,e){return t[a_]=e,t.prototype[a_]=e,t}function VL(t){return t[a_]}function LL(t,e,n,r){let i=t[Fh];throw e[aS]&&i.unshift(e[aS]),t.message=jL(`
`+t.message,i,n,r),t[NL]=i,t[Fh]=null,t}function jL(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==kL?t.slice(2):t;let i=tn(e);if(Array.isArray(e))i=e.map(tn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):tn(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(PL,`
  `)}`}var nn=YS($S("Optional"),8);var Q_=YS($S("SkipSelf"),4);function Wo(t,e){let n=t.hasOwnProperty(Oh);return n?t[Oh]:null}function Y_(t,e){t.forEach(n=>Array.isArray(n)?Y_(n,e):e(n))}function ZS(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Vh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function UL(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function BL(t,e,n){let r=tu(t,e);return r>=0?t[r|1]=n:(r=~r,UL(t,r,e,n)),r}function Wy(t,e){let n=tu(t,e);if(n>=0)return t[n|1]}function tu(t,e){return $L(t,e,1)}function $L(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var zo={},xn=[],Ko=new k(""),XS=new k("",-1),JS=new k(""),Lh=class{get(e,n=qc){if(n===qc){let r=new Error(`NullInjectorError: No provider for ${tn(e)}!`);throw r.name="NullInjectorError",r}return n}},eA=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(eA||{}),hr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(hr||{}),Bt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Bt||{});function HL(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function u_(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];qL(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function tA(t){return t===3||t===4||t===6}function qL(t){return t.charCodeAt(0)===64}function Gc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?cS(t,n,i,null,e[++r]):cS(t,n,i,null,null))}}return t}function cS(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var nA="ng-template";function GL(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&HL(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(Z_(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function Z_(t){return t.type===4&&t.value!==nA}function WL(t,e,n){let r=t.type===4&&!n?nA:t.value;return e===r}function zL(t,e,n){let r=4,i=t.attrs,s=i!==null?YL(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Wn(r)&&!Wn(c))return!1;if(o&&Wn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!WL(t,c,n)||c===""&&e.length===1){if(Wn(r))return!1;o=!0}}else if(r&8){if(i===null||!GL(t,i,c,n)){if(Wn(r))return!1;o=!0}}else{let u=e[++a],l=KL(c,i,Z_(t),n);if(l===-1){if(Wn(r))return!1;o=!0;continue}if(u!==""){let d;if(l>s?d="":d=i[l+1].toLowerCase(),r&2&&u!==d){if(Wn(r))return!1;o=!0}}}}return Wn(r)||o}function Wn(t){return(t&1)===0}function KL(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return ZL(e,t)}function QL(t,e,n=!1){for(let r=0;r<e.length;r++)if(zL(t,e[r],n))return!0;return!1}function YL(t){for(let e=0;e<t.length;e++){let n=t[e];if(tA(n))return e}return t.length}function ZL(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function uS(t,e){return t?":not("+e.trim()+")":e}function XL(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Wn(o)&&(e+=uS(s,i),i=""),r=o,s=s||!Wn(r);n++}return i!==""&&(e+=uS(s,i)),e}function JL(t){return t.map(XL).join(",")}function e2(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Wn(i))break;i=s}r++}return{attrs:e,classes:n}}function rn(t){return eu(()=>{let e=aA(t),n=de(x({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===eA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||hr.Emulated,styles:t.styles||xn,_:null,schemas:t.schemas||null,tView:null,id:""});cA(n);let r=t.dependencies;return n.directiveDefs=dS(r,!1),n.pipeDefs=dS(r,!0),n.id=r2(n),n})}function t2(t){return _i(t)||rA(t)}function n2(t){return t!==null}function je(t){return eu(()=>({type:t.type,bootstrap:t.bootstrap||xn,declarations:t.declarations||xn,imports:t.imports||xn,exports:t.exports||xn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function lS(t,e){if(t==null)return zo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Bt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Bt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function Ze(t){return eu(()=>{let e=aA(t);return cA(e),e})}function _i(t){return t[TL]||null}function rA(t){return t[bL]||null}function iA(t){return t[SL]||null}function sA(t){let e=_i(t)||rA(t)||iA(t);return e!==null?e.standalone:!1}function oA(t,e){let n=t[AL]||null;if(!n&&e===!0)throw new Error(`Type ${tn(t)} does not have '\u0275mod' property.`);return n}function aA(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||zo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||xn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:lS(t.inputs,e),outputs:lS(t.outputs),debugInfo:null}}function cA(t){t.features?.forEach(e=>e(t))}function dS(t,e){if(!t)return null;let n=e?iA:t2;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(n2)}function r2(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function i2(...t){return{\u0275providers:uA(!0,t),\u0275fromNgModule:!0}}function uA(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Y_(e,o=>{let a=o;l_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&lA(i,s),n}function lA(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];X_(i,s=>{e(s,r)})}}function l_(t,e,n,r){if(t=jt(t),!t)return!1;let i=null,s=iS(t),o=!s&&_i(t);if(!s&&!o){let c=t.ngModule;if(s=iS(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)l_(u,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{Y_(s.imports,l=>{l_(l,e,n,r)&&(u||=[],u.push(l))})}finally{}u!==void 0&&lA(u,e)}if(!a){let u=Wo(i)||(()=>new i);e({provide:i,useFactory:u,deps:xn},i),e({provide:JS,useValue:i,multi:!0},i),e({provide:Ko,useValue:()=>E(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=t;X_(c,l=>{e(l,u)})}}else return!1;return i!==t&&t.providers!==void 0}function X_(t,e){for(let n of t)zS(n)&&(n=n.\u0275providers),Array.isArray(n)?X_(n,e):e(n)}var s2=Se({provide:String,useValue:Se});function dA(t){return t!==null&&typeof t=="object"&&s2 in t}function o2(t){return!!(t&&t.useExisting)}function a2(t){return!!(t&&t.useFactory)}function Qo(t){return typeof t=="function"}function c2(t){return!!t.useClass}var cf=new k(""),Mh={},u2={},zy;function J_(){return zy===void 0&&(zy=new Lh),zy}var dn=class{},Wc=class extends dn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,h_(e,o=>this.processProvider(o)),this.records.set(XS,Uo(void 0,this)),i.has("environment")&&this.records.set(dn,Uo(void 0,this));let s=this.records.get(cf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(JS,xn,ae.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ee(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ee(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=mi(this),r=An(void 0),i;try{return e()}finally{mi(n),An(r)}}get(e,n=qc,r=ae.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(oS))return e[oS](this);r=af(r);let i,s=mi(this),o=An(void 0);try{if(!(r&ae.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=p2(e)&&sf(e);u&&this.injectableDefInScope(u)?c=Uo(d_(e),Mh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ae.Self?J_():this.parent;return n=r&ae.Optional&&n===qc?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Fh]=a[Fh]||[]).unshift(tn(e)),s)throw a;return LL(a,e,"R3InjectorError",this.source)}else throw a}finally{An(o),mi(s)}}resolveInjectorInitializers(){let e=Ee(null),n=mi(this),r=An(void 0),i;try{let s=this.get(Ko,xn,ae.Self);for(let o of s)o()}finally{mi(n),An(r),Ee(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(tn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){e=jt(e);let n=Qo(e)?e:jt(e&&e.provide),r=d2(e);if(!Qo(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Uo(void 0,Mh,!0),i.factory=()=>c_(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=Ee(null);try{return n.value===Mh&&(n.value=u2,n.value=n.factory()),typeof n.value=="object"&&n.value&&f2(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{Ee(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=jt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function d_(t){let e=sf(t),n=e!==null?e.factory:Wo(t);if(n!==null)return n;if(t instanceof k)throw new $(204,!1);if(t instanceof Function)return l2(t);throw new $(204,!1)}function l2(t){if(t.length>0)throw new $(204,!1);let n=CL(t);return n!==null?()=>n.factory(t):()=>new t}function d2(t){if(dA(t))return Uo(void 0,t.useValue);{let e=hA(t);return Uo(e,Mh)}}function hA(t,e,n){let r;if(Qo(t)){let i=jt(t);return Wo(i)||d_(i)}else if(dA(t))r=()=>jt(t.useValue);else if(a2(t))r=()=>t.useFactory(...c_(t.deps||[]));else if(o2(t))r=()=>E(jt(t.useExisting));else{let i=jt(t&&(t.useClass||t.provide));if(h2(t))r=()=>new i(...c_(t.deps));else return Wo(i)||d_(i)}return r}function Uo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function h2(t){return!!t.deps}function f2(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function p2(t){return typeof t=="function"||typeof t=="object"&&t instanceof k}function h_(t,e){for(let n of t)Array.isArray(n)?h_(n,e):n&&zS(n)?h_(n.\u0275providers,e):e(n)}function Wr(t,e){t instanceof Wc&&t.assertNotDestroyed();let n,r=mi(t),i=An(void 0);try{return e()}finally{mi(r),An(i)}}function fA(){return KS()!==void 0||OL()!=null}function g2(t){if(!fA())throw new $(-203,!1)}function m2(t){let e=Ut.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function y2(t){return typeof t=="function"}var zr=0,pe=1,G=2,Nt=3,zn=4,Yn=5,jh=6,zc=7,Kn=8,Yo=9,Qn=10,ht=11,Kc=12,hS=13,ta=14,fr=15,uf=16,Bo=17,Zo=18,lf=19,pA=20,yi=21,Ky=22,ws=23,vi=25,gA=1;var Es=7,Uh=8,Bh=9,Mn=10,ev=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(ev||{});function _s(t){return Array.isArray(t)&&typeof t[gA]=="object"}function Kr(t){return Array.isArray(t)&&t[gA]===!0}function mA(t){return(t.flags&4)!==0}function df(t){return t.componentOffset>-1}function tv(t){return(t.flags&1)===1}function wi(t){return!!t.template}function _2(t){return(t[G]&512)!==0}var f_=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function yA(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Ii(){return _A}function _A(t){return t.type.prototype.ngOnChanges&&(t.setInput=w2),v2}Ii.ngInherit=!0;function v2(){let t=wA(this),e=t?.current;if(e){let n=t.previous;if(n===zo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function w2(t,e,n,r,i){let s=this.declaredInputs[r],o=wA(t)||E2(t,{previous:zo,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new f_(u&&u.currentValue,n,c===zo),yA(t,e,i,n)}var vA="__ngSimpleChanges__";function wA(t){return t[vA]||null}function E2(t,e){return t[vA]=e}var fS=null;var lr=function(t,e,n){fS?.(t,e,n)},I2="svg",C2="math",D2=!1;function T2(){return D2}function pr(t){for(;Array.isArray(t);)t=t[zr];return t}function EA(t,e){return pr(e[t])}function Nn(t,e){return pr(e[t.index])}function IA(t,e){return t.data[e]}function Ci(t,e){let n=e[t];return _s(n)?n:n[zr]}function nv(t){return(t[G]&128)===128}function b2(t){return Kr(t[Nt])}function $h(t,e){return e==null?null:t[e]}function CA(t){t[Bo]=0}function S2(t){t[G]&1024||(t[G]|=1024,nv(t)&&Qc(t))}function A2(t,e){for(;t>0;)e=e[ta],t--;return e}function rv(t){return!!(t[G]&9216||t[ws]?.dirty)}function p_(t){t[Qn].changeDetectionScheduler?.notify(1),rv(t)?Qc(t):t[G]&64&&(T2()?(t[G]|=1024,Qc(t)):t[Qn].changeDetectionScheduler?.notify())}function Qc(t){t[Qn].changeDetectionScheduler?.notify();let e=Yc(t);for(;e!==null&&!(e[G]&8192||(e[G]|=8192,!nv(e)));)e=Yc(e)}function DA(t,e){if((t[G]&256)===256)throw new $(911,!1);t[yi]===null&&(t[yi]=[]),t[yi].push(e)}function x2(t,e){if(t[yi]===null)return;let n=t[yi].indexOf(e);n!==-1&&t[yi].splice(n,1)}function Yc(t){let e=t[Nt];return Kr(e)?e[Nt]:e}var he={lFrame:RA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function M2(){return he.lFrame.elementDepthCount}function R2(){he.lFrame.elementDepthCount++}function N2(){he.lFrame.elementDepthCount--}function TA(){return he.bindingsEnabled}function P2(){return he.skipHydrationRootTNode!==null}function k2(t){return he.skipHydrationRootTNode===t}function O2(){he.skipHydrationRootTNode=null}function Pe(){return he.lFrame.lView}function hn(){return he.lFrame.tView}function na(t){return he.lFrame.contextLView=t,t[Kn]}function ra(t){return he.lFrame.contextLView=null,t}function sn(){let t=bA();for(;t!==null&&t.type===64;)t=t.parent;return t}function bA(){return he.lFrame.currentTNode}function F2(){let t=he.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function nu(t,e){let n=he.lFrame;n.currentTNode=t,n.isParent=e}function SA(){return he.lFrame.isParent}function V2(){he.lFrame.isParent=!1}function L2(t){return he.lFrame.bindingIndex=t}function hf(){return he.lFrame.bindingIndex++}function j2(t){let e=he.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function U2(){return he.lFrame.inI18n}function B2(t,e){let n=he.lFrame;n.bindingIndex=n.bindingRootIndex=t,g_(e)}function $2(){return he.lFrame.currentDirectiveIndex}function g_(t){he.lFrame.currentDirectiveIndex=t}function H2(t){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function AA(t){he.lFrame.currentQueryIndex=t}function q2(t){let e=t[pe];return e.type===2?e.declTNode:e.type===1?t[Yn]:null}function xA(t,e,n){if(n&ae.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ae.Host);)if(i=q2(s),i===null||(s=s[ta],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=he.lFrame=MA();return r.currentTNode=e,r.lView=t,!0}function iv(t){let e=MA(),n=t[pe];he.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function MA(){let t=he.lFrame,e=t===null?null:t.child;return e===null?RA(t):e}function RA(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function NA(){let t=he.lFrame;return he.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var PA=NA;function sv(){let t=NA();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function G2(t){return(he.lFrame.contextLView=A2(t,he.lFrame.contextLView))[Kn]}function ia(){return he.lFrame.selectedIndex}function Is(t){he.lFrame.selectedIndex=t}function ov(){let t=he.lFrame;return IA(t.tView,t.selectedIndex)}function W2(){return he.lFrame.currentNamespace}var kA=!0;function av(){return kA}function cv(t){kA=t}function z2(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=_A(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function uv(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),u&&((t.viewHooks??=[]).push(n,u),(t.viewCheckHooks??=[]).push(n,u)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function Rh(t,e,n){OA(t,e,3,n)}function Nh(t,e,n,r){(t[G]&3)===n&&OA(t,e,n,r)}function Qy(t,e){let n=t[G];(n&3)===e&&(n&=16383,n+=1,t[G]=n)}function OA(t,e,n,r){let i=r!==void 0?t[Bo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[Bo]+=65536),(a<s||s==-1)&&(K2(t,n,e,c),t[Bo]=(t[Bo]&4294901760)+c+2),c++}function pS(t,e){lr(4,t,e);let n=Ee(null);try{e.call(t)}finally{Ee(n),lr(5,t,e)}}function K2(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[G]>>14<t[Bo]>>16&&(t[G]&3)===e&&(t[G]+=16384,pS(a,s)):pS(a,s)}var Go=-1,Cs=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function Q2(t){return t instanceof Cs}function Y2(t){return(t.flags&8)!==0}function Z2(t){return(t.flags&16)!==0}function FA(t){return t!==Go}function Hh(t){return t&32767}function X2(t){return t>>16}function qh(t,e){let n=X2(t),r=e;for(;n>0;)r=r[ta],n--;return r}var m_=!0;function gS(t){let e=m_;return m_=t,e}var J2=256,VA=J2-1,LA=5,ej=0,dr={};function tj(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty($c)&&(r=n[$c]),r==null&&(r=n[$c]=ej++);let i=r&VA,s=1<<i;e.data[t+(i>>LA)]|=s}function Gh(t,e){let n=jA(t,e);if(n!==-1)return n;let r=e[pe];r.firstCreatePass&&(t.injectorIndex=e.length,Yy(r.data,t),Yy(e,null),Yy(r.blueprint,null));let i=lv(t,e),s=t.injectorIndex;if(FA(i)){let o=Hh(i),a=qh(i,e),c=a[pe].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function Yy(t,e){t.push(0,0,0,0,0,0,0,0,e)}function jA(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function lv(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=qA(i),r===null)return Go;if(n++,i=i[ta],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Go}function y_(t,e,n){tj(t,e,n)}function nj(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(tA(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function UA(t,e,n){if(n&ae.Optional||t!==void 0)return t;K_(e,"NodeInjector")}function BA(t,e,n,r){if(n&ae.Optional&&r===void 0&&(r=null),!(n&(ae.Self|ae.Host))){let i=t[Yo],s=An(void 0);try{return i?i.get(e,r,n&ae.Optional):QS(e,r,n&ae.Optional)}finally{An(s)}}return UA(r,e,n)}function $A(t,e,n,r=ae.Default,i){if(t!==null){if(e[G]&2048&&!(r&ae.Self)){let o=aj(t,e,n,r,dr);if(o!==dr)return o}let s=HA(t,e,n,r,dr);if(s!==dr)return s}return BA(e,n,r,i)}function HA(t,e,n,r,i){let s=sj(n);if(typeof s=="function"){if(!xA(e,t,r))return r&ae.Host?UA(i,n,r):BA(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ae.Optional))K_(n);else return o}finally{PA()}}else if(typeof s=="number"){let o=null,a=jA(t,e),c=Go,u=r&ae.Host?e[fr][Yn]:null;for((a===-1||r&ae.SkipSelf)&&(c=a===-1?lv(t,e):e[a+8],c===Go||!yS(r,!1)?a=-1:(o=e[pe],a=Hh(c),e=qh(c,e)));a!==-1;){let l=e[pe];if(mS(s,a,l.data)){let d=rj(a,e,n,o,r,u);if(d!==dr)return d}c=e[a+8],c!==Go&&yS(r,e[pe].data[a+8]===u)&&mS(s,a,e)?(o=l,a=Hh(c),e=qh(c,e)):a=-1}}return i}function rj(t,e,n,r,i,s){let o=e[pe],a=o.data[t+8],c=r==null?df(a)&&m_:r!=o&&(a.type&3)!==0,u=i&ae.Host&&s===a,l=ij(a,o,n,c,u);return l!==null?Xo(e,o,l,a):dr}function ij(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,u=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:u;for(let f=d;f<h;f++){let p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=o[c];if(f&&wi(f)&&f.type===n)return c}return null}function Xo(t,e,n,r){let i=t[n],s=e.data;if(Q2(i)){let o=i;o.resolving&&ML(xL(s[n]));let a=gS(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?An(o.injectImpl):null,l=xA(t,r,ae.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&z2(n,s[n],e)}finally{u!==null&&An(u),gS(a),o.resolving=!1,PA()}}return i}function sj(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty($c)?t[$c]:void 0;return typeof e=="number"?e>=0?e&VA:oj:e}function mS(t,e,n){let r=1<<t;return!!(n[e+(t>>LA)]&r)}function yS(t,e){return!(t&ae.Self)&&!(t&ae.Host&&e)}var vs=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return $A(this._tNode,this._lView,e,af(r),n)}};function oj(){return new vs(sn(),Pe())}function Pn(t){return eu(()=>{let e=t.prototype.constructor,n=e[Oh]||__(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[Oh]||__(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function __(t){return HS(t)?()=>{let e=__(jt(t));return e&&e()}:Wo(t)}function aj(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[G]&2048&&!(o[G]&512);){let a=HA(s,o,n,r|ae.Self,dr);if(a!==dr)return a;let c=s.parent;if(!c){let u=o[pA];if(u){let l=u.get(n,dr,r);if(l!==dr)return l}c=qA(o),o=o[ta]}s=c}return i}function qA(t){let e=t[pe],n=e.type;return n===2?e.declTNode:n===1?t[Yn]:null}function dv(t){return nj(sn(),t)}function _S(t,e=null,n=null,r){let i=GA(t,e,n,r);return i.resolveInjectorInitializers(),i}function GA(t,e=null,n=null,r,i=new Set){let s=[n||xn,i2(t)];return r=r||(typeof t=="object"?void 0:tn(t)),new Wc(s,e||J_(),r||null,i)}var $t=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return _S({name:""},i,r,"");{let s=r.name??"";return _S({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=qc,e.NULL=new Lh,e.\u0275prov=V({token:e,providedIn:"any",factory:()=>E(XS)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var cj="ngOriginalError";function Zy(t){return t[cj]}var gr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Zy(e);for(;n&&Zy(n);)n=Zy(n);return n||null}},WA=new k("",{providedIn:"root",factory:()=>P(gr).handleError.bind(void 0)}),hv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=uj,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),v_=class extends hv{constructor(e){super(),this._lView=e}onDestroy(e){return DA(this._lView,e),()=>x2(this._lView,e)}};function uj(){return new v_(Pe())}function lj(){return ff(sn(),Pe())}function ff(t,e){return new mr(Nn(t,e))}var mr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=lj;let t=e;return t})();var w_=class extends qe{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,fA()&&(this.destroyRef=P(hv,{optional:!0})??void 0)}emit(e){let n=Ee(null);try{super.next(e)}finally{Ee(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Xy(s),i&&(i=Xy(i)),o&&(o=Xy(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ye&&e.add(a),a}};function Xy(t){return e=>{setTimeout(t,void 0,e)}}var dt=w_;function zA(t){return(t.flags&128)===128}var KA=new Map,dj=0;function hj(){return dj++}function fj(t){KA.set(t[lf],t)}function pj(t){KA.delete(t[lf])}var vS="__ngContext__";function Ds(t,e){_s(e)?(t[vS]=e[lf],fj(e)):t[vS]=e}function QA(t){return ZA(t[Kc])}function YA(t){return ZA(t[zn])}function ZA(t){for(;t!==null&&!Kr(t);)t=t[zn];return t}var E_;function XA(t){E_=t}function gj(){if(E_!==void 0)return E_;if(typeof document<"u")return document;throw new $(210,!1)}var pf=new k("",{providedIn:"root",factory:()=>mj}),mj="ng",fv=new k(""),mt=new k("",{providedIn:"platform",factory:()=>"unknown"});var pv=new k("",{providedIn:"root",factory:()=>gj().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var yj="h",_j="b";var vj=()=>null;function gv(t,e,n=!1){return vj(t,e,n)}var JA=!1,wj=new k("",{providedIn:"root",factory:()=>JA});var bh;function Ej(){if(bh===void 0&&(bh=null,Ut.trustedTypes))try{bh=Ut.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return bh}function wS(t){return Ej()?.createScriptURL(t)||t}var Wh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${BS})`}};function ru(t){return t instanceof Wh?t.changingThisBreaksApplicationSecurity:t}function mv(t,e){let n=Ij(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${BS})`)}return n===e}function Ij(t){return t instanceof Wh&&t.getTypeName()||null}var Cj=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function ex(t){return t=String(t),t.match(Cj)?t:"unsafe:"+t}var gf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(gf||{});function Dj(t){let e=nx();return e?e.sanitize(gf.URL,t)||"":mv(t,"URL")?ru(t):ex(of(t))}function Tj(t){let e=nx();if(e)return wS(e.sanitize(gf.RESOURCE_URL,t)||"");if(mv(t,"ResourceURL"))return wS(ru(t));throw new $(904,!1)}function bj(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?Tj:Dj}function tx(t,e,n){return bj(e,n)(t)}function nx(){let t=Pe();return t&&t[Qn].sanitizer}function rx(t){return t instanceof Function?t():t}function Sj(t){return(t??P($t)).get(mt)==="browser"}var qr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(qr||{}),Aj;function yv(t,e){return Aj(t,e)}function $o(t,e,n,r,i){if(r!=null){let s,o=!1;Kr(r)?s=r:_s(r)&&(o=!0,r=r[zr]);let a=pr(r);t===0&&n!==null?i==null?cx(e,n,a):zh(e,n,a,i||null,!0):t===1&&n!==null?zh(e,n,a,i||null,!0):t===2?Gj(e,a,o):t===3&&e.destroyNode(a),s!=null&&zj(e,t,s,n,i)}}function xj(t,e){return t.createText(e)}function Mj(t,e,n){t.setValue(e,n)}function ix(t,e,n){return t.createElement(e,n)}function Rj(t,e){sx(t,e),e[zr]=null,e[Yn]=null}function Nj(t,e,n,r,i,s){r[zr]=i,r[Yn]=e,mf(t,r,n,1,i,s)}function sx(t,e){e[Qn].changeDetectionScheduler?.notify(1),mf(t,e,e[ht],2,null,null)}function Pj(t){let e=t[Kc];if(!e)return Jy(t[pe],t);for(;e;){let n=null;if(_s(e))n=e[Kc];else{let r=e[Mn];r&&(n=r)}if(!n){for(;e&&!e[zn]&&e!==t;)_s(e)&&Jy(e[pe],e),e=e[Nt];e===null&&(e=t),_s(e)&&Jy(e[pe],e),n=e&&e[zn]}e=n}}function kj(t,e,n,r){let i=Mn+r,s=n.length;r>0&&(n[i-1][zn]=e),r<s-Mn?(e[zn]=n[i],ZS(n,Mn+r,e)):(n.push(e),e[zn]=null),e[Nt]=n;let o=e[uf];o!==null&&n!==o&&Oj(o,e);let a=e[Zo];a!==null&&a.insertView(t),p_(e),e[G]|=128}function Oj(t,e){let n=t[Bh],i=e[Nt][Nt][fr];e[fr]!==i&&(t[G]|=ev.HasTransplantedViews),n===null?t[Bh]=[e]:n.push(e)}function ox(t,e){let n=t[Bh],r=n.indexOf(e);n.splice(r,1)}function I_(t,e){if(t.length<=Mn)return;let n=Mn+e,r=t[n];if(r){let i=r[uf];i!==null&&i!==t&&ox(i,r),e>0&&(t[n-1][zn]=r[zn]);let s=Vh(t,Mn+e);Rj(r[pe],r);let o=s[Zo];o!==null&&o.detachView(s[pe]),r[Nt]=null,r[zn]=null,r[G]&=-129}return r}function ax(t,e){if(!(e[G]&256)){let n=e[ht];n.destroyNode&&mf(t,e,n,3,null,null),Pj(e)}}function Jy(t,e){if(e[G]&256)return;let n=Ee(null);try{e[G]&=-129,e[G]|=256,e[ws]&&kb(e[ws]),Vj(t,e),Fj(t,e),e[pe].type===1&&e[ht].destroy();let r=e[uf];if(r!==null&&Kr(e[Nt])){r!==e[Nt]&&ox(r,e);let i=e[Zo];i!==null&&i.detachView(t)}pj(e)}finally{Ee(n)}}function Fj(t,e){let n=t.cleanup,r=e[zc];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[zc]=null);let i=e[yi];if(i!==null){e[yi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function Vj(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Cs)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];lr(4,a,c);try{c.call(a)}finally{lr(5,a,c)}}else{lr(4,i,s);try{s.call(i)}finally{lr(5,i,s)}}}}}function Lj(t,e,n){return jj(t,e.parent,n)}function jj(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[zr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===hr.None||s===hr.Emulated)return null}return Nn(r,n)}}function zh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function cx(t,e,n){t.appendChild(e,n)}function ES(t,e,n,r,i){r!==null?zh(t,e,n,r,i):cx(t,e,n)}function Uj(t,e,n,r){t.removeChild(e,n,r)}function _v(t,e){return t.parentNode(e)}function Bj(t,e){return t.nextSibling(e)}function $j(t,e,n){return qj(t,e,n)}function Hj(t,e,n){return t.type&40?Nn(t,n):null}var qj=Hj,IS;function vv(t,e,n,r){let i=Lj(t,r,e),s=e[ht],o=r.parent||e[Yn],a=$j(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)ES(s,i,n[c],a,!1);else ES(s,i,n,a,!1);IS!==void 0&&IS(s,r,e,n,i)}function Ph(t,e){if(e!==null){let n=e.type;if(n&3)return Nn(e,t);if(n&4)return C_(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Ph(t,r);{let i=t[e.index];return Kr(i)?C_(-1,i):pr(i)}}else{if(n&32)return yv(e,t)()||pr(t[e.index]);{let r=ux(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Yc(t[fr]);return Ph(i,r)}else return Ph(t,e.next)}}}return null}function ux(t,e){if(e!==null){let r=t[fr][Yn],i=e.projection;return r.projection[i]}return null}function C_(t,e){let n=Mn+t+1;if(n<e.length){let r=e[n],i=r[pe].firstChild;if(i!==null)return Ph(r,i)}return e[Es]}function Gj(t,e,n){let r=_v(t,e);r&&Uj(t,r,e,n)}function wv(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&Ds(pr(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)wv(t,e,n.child,r,i,s,!1),$o(e,t,i,a,s);else if(c&32){let u=yv(n,r),l;for(;l=u();)$o(e,t,i,l,s);$o(e,t,i,a,s)}else c&16?Wj(t,e,r,n,i,s):$o(e,t,i,a,s);n=o?n.projectionNext:n.next}}function mf(t,e,n,r,i,s){wv(n,r,t.firstChild,e,i,s,!1)}function Wj(t,e,n,r,i,s){let o=n[fr],c=o[Yn].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let l=c[u];$o(e,t,i,l,s)}else{let u=c,l=o[Nt];zA(r)&&(u.flags|=128),wv(t,e,u,l,i,s,!0)}}function zj(t,e,n,r,i){let s=n[Es],o=pr(n);s!==o&&$o(e,t,r,s,i);for(let a=Mn;a<n.length;a++){let c=n[a];mf(c[pe],c,t,e,r,s)}}function Kj(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:qr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=qr.Important),t.setStyle(n,r,i,s))}}function Qj(t,e,n){t.setAttribute(e,"style",n)}function lx(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function dx(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&u_(t,e,r),i!==null&&lx(t,e,i),s!==null&&Qj(t,e,s)}var sa={};function X(t=1){hx(hn(),Pe(),ia()+t,!1)}function hx(t,e,n,r){if(!r)if((e[G]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Rh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Nh(e,s,0,n)}Is(n)}function le(t,e=ae.Default){let n=Pe();if(n===null)return E(t,e);let r=sn();return $A(r,n,jt(t),e)}function fx(){let t="invalid";throw new Error(t)}function px(t,e,n,r,i,s){let o=Ee(null);try{let a=null;i&Bt.SignalBased&&(a=e[r][Cy]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Bt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):yA(e,a,r,s)}finally{Ee(o)}}function Yj(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Is(~i);else{let s=i,o=n[++r],a=n[++r];B2(o,s);let c=e[s];a(2,c)}}}finally{Is(-1)}}function yf(t,e,n,r,i,s,o,a,c,u,l){let d=e.blueprint.slice();return d[zr]=i,d[G]=r|4|128|8|64,(u!==null||t&&t[G]&2048)&&(d[G]|=2048),CA(d),d[Nt]=d[ta]=t,d[Kn]=n,d[Qn]=o||t&&t[Qn],d[ht]=a||t&&t[ht],d[Yo]=c||t&&t[Yo]||null,d[Yn]=s,d[lf]=hj(),d[jh]=l,d[pA]=u,d[fr]=e.type==2?t[fr]:d,d}function _f(t,e,n,r,i){let s=t.data[e];if(s===null)s=Zj(t,e,n,r,i),U2()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=F2();s.injectorIndex=o===null?-1:o.injectorIndex}return nu(s,!0),s}function Zj(t,e,n,r,i){let s=bA(),o=SA(),a=o?s:s&&s.parent,c=t.data[e]=nU(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function gx(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function mx(t,e,n,r,i){let s=ia(),o=r&2;try{Is(-1),o&&e.length>vi&&hx(t,e,vi,!1),lr(o?2:0,i),n(r,i)}finally{Is(s),lr(o?3:1,i)}}function yx(t,e,n){if(mA(e)){let r=Ee(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{Ee(r)}}}function _x(t,e,n){TA()&&(cU(t,e,n,Nn(n,e)),(n.flags&64)===64&&Dx(t,e,n))}function vx(t,e,n=Nn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function wx(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=Ev(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function Ev(t,e,n,r,i,s,o,a,c,u,l){let d=vi+r,h=d+i,f=Xj(d,h),p=typeof u=="function"?u():u;return f[pe]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:l}}function Xj(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:sa);return n}function Jj(t,e,n,r){let s=r.get(wj,JA)||n===hr.ShadowDom,o=t.selectRootElement(e,s);return eU(o),o}function eU(t){tU(t)}var tU=()=>null;function nU(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return P2()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function CS(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Bt.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}t===0?DS(r,n,u,a,c):DS(r,n,u,a)}return r}function DS(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function rU(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,u=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=CS(0,d.inputs,l,c,f),u=CS(1,d.outputs,l,u,p);let g=c!==null&&o!==null&&!Z_(e)?vU(c,l,o):null;a.push(g)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function iU(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function Ex(t,e,n,r,i,s,o,a){let c=Nn(e,n),u=e.inputs,l;!a&&u!=null&&(l=u[r])?(Iv(t,n,l,r,i),df(e)&&sU(n,e.index)):e.type&3?(r=iU(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function sU(t,e){let n=Ci(e,t);n[G]&16||(n[G]|=64)}function Ix(t,e,n,r){if(TA()){let i=r===null?null:{"":-1},s=lU(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Cx(t,e,n,o,i,a),i&&dU(n,r,i)}n.mergedAttrs=Gc(n.mergedAttrs,n.attrs)}function Cx(t,e,n,r,i,s){for(let u=0;u<r.length;u++)y_(Gh(n,e),t,r[u].type);fU(n,t.data.length,r.length);for(let u=0;u<r.length;u++){let l=r[u];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,c=gx(t,e,r.length,null);for(let u=0;u<r.length;u++){let l=r[u];n.mergedAttrs=Gc(n.mergedAttrs,l.hostAttrs),pU(t,n,e,c,l),hU(c,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}rU(t,n,s)}function oU(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;aU(o)!=a&&o.push(a),o.push(n,r,s)}}function aU(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function cU(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;df(n)&&gU(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Gh(n,e),Ds(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],u=Xo(e,t,a,n);if(Ds(u,e),o!==null&&_U(e,a-i,u,c,n,o),wi(c)){let l=Ci(n.index,e);l[Kn]=Xo(e,t,a,n)}}}function Dx(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=$2();try{Is(s);for(let a=r;a<i;a++){let c=t.data[a],u=e[a];g_(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&uU(c,u)}}finally{Is(-1),g_(o)}}function uU(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function lU(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(QL(e,o.selectors,!1))if(r||(r=[]),wi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;D_(t,e,c)}else r.unshift(o),D_(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function D_(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function dU(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}}function hU(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;wi(e)&&(n[""]=t)}}function fU(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function pU(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Wo(i.type,!0)),o=new Cs(s,wi(i),le);t.blueprint[r]=o,n[r]=o,oU(t,e,r,gx(t,n,i.hostVars,sa),i)}function gU(t,e,n){let r=Nn(e,t),i=wx(n),s=t[Qn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=vf(t,yf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function mU(t,e,n,r,i,s){let o=Nn(t,e);yU(e[ht],o,s,t.value,n,r,i)}function yU(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?of(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function _U(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],l=o[a++],d=o[a++];px(r,n,c,u,l,d)}}function vU(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function Tx(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function bx(t,e){let n=t.contentQueries;if(n!==null){let r=Ee(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];AA(s),a.contentQueries(2,e[o],o)}}}finally{Ee(r)}}}function vf(t,e){return t[Kc]?t[hS][zn]=e:t[Kc]=e,t[hS]=e,e}function T_(t,e,n){AA(0);let r=Ee(null);try{e(t,n)}finally{Ee(r)}}function wU(t){return t[zc]||(t[zc]=[])}function EU(t){return t.cleanup||(t.cleanup=[])}function Sx(t,e){let n=t[Yo],r=n?n.get(gr,null):null;r&&r.handleError(e)}function Iv(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],u=e[o],l=t.data[o];px(l,u,r,a,c,i)}}function IU(t,e,n){let r=EA(e,t);Mj(t[ht],r,n)}function CU(t,e){let n=Ci(e,t),r=n[pe];DU(r,n);let i=n[zr];i!==null&&n[jh]===null&&(n[jh]=gv(i,n[Yo])),Cv(r,n,n[Kn])}function DU(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function Cv(t,e,n){iv(e);try{let r=t.viewQuery;r!==null&&T_(1,r,n);let i=t.template;i!==null&&mx(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Zo]?.finishViewCreation(t),t.staticContentQueries&&bx(t,e),t.staticViewQueries&&T_(2,t.viewQuery,n);let s=t.components;s!==null&&TU(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[G]&=-5,sv()}}function TU(t,e){for(let n=0;n<e.length;n++)CU(t,e[n])}function bU(t,e,n,r){let i=Ee(null);try{let s=e.tView,a=t[G]&4096?4096:16,c=yf(t,s,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=t[e.index];c[uf]=u;let l=t[Zo];return l!==null&&(c[Zo]=l.createEmbeddedView(s)),Cv(s,c,n),c}finally{Ee(i)}}function TS(t,e){return!e||e.firstChild===null||zA(t)}function SU(t,e,n,r=!0){let i=e[pe];if(kj(i,e,t,n),r){let o=C_(n,t),a=e[ht],c=_v(a,t[Es]);c!==null&&Nj(i,t[Yn],a,e,c,o)}let s=e[jh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Kh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(pr(s)),Kr(s)&&AU(s,r);let o=n.type;if(o&8)Kh(t,e,n.child,r);else if(o&32){let a=yv(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=ux(e,n);if(Array.isArray(a))r.push(...a);else{let c=Yc(e[fr]);Kh(c[pe],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function AU(t,e){for(let n=Mn;n<t.length;n++){let r=t[n],i=r[pe].firstChild;i!==null&&Kh(r[pe],r,i,e)}t[Es]!==t[zr]&&e.push(t[Es])}var Ax=[];function xU(t){return t[ws]??MU(t)}function MU(t){let e=Ax.pop()??Object.create(NU);return e.lView=t,e}function RU(t){t.lView[ws]!==t&&(t.lView=null,Ax.push(t))}var NU=de(x({},Rb),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Qc(t.lView)},consumerOnSignalRead(){this.lView[ws]=this}}),xx=100;function Mx(t,e=!0,n=0){let r=t[Qn],i=r.rendererFactory,s=!1;s||i.begin?.();try{PU(t,n)}catch(o){throw e&&Sx(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function PU(t,e){b_(t,e);let n=0;for(;rv(t);){if(n===xx)throw new $(103,!1);n++,b_(t,1)}}function kU(t,e,n,r){let i=e[G];if((i&256)===256)return;let s=!1;!s&&e[Qn].inlineEffectRunner?.flush(),iv(e);let o=null,a=null;!s&&OU(t)&&(a=xU(e),o=Nb(a));try{CA(e),L2(t.bindingStartIndex),n!==null&&mx(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&Rh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Nh(e,d,0,null),Qy(e,0)}if(FU(e),Rx(e,0),t.contentQueries!==null&&bx(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&Rh(e,d)}else{let d=t.contentHooks;d!==null&&Nh(e,d,1),Qy(e,1)}Yj(t,e);let u=t.components;u!==null&&Px(e,u,0);let l=t.viewQuery;if(l!==null&&T_(2,l,r),!s)if(c){let d=t.viewCheckHooks;d!==null&&Rh(e,d)}else{let d=t.viewHooks;d!==null&&Nh(e,d,2),Qy(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Ky]){for(let d of e[Ky])d();e[Ky]=null}s||(e[G]&=-73)}catch(c){throw Qc(e),c}finally{a!==null&&(Pb(a,o),RU(a)),sv()}}function OU(t){return t.type!==2}function Rx(t,e){for(let n=QA(t);n!==null;n=YA(n))for(let r=Mn;r<n.length;r++){let i=n[r];Nx(i,e)}}function FU(t){for(let e=QA(t);e!==null;e=YA(e)){if(!(e[G]&ev.HasTransplantedViews))continue;let n=e[Bh];for(let r=0;r<n.length;r++){let i=n[r],s=i[Nt];S2(i)}}}function VU(t,e,n){let r=Ci(e,t);Nx(r,n)}function Nx(t,e){nv(t)&&b_(t,e)}function b_(t,e){let r=t[pe],i=t[G],s=t[ws],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Dy(s)),s&&(s.dirty=!1),t[G]&=-9217,o)kU(r,t,r.template,t[Kn]);else if(i&8192){Rx(t,1);let a=r.components;a!==null&&Px(t,a,1)}}function Px(t,e,n){for(let r=0;r<e.length;r++)VU(t,e[r],n)}function Dv(t){for(t[Qn].changeDetectionScheduler?.notify();t;){t[G]|=64;let e=Yc(t);if(_2(t)&&!e)return t;t=e}return null}var Ts=class{get rootNodes(){let e=this._lView,n=e[pe];return Kh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Kn]}set context(e){this._lView[Kn]=e}get destroyed(){return(this._lView[G]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Nt];if(Kr(e)){let n=e[Uh],r=n?n.indexOf(this):-1;r>-1&&(I_(e,r),Vh(n,r))}this._attachedToViewContainer=!1}ax(this._lView[pe],this._lView)}onDestroy(e){DA(this._lView,e)}markForCheck(){Dv(this._cdRefInjectingView||this._lView)}detach(){this._lView[G]&=-129}reattach(){p_(this._lView),this._lView[G]|=128}detectChanges(){this._lView[G]|=1024,Mx(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,sx(this._lView[pe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e,p_(this._lView)}},Tv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=UU;let t=e;return t})(),LU=Tv,jU=class extends LU{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=bU(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new Ts(i)}};function UU(){return BU(sn(),Pe())}function BU(t,e){return t.type&4?new jU(e,t,ff(t,e)):null}var Eee=new RegExp(`^(\\d+)*(${_j}|${yj})*(.*)`);var $U=()=>null;function bS(t,e){return $U(t,e)}var Qh=class{},S_=class{},Yh=class{};function HU(t){let e=Error(`No component factory found for ${tn(t)}.`);return e[qU]=t,e}var qU="ngComponent";var A_=class{resolveComponentFactory(e){throw HU(e)}},wf=(()=>{let e=class e{};e.NULL=new A_;let t=e;return t})(),Zc=class{},Qr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>GU();let t=e;return t})();function GU(){let t=Pe(),e=sn(),n=Ci(e.index,t);return(_s(n)?n:t)[ht]}var WU=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),e_={};var SS=new Set;function bv(t){SS.has(t)||(SS.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function AS(...t){}function zU(){let t=typeof Ut.requestAnimationFrame=="function",e=Ut[t?"requestAnimationFrame":"setTimeout"],n=Ut[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var ie=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new dt(!1),this.onMicrotaskEmpty=new dt(!1),this.onStable=new dt(!1),this.onError=new dt(!1),typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=zU().nativeRequestAnimationFrame,YU(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new $(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,KU,AS,AS);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},KU={};function Sv(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function QU(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Ut,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,x_(t),t.isCheckStableRunning=!0,Sv(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),x_(t))}function YU(t){let e=()=>{QU(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(ZU(a))return n.invokeTask(i,s,o,a);try{return xS(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),MS(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return xS(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),MS(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,x_(t),Sv(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function x_(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function xS(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function MS(t){t._nesting--,Sv(t)}var M_=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new dt,this.onMicrotaskEmpty=new dt,this.onStable=new dt,this.onError=new dt}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function ZU(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function XU(t="zone.js",e){return t==="noop"?new M_:t==="zone.js"?new ie(e):t}var Ho=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Ho||{}),JU={destroy(){}};function Av(t,e){!e&&g2(Av);let n=e?.injector??P($t);if(!Sj(n))return JU;bv("NgAfterNextRender");let r=n.get(xv),i=r.handler??=new N_,s=e?.phase??Ho.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(hv).onDestroy(o),c=Wr(n,()=>new R_(s,()=>{o(),t()}));return i.register(c),{destroy:o}}var R_=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=P(ie),this.errorHandler=P(gr,{optional:!0}),P(Qh,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},N_=class{constructor(){this.executingCallbacks=!1,this.buckets={[Ho.EarlyRead]:new Set,[Ho.Write]:new Set,[Ho.MixedReadWrite]:new Set,[Ho.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},xv=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function P_(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=nS(i,a);else if(s==2){let c=a,u=e[++o];r=nS(r,c+": "+u+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Zh=class extends wf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=_i(e);return new Jo(n,this.ngModule)}};function RS(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function eB(t){let e=t.toLowerCase();return e==="svg"?I2:e==="math"?C2:null}var k_=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=af(r);let i=this.injector.get(e,e_,r);return i!==e_||n===e_?i:this.parentInjector.get(e,n,r)}},Jo=class extends Yh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=RS(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return RS(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=JL(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=Ee(null);try{i=i||this.ngModule;let o=i instanceof dn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new k_(e,o):e,c=a.get(Zc,null);if(c===null)throw new $(407,!1);let u=a.get(WU,null),l=a.get(xv,null),d=a.get(Qh,null),h={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:l,changeDetectionScheduler:d},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=r?Jj(f,r,this.componentDef.encapsulation,a):ix(f,p,eB(p)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let T=null;g!==null&&(T=gv(g,a,!0));let F=Ev(0,null,null,1,0,null,null,null,null,null,null),S=yf(null,F,null,v,null,null,h,f,a,null,T);iv(S);let H,W;try{let Y=this.componentDef,Te,Xt=null;Y.findHostDirectiveDefs?(Te=[],Xt=new Map,Y.findHostDirectiveDefs(Y,Te,Xt),Te.push(Y)):Te=[Y];let py=tB(S,g),Bd=nB(py,g,Y,Te,S,h,f);W=IA(F,vi),g&&sB(f,Y,g,r),n!==void 0&&oB(W,this.ngContentSelectors,n),H=iB(Bd,Y,Te,Xt,S,[aB]),Cv(F,S,null)}finally{sv()}return new O_(this.componentType,H,ff(W,S),S,W)}finally{Ee(s)}}},O_=class extends S_{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Ts(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;Iv(s[pe],s,i,e,n),this.previousInputValues.set(e,n);let o=Ci(this._tNode.index,s);Dv(o)}}get injector(){return new vs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function tB(t,e){let n=t[pe],r=vi;return t[r]=e,_f(n,r,2,"#host",null)}function nB(t,e,n,r,i,s,o){let a=i[pe];rB(r,t,e,o);let c=null;e!==null&&(c=gv(e,i[Yo]));let u=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=yf(i,wx(n),null,l,i[t.index],t,s,u,null,null,c);return a.firstCreatePass&&D_(a,t,r.length-1),vf(i,d),i[t.index]=d}function rB(t,e,n,r){for(let i of t)e.mergedAttrs=Gc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(P_(e,e.mergedAttrs,!0),n!==null&&dx(r,n,e))}function iB(t,e,n,r,i,s){let o=sn(),a=i[pe],c=Nn(o,i);Cx(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Xo(i,a,d,o);Ds(h,i)}Dx(a,i,o),c&&Ds(c,i);let u=Xo(i,a,o.directiveStart+o.componentOffset,o);if(t[Kn]=i[Kn]=u,s!==null)for(let l of s)l(u,e);return yx(a,o,i),u}function sB(t,e,n,r){if(r)u_(t,n,["ng-version","17.3.1"]);else{let{attrs:i,classes:s}=e2(e.selectors[0]);i&&u_(t,n,i),s&&s.length>0&&lx(t,n,s.join(" "))}}function oB(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function aB(){let t=sn();uv(Pe()[pe],t)}var iu=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=cB;let t=e;return t})();function cB(){let t=sn();return lB(t,Pe())}var uB=iu,kx=class extends uB{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return ff(this._hostTNode,this._hostLView)}get injector(){return new vs(this._hostTNode,this._hostLView)}get parentInjector(){let e=lv(this._hostTNode,this._hostLView);if(FA(e)){let n=qh(e,this._hostLView),r=Hh(e),i=n[pe].data[r+8];return new vs(i,n)}else return new vs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=NS(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Mn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=bS(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,TS(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!y2(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new Jo(_i(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let g=(o?u:this.parentInjector).get(dn,null);g&&(s=g)}let l=_i(c.componentType??{}),d=bS(this._lContainer,l?.id??null),h=d?.firstChild??null,f=c.create(u,i,h,s);return this.insertImpl(f.hostView,a,TS(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(b2(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Nt],u=new kx(c,c[Yn],c[Nt]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return SU(o,i,s,r),e.attachToViewContainerRef(),ZS(t_(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=NS(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=I_(this._lContainer,n);r&&(Vh(t_(this._lContainer),n),ax(r[pe],r))}detach(e){let n=this._adjustIndex(e,-1),r=I_(this._lContainer,n);return r&&Vh(t_(this._lContainer),n)!=null?new Ts(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function NS(t){return t[Uh]}function t_(t){return t[Uh]||(t[Uh]=[])}function lB(t,e){let n,r=e[t.index];return Kr(r)?n=r:(n=Tx(r,e,null,t),e[t.index]=n,vf(e,n)),hB(n,e,t,r),new kx(n,t,e)}function dB(t,e){let n=t[ht],r=n.createComment(""),i=Nn(e,t),s=_v(n,i);return zh(n,s,r,Bj(n,i),!1),r}var hB=gB,fB=()=>!1;function pB(t,e,n){return fB(t,e,n)}function gB(t,e,n,r){if(t[Es])return;let i;n.type&8?i=pr(r):i=dB(e,n),t[Es]=i}function mB(t){return typeof t=="function"&&t[Cy]!==void 0}function Ox(t){return mB(t)&&typeof t.set=="function"}function yB(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(EB))}return s}return Xh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(u=>{i.template=u}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let u=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[u+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(u=>{a.push(u),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>IB(s));e.push(c)}),vB(),Promise.all(e).then(()=>{})}var Xh=new Map,_B=new Set;function vB(){let t=Xh;return Xh=new Map,t}function wB(){return Xh.size===0}function EB(t){return typeof t=="string"?t:t.text()}function IB(t){_B.delete(t)}function CB(t){return Object.getPrototypeOf(t.prototype).constructor}function fn(t){let e=CB(t.type),n=!0,r=[t];for(;e;){let i;if(wi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new $(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Sh(t.inputs),o.inputTransforms=Sh(t.inputTransforms),o.declaredInputs=Sh(t.declaredInputs),o.outputs=Sh(t.outputs);let a=i.hostBindings;a&&AB(t,a);let c=i.viewQuery,u=i.contentQueries;if(c&&bB(t,c),u&&SB(t,u),DB(t,i),EL(t.outputs,i.outputs),wi(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===fn&&(n=!1)}}e=Object.getPrototypeOf(e)}TB(r)}function DB(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function TB(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Gc(i.hostAttrs,n=Gc(n,i.hostAttrs))}}function Sh(t){return t===zo?{}:t===xn?[]:t}function bB(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function SB(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function AB(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function Mv(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var Ei=class{},Xc=class{};var Jh=class extends Ei{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Zh(this);let i=oA(e);this._bootstrapComponents=rx(i.bootstrap),this._r3Injector=GA(e,n,[{provide:Ei,useValue:this},{provide:wf,useValue:this.componentFactoryResolver},...r],tn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},ef=class extends Xc{constructor(e){super(),this.moduleType=e}create(e){return new Jh(this.moduleType,e,[])}};function xB(t,e,n){return new Jh(t,e,n)}var F_=class extends Ei{constructor(e){super(),this.componentFactoryResolver=new Zh(this),this.instance=null;let n=new Wc([...e.providers,{provide:Ei,useValue:this},{provide:wf,useValue:this.componentFactoryResolver}],e.parent||J_(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Ef(t,e,n=null){return new F_({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var If=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new St(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Fx(t){return RB(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function MB(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function RB(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function su(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function NB(t){return(t.flags&32)===32}function PB(t,e,n,r,i,s,o,a,c){let u=e.consts,l=_f(e,t,4,o||null,$h(u,a));Ix(e,n,l,$h(u,c)),uv(e,l);let d=l.tView=Ev(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function kn(t,e,n,r,i,s,o,a){let c=Pe(),u=hn(),l=t+vi,d=u.firstCreatePass?PB(l,u,c,e,n,r,i,s,o):u.data[l];nu(d,!1);let h=kB(u,c,d,t);av()&&vv(u,c,h,d),Ds(h,c);let f=Tx(h,c,h,d);return c[l]=f,vf(c,f),pB(f,d,c),tv(d)&&_x(u,c,d),o!=null&&vx(c,d,a),kn}var kB=OB;function OB(t,e,n,r){return cv(!0),e[ht].createComment("")}function Di(t,e,n,r){let i=Pe(),s=hf();if(su(i,s,e)){let o=hn(),a=ov();mU(a,i,t,e,n,r)}return Di}function FB(t,e,n,r){return su(t,hf(),n)?e+of(n)+r:sa}function Ah(t,e){return t<<17|e<<2}function bs(t){return t>>17&32767}function VB(t){return(t&2)==2}function LB(t,e){return t&131071|e<<17}function V_(t){return t|2}function ea(t){return(t&131068)>>2}function n_(t,e){return t&-131069|e<<2}function jB(t){return(t&1)===1}function L_(t){return t|1}function UB(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=bs(o),c=ea(o);t[r]=n;let u=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||tu(d,l)>0)&&(u=!0)}else l=n;if(i)if(c!==0){let h=bs(t[a+1]);t[r+1]=Ah(h,a),h!==0&&(t[h+1]=n_(t[h+1],r)),t[a+1]=LB(t[a+1],r)}else t[r+1]=Ah(a,0),a!==0&&(t[a+1]=n_(t[a+1],r)),a=r;else t[r+1]=Ah(c,0),a===0?a=r:t[c+1]=n_(t[c+1],r),c=r;u&&(t[r+1]=V_(t[r+1])),PS(t,l,r,!0),PS(t,l,r,!1),BB(e,l,t,r,s),o=Ah(a,c),s?e.classBindings=o:e.styleBindings=o}function BB(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&tu(s,e)>=0&&(n[r+1]=L_(n[r+1]))}function PS(t,e,n,r){let i=t[n+1],s=e===null,o=r?bs(i):ea(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],u=t[o+1];$B(c,e)&&(a=!0,t[o+1]=r?L_(u):V_(u)),o=r?bs(u):ea(u)}a&&(t[n+1]=r?V_(i):L_(i))}function $B(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?tu(t,e)>=0:!1}function ke(t,e,n){let r=Pe(),i=hf();if(su(r,i,e)){let s=hn(),o=ov();Ex(s,o,r,t,e,r[ht],n,!1)}return ke}function kS(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";Iv(t,n,s[o],o,r)}function Rv(t,e){return HB(t,e,null,!0),Rv}function HB(t,e,n,r){let i=Pe(),s=hn(),o=j2(2);if(s.firstUpdatePass&&GB(s,t,o,r),e!==sa&&su(i,o,e)){let a=s.data[ia()];YB(s,a,i,i[ht],t,i[o+1]=ZB(e,n),r,o)}}function qB(t,e){return e>=t.expandoStartIndex}function GB(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[ia()],o=qB(t,n);XB(s,r)&&e===null&&!o&&(e=!1),e=WB(i,s,e,r),UB(i,s,e,n,o,r)}}function WB(t,e,n,r){let i=H2(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=r_(null,t,e,n,r),n=Jc(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=r_(i,t,e,n,r),s===null){let c=zB(t,e,r);c!==void 0&&Array.isArray(c)&&(c=r_(null,t,e,c[1],r),c=Jc(c,e.attrs,r),KB(t,e,r,c))}else s=QB(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function zB(t,e,n){let r=n?e.classBindings:e.styleBindings;if(ea(r)!==0)return t[bs(r)]}function KB(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[bs(i)]=r}function QB(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Jc(r,o,n)}return Jc(r,e.attrs,n)}function r_(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Jc(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Jc(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),BL(t,o,n?!0:e[++s]))}return t===void 0?null:t}function YB(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,u=c[a+1],l=jB(u)?OS(c,e,n,i,ea(u),o):void 0;if(!tf(l)){tf(s)||VB(u)&&(s=OS(c,null,n,i,a,o));let d=EA(ia(),n);Kj(r,o,d,i,s)}}function OS(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],u=Array.isArray(c),l=u?c[1]:c,d=l===null,h=n[i+1];h===sa&&(h=d?xn:void 0);let f=d?Wy(h,r):l===r?h:void 0;if(u&&!tf(f)&&(f=Wy(c,r)),tf(f)&&(a=f,o))return a;let p=t[i+1];i=o?bs(p):ea(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=Wy(c,r))}return a}function tf(t){return t!==void 0}function ZB(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=tn(ru(t)))),t}function XB(t,e){return(t.flags&(e?8:16))!==0}function JB(t,e,n,r,i,s){let o=e.consts,a=$h(o,i),c=_f(e,t,2,r,a);return Ix(e,n,c,$h(o,s)),c.attrs!==null&&P_(c,c.attrs,!1),c.mergedAttrs!==null&&P_(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function C(t,e,n,r){let i=Pe(),s=hn(),o=vi+t,a=i[ht],c=s.firstCreatePass?JB(o,s,i,e,n,r):s.data[o],u=e$(s,i,c,a,e,t);i[o]=u;let l=tv(c);return nu(c,!0),dx(a,u,c),!NB(c)&&av()&&vv(s,i,u,c),M2()===0&&Ds(u,i),R2(),l&&(_x(s,i,c),yx(s,c,i)),r!==null&&vx(i,c),C}function D(){let t=sn();SA()?V2():(t=t.parent,nu(t,!1));let e=t;k2(e)&&O2(),N2();let n=hn();return n.firstCreatePass&&(uv(n,t),mA(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&Y2(e)&&kS(n,e,Pe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&Z2(e)&&kS(n,e,Pe(),e.stylesWithoutHost,!1),D}function Ge(t,e,n,r){return C(t,e,n,r),D(),Ge}var e$=(t,e,n,r,i,s)=>(cv(!0),ix(r,i,W2()));function Cf(){return Pe()}var nf="en-US";var t$=nf;function n$(t){typeof t=="string"&&(t$=t.toLowerCase().replace(/_/g,"-"))}function Ae(t,e,n,r){let i=Pe(),s=hn(),o=sn();return Vx(s,i,i[ht],o,t,e,r),Ae}function r$(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[zc],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function Vx(t,e,n,r,i,s,o){let a=tv(r),u=t.firstCreatePass&&EU(t),l=e[Kn],d=wU(e),h=!0;if(r.type&3||o){let g=Nn(r,e),v=o?o(g):g,T=d.length,F=o?H=>o(pr(H[r.index])):r.index,S=null;if(!o&&a&&(S=r$(t,e,i,r.index)),S!==null){let H=S.__ngLastListenerFn__||S;H.__ngNextListenerFn__=s,S.__ngLastListenerFn__=s,h=!1}else{s=VS(r,e,l,s,!1);let H=n.listen(v,i,s);d.push(s,H),u&&u.push(i,F,T,T+1)}}else s=VS(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let v=0;v<g;v+=2){let T=p[v],F=p[v+1],W=e[T][F].subscribe(s),Y=d.length;d.push(s,W),u&&u.push(i,r.index,Y,-(Y+1))}}}function FS(t,e,n,r){let i=Ee(null);try{return lr(6,e,n),n(r)!==!1}catch(s){return Sx(t,s),!1}finally{lr(7,e,n),Ee(i)}}function VS(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Ci(t.index,e):e;Dv(a);let c=FS(e,n,r,o),u=s.__ngNextListenerFn__;for(;u;)c=FS(e,n,u,o)&&c,u=u.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function ou(t=1){return G2(t)}function A(t,e=""){let n=Pe(),r=hn(),i=t+vi,s=r.firstCreatePass?_f(r,i,1,e,null):r.data[i],o=i$(r,n,s,e,t);n[i]=o,av()&&vv(r,n,o,s),nu(s,!1)}var i$=(t,e,n,r,i)=>(cv(!0),xj(e[ht],r));function yt(t){return Lx("",t,""),yt}function Lx(t,e,n){let r=Pe(),i=FB(r,t,e,n);return i!==sa&&IU(r,ia(),i),Lx}function Ht(t,e,n){Ox(e)&&(e=e());let r=Pe(),i=hf();if(su(r,i,e)){let s=hn(),o=ov();Ex(s,o,r,t,e,r[ht],n,!1)}return Ht}function on(t,e){let n=Ox(t);return n&&t.set(e),n}function qt(t,e){let n=Pe(),r=hn(),i=sn();return Vx(r,n,n[ht],i,t,e),qt}function s$(t,e,n){let r=hn();if(r.firstCreatePass){let i=wi(t);j_(n,r.data,r.blueprint,i,!0),j_(e,r.data,r.blueprint,i,!1)}}function j_(t,e,n,r,i){if(t=jt(t),Array.isArray(t))for(let s=0;s<t.length;s++)j_(t[s],e,n,r,i);else{let s=hn(),o=Pe(),a=sn(),c=Qo(t)?t:jt(t.provide),u=hA(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Qo(t)||!t.multi){let f=new Cs(u,i,le),p=s_(c,e,i?l:l+h,d);p===-1?(y_(Gh(a,o),s,c),i_(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=s_(c,e,l+h,d),p=s_(c,e,l,l+h),g=f>=0&&n[f],v=p>=0&&n[p];if(i&&!v||!i&&!g){y_(Gh(a,o),s,c);let T=c$(i?a$:o$,n.length,i,r,u);!i&&v&&(n[p].providerFactory=T),i_(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(T),o.push(T)}else{let T=jx(n[i?p:f],u,!i&&r);i_(s,t,f>-1?f:p,T)}!i&&r&&v&&n[p].componentProviders++}}}function i_(t,e,n,r){let i=Qo(e),s=c2(e);if(i||s){let c=(s?jt(e.useClass):e).prototype.ngOnDestroy;if(c){let u=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=u.indexOf(n);l===-1?u.push(n,[r,c]):u[l+1].push(r,c)}else u.push(n,c)}}}function jx(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function s_(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function o$(t,e,n,r){return U_(this.multi,[])}function a$(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Xo(n,n[pe],this.providerFactory.index,r);s=a.slice(0,o),U_(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],U_(i,s);return s}function U_(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function c$(t,e,n,r,i){let s=new Cs(t,n,le);return s.multi=[],s.index=e,s.componentProviders=0,jx(s,i,r&&!n),s}function yr(t,e=[]){return n=>{n.providersResolver=(r,i)=>s$(r,i?i(t):t,e)}}var u$=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=uA(!1,r.type),s=i.length>0?Ef([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(E(dn))});let t=e;return t})();function Ux(t){bv("NgStandalone"),t.getStandaloneInjector=e=>e.get(u$).getOrCreateStandaloneInjector(t)}var xh=null;function l$(t){xh!==null&&(t.defaultEncapsulation!==xh.defaultEncapsulation||t.preserveWhitespaces!==xh.preserveWhitespaces)||(xh=t)}var Gr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},Df=new Gr("17.3.1"),Tf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var Nv=new k(""),au=new k(""),bf=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Pv||(d$(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ie.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(E(ie),E(Sf),E(au))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Sf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return Pv?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function d$(t){Pv=t}var Pv;function Ss(t){return!!t&&typeof t.then=="function"}function Bx(t){return!!t&&typeof t.subscribe=="function"}var Af=new k(""),$x=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=P(Af,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Ss(o))r.push(o);else if(Bx(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),kv=new k("");function h$(){Ob(()=>{throw new $(600,!1)})}function f$(t){return t.isBoundToModule}function p$(t,e,n){try{let r=n();return Ss(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function Hx(t,e){return Array.isArray(e)?e.reduce(Hx,t):x(x({},t),e)}var oa=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=P(WA),this.afterRenderEffectManager=P(xv),this.externalTestViews=new Set,this.beforeRender=new qe,this.afterTick=new qe,this.componentTypes=[],this.components=[],this.isStable=P(If).hasPendingTasks.pipe(j(r=>!r)),this._injector=P(dn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Yh;if(!this._injector.get($x).done){let f=!s&&sA(r),p=!1;throw new $(405,p)}let a;s?a=r:a=this._injector.get(wf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=f$(a)?void 0:this._injector.get(Ei),u=i||a.selector,l=a.create($t.NULL,[],u,c),d=l.location.nativeElement,h=l.injector.get(Nv,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),kh(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new $(101,!1);let i=Ee(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Ee(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===xx)throw new $(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)g$(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>B_(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>B_(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;kh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(kv,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>kh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new $(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function g$(t,e,n){!e&&!B_(t)||m$(t,n,e)}function B_(t){return rv(t)}function m$(t,e,n){let r;n?(r=0,t[G]|=1024):t[G]&64?r=0:r=1,Mx(t,e,r)}var $_=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},xf=(()=>{let e=class e{compileModuleSync(r){return new ef(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=oA(r),o=rx(s.declarations).reduce((a,c)=>{let u=_i(c);return u&&a.push(new Jo(u)),a},[]);return new $_(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),y$=new k("");function _$(t,e,n){let r=new ef(n);return Promise.resolve(r)}function LS(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var v$=(()=>{let e=class e{constructor(){this.zone=P(ie),this.applicationRef=P(oa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function w$(t){return[{provide:ie,useFactory:t},{provide:Ko,multi:!0,useFactory:()=>{let e=P(v$,{optional:!0});return()=>e.initialize()}},{provide:Ko,multi:!0,useFactory:()=>{let e=P(C$);return()=>{e.initialize()}}},{provide:WA,useFactory:E$}]}function E$(){let t=P(ie),e=P(gr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function I$(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var C$=(()=>{let e=class e{constructor(){this.subscription=new Ye,this.initialized=!1,this.zone=P(ie),this.pendingTasks=P(If)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ie.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ie.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function D$(){return typeof $localize<"u"&&$localize.locale||nf}var Ov=new k("",{providedIn:"root",factory:()=>P(Ov,ae.Optional|ae.SkipSelf)||D$()});var qx=new k(""),Gx=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=XU(i?.ngZone,I$({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=xB(r.moduleType,this.injector,w$(()=>s)),a=o.injector.get(gr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:u=>{a.handleError(u)}});o.onDestroy(()=>{kh(this._modules,o),c.unsubscribe()})}),p$(a,s,()=>{let c=o.injector.get($x);return c.runInitializers(),c.donePromise.then(()=>{let u=o.injector.get(Ov,nf);return n$(u||nf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=Hx({},i);return _$(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(oa);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new $(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new $(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(qx,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(E($t))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Hc=null,Wx=new k("");function T$(t){if(Hc&&!Hc.get(Wx,!1))throw new $(400,!1);h$(),Hc=t;let e=t.get(Gx);return A$(t),e}function Fv(t,e,n=[]){let r=`Platform: ${e}`,i=new k(r);return(s=[])=>{let o=zx();if(!o||o.injector.get(Wx,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):T$(b$(a,r))}return S$(i)}}function b$(t=[],e){return $t.create({name:e,providers:[{provide:cf,useValue:"platform"},{provide:qx,useValue:new Set([()=>Hc=null])},...t]})}function S$(t){let e=zx();if(!e)throw new $(401,!1);return e}function zx(){return Hc?.get(Gx)??null}function A$(t){t.get(fv,null)?.forEach(n=>n())}function Vv(){return!1}var As=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=x$;let t=e;return t})();function x$(t){return M$(sn(),Pe(),(t&16)===16)}function M$(t,e,n){if(df(t)&&!n){let r=Ci(t.index,e);return new Ts(r,r)}else if(t.type&47){let r=e[fr];return new Ts(r,e)}return null}var H_=class{constructor(){}supports(e){return Fx(e)}create(e){return new q_(e)}},R$=(t,e)=>e,q_=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||R$}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<jS(r,i,s)?n:r,a=jS(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let u=a-i,l=c-i;if(u!=l){for(let h=0;h<u;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<u&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-u}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!Fx(e))throw new $(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,MB(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new G_(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new rf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new rf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},G_=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},W_=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},rf=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new W_,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function jS(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function US(){return new Lv([new H_])}var Lv=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||US()),deps:[[e,new Q_,new nn]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new $(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:US});let t=e;return t})();var Kx=Fv(null,"core",[]),Qx=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(E(oa))},e.\u0275mod=je({type:e}),e.\u0275inj=Le({});let t=e;return t})();function Ti(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function Yx(t){let e=_i(t);if(!e)return null;let n=new Jo(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var eM=null;function _r(){return eM}function tM(t){eM??=t}var Mf=class{};var an=new k(""),$v=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(N$),providedIn:"platform"});let t=e;return t})(),nM=new k(""),N$=(()=>{let e=class e extends $v{constructor(){super(),this._doc=P(an),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return _r().getBaseHref(this._doc)}onPopState(r){let i=_r().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=_r().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function Hv(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function Zx(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Yr(t){return t&&t[0]!=="?"?"?"+t:t}var Zr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(qv),providedIn:"root"});let t=e;return t})(),rM=new k(""),qv=(()=>{let e=class e extends Zr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??P(an).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Hv(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Yr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E($v),E(rM,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),iM=(()=>{let e=class e extends Zr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Hv(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E($v),E(rM,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),aa=(()=>{let e=class e{constructor(r){this._subject=new dt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=O$(Zx(Xx(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Yr(i))}normalize(r){return e.stripTrailingSlash(k$(this._basePath,Xx(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Yr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Yr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Yr,e.joinWithSlash=Hv,e.stripTrailingSlash=Zx,e.\u0275fac=function(i){return new(i||e)(E(Zr))},e.\u0275prov=V({token:e,factory:()=>P$(),providedIn:"root"});let t=e;return t})();function P$(){return new aa(E(Zr))}function k$(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function Xx(t){return t.replace(/\/index.html$/,"")}function O$(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function sM(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var jv=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Nf=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new jv(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),Jx(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);Jx(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(le(iu),le(Tv),le(Lv))},e.\u0275dir=Ze({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function Jx(t,e){t.context.$implicit=e.item}var oM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=je({type:e}),e.\u0275inj=Le({});let t=e;return t})(),Gv="browser",F$="server";function V$(t){return t===Gv}function xs(t){return t===F$}var aM=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>V$(P(mt))?new Uv(P(an),window):new Bv});let t=e;return t})(),Uv=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=L$(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function L$(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Bv=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Rf=class{};var Qv=class extends Mf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Yv=class t extends Qv{static makeCurrent(){tM(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=U$();return n==null?null:B$(n)}resetBaseElement(){cu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return sM(document.cookie,e)}},cu=null;function U$(){return cu=cu||document.querySelector("base"),cu?cu.getAttribute("href"):null}function B$(t){return new URL(t,document.baseURI).pathname}var Zv=class{addToWindow(e){Ut.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new $(5103,!1);return s},Ut.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ut.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Ut.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Ut.frameworkStabilizers||(Ut.frameworkStabilizers=[]),Ut.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?_r().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},$$=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Xv=new k(""),dM=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(E(Xv),E(ie))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Pf=class{constructor(e){this._doc=e}},zv="ng-app-id",hM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=xs(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${zv}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(zv),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(zv,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(E(an),E(pf),E(pv,8),E(mt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Kv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ew=/%COMP%/g,fM="%COMP%",H$=`_nghost-${fM}`,q$=`_ngcontent-${fM}`,G$=!0,W$=new k("",{providedIn:"root",factory:()=>G$});function z$(t){return q$.replace(ew,t)}function K$(t){return H$.replace(ew,t)}function pM(t,e){return e.map(n=>n.replace(ew,t))}var cM=(()=>{let e=class e{constructor(r,i,s,o,a,c,u,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=xs(c),this.defaultRenderer=new uu(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===hr.ShadowDom&&(i=de(x({},i),{encapsulation:hr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof kf?s.applyToHost(r):s instanceof lu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case hr.Emulated:o=new kf(u,l,i,this.appId,d,a,c,h);break;case hr.ShadowDom:return new Jv(u,l,r,i,a,c,this.nonce,h);default:o=new lu(u,l,i,d,a,c,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(E(dM),E(hM),E(pf),E(W$),E(an),E(mt),E(ie),E(pv))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),uu=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Kv[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(uM(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(uM(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=Kv[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=Kv[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(qr.DashCase|qr.Important)?e.style.setProperty(n,r,i&qr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&qr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=_r().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function uM(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Jv=class extends uu{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=pM(i.id,i.styles);for(let l of u){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},lu=class extends uu{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?pM(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},kf=class extends lu{constructor(e,n,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,n,r,s,o,a,c,u),this.contentAttr=z$(u),this.hostAttr=K$(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},Q$=(()=>{let e=class e extends Pf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(E(an))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),lM=["alt","control","meta","shift"],Y$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Z$={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},X$=(()=>{let e=class e extends Pf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>_r().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),lM.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=Y$[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),lM.forEach(a=>{if(a!==s){let c=Z$[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(E(an))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function J$(){Yv.makeCurrent()}function eH(){return new gr}function tH(){return XA(document),document}var nH=[{provide:mt,useValue:Gv},{provide:fv,useValue:J$,multi:!0},{provide:an,useFactory:tH,deps:[]}],gM=Fv(Kx,"browser",nH),rH=new k(""),iH=[{provide:au,useClass:Zv,deps:[]},{provide:Nv,useClass:bf,deps:[ie,Sf,au]},{provide:bf,useClass:bf,deps:[ie,Sf,au]}],sH=[{provide:cf,useValue:"root"},{provide:gr,useFactory:eH,deps:[]},{provide:Xv,useClass:Q$,multi:!0,deps:[an,ie,mt]},{provide:Xv,useClass:X$,multi:!0,deps:[an]},cM,hM,dM,{provide:Zc,useExisting:cM},{provide:Rf,useClass:$$,deps:[]},[]],mM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:pf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(E(rH,12))},e.\u0275mod=je({type:e}),e.\u0275inj=Le({providers:[...sH,...iH],imports:[oM,Qx]});let t=e;return t})();var yM=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(E(an))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var re="primary",Tu=Symbol("RouteTitle"),sw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function ha(t){return new sw(t)}function oH(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function aH(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!vr(t[n],e[n]))return!1;return!0}function vr(t,e){let n=t?ow(t):void 0,r=e?ow(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!SM(t[i],e[i]))return!1;return!0}function ow(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function SM(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function AM(t){return t.length>0?t[t.length-1]:null}function Mi(t){return Ly(t)?t:Ss(t)?_e(Promise.resolve(t)):U(t)}var cH={exact:MM,subset:RM},xM={exact:uH,subset:lH,ignored:()=>!0};function vM(t,e,n){return cH[n.paths](t.root,e.root,n.matrixParams)&&xM[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function uH(t,e){return vr(t,e)}function MM(t,e,n){if(!Rs(t.segments,e.segments)||!Vf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!MM(t.children[r],e.children[r],n))return!1;return!0}function lH(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>SM(t[n],e[n]))}function RM(t,e,n){return NM(t,e,e.segments,n)}function NM(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Rs(i,n)||e.hasChildren()||!Vf(i,n,r))}else if(t.segments.length===n.length){if(!Rs(t.segments,n)||!Vf(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!RM(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Rs(t.segments,i)||!Vf(t.segments,i,r)||!t.children[re]?!1:NM(t.children[re],e,s,r)}}function Vf(t,e,n){return e.every((r,i)=>xM[n](t[i].parameters,r.parameters))}var bi=class{constructor(e=new Ie([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ha(this.queryParams),this._queryParamMap}toString(){return fH.serialize(this)}},Ie=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Lf(this)}},Ms=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=ha(this.parameters),this._parameterMap}toString(){return kM(this)}};function dH(t,e){return Rs(t,e)&&t.every((n,r)=>vr(n.parameters,e[r].parameters))}function Rs(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function hH(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===re&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==re&&(n=n.concat(e(i,r)))}),n}var bu=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new yu,providedIn:"root"});let t=e;return t})(),yu=class{parse(e){let n=new cw(e);return new bi(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${du(e.root,!0)}`,r=mH(e.queryParams),i=typeof e.fragment=="string"?`#${pH(e.fragment)}`:"";return`${n}${r}${i}`}},fH=new yu;function Lf(t){return t.segments.map(e=>kM(e)).join("/")}function du(t,e){if(!t.hasChildren())return Lf(t);if(e){let n=t.children[re]?du(t.children[re],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==re&&r.push(`${i}:${du(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=hH(t,(r,i)=>i===re?[du(t.children[re],!1)]:[`${i}:${du(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[re]!=null?`${Lf(t)}/${n[0]}`:`${Lf(t)}/(${n.join("//")})`}}function PM(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Of(t){return PM(t).replace(/%3B/gi,";")}function pH(t){return encodeURI(t)}function aw(t){return PM(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jf(t){return decodeURIComponent(t)}function wM(t){return jf(t.replace(/\+/g,"%20"))}function kM(t){return`${aw(t.path)}${gH(t.parameters)}`}function gH(t){return Object.entries(t).map(([e,n])=>`;${aw(e)}=${aw(n)}`).join("")}function mH(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Of(n)}=${Of(i)}`).join("&"):`${Of(n)}=${Of(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var yH=/^[^\/()?;#]+/;function tw(t){let e=t.match(yH);return e?e[0]:""}var _H=/^[^\/()?;=#]+/;function vH(t){let e=t.match(_H);return e?e[0]:""}var wH=/^[^=?&#]+/;function EH(t){let e=t.match(wH);return e?e[0]:""}var IH=/^[^&#]+/;function CH(t){let e=t.match(IH);return e?e[0]:""}var cw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ie([],{}):new Ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[re]=new Ie(e,n)),r}parseSegment(){let e=tw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new Ms(jf(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=vH(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=tw(this.remaining);i&&(r=i,this.capture(r))}e[jf(n)]=jf(r)}parseQueryParam(e){let n=EH(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=CH(this.remaining);o&&(r=o,this.capture(r))}let i=wM(n),s=wM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=tw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=re);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[re]:new Ie([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function OM(t){return t.segments.length>0?new Ie([],{[re]:t}):t}function FM(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=FM(i);if(r===re&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ie(t.segments,e);return DH(n)}function DH(t){if(t.numberOfChildren===1&&t.children[re]){let e=t.children[re];return new Ie(t.segments.concat(e.segments),e.children)}return t}function fa(t){return t instanceof bi}function TH(t,e,n=null,r=null){let i=VM(t);return LM(i,e,n,r)}function VM(t){let e;function n(s){let o={};for(let c of s.children){let u=n(c);o[c.outlet]=u}let a=new Ie(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=OM(r);return e??i}function LM(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return nw(i,i,i,n,r);let s=bH(e);if(s.toRoot())return nw(i,i,new Ie([],{}),n,r);let o=SH(s,i,t),a=o.processChildren?pu(o.segmentGroup,o.index,s.commands):UM(o.segmentGroup,o.index,s.commands);return nw(i,o.segmentGroup,a,n,r)}function Uf(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function _u(t){return typeof t=="object"&&t!=null&&t.outlets}function nw(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(l=>`${l}`):`${u}`});let o;t===e?o=n:o=jM(t,e,n);let a=OM(FM(o));return new bi(a,s,i)}function jM(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=jM(s,e,n)}),new Ie(t.segments,r)}var Bf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Uf(r[0]))throw new $(4003,!1);let i=r.find(_u);if(i&&i!==AM(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function bH(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Bf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Bf(n,e,r)}var la=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function SH(t,e,n){if(t.isAbsolute)return new la(e,!0,0);if(!n)return new la(e,!1,NaN);if(n.parent===null)return new la(n,!0,0);let r=Uf(t.commands[0])?0:1,i=n.segments.length-1+r;return AH(n,i,t.numberOfDoubleDots)}function AH(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new la(r,!1,i-s)}function xH(t){return _u(t[0])?t[0].outlets:{[re]:t}}function UM(t,e,n){if(t??=new Ie([],{}),t.segments.length===0&&t.hasChildren())return pu(t,e,n);let r=MH(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ie(t.segments.slice(0,r.pathIndex),{});return s.children[re]=new Ie(t.segments.slice(r.pathIndex),t.children),pu(s,0,i)}else return r.match&&i.length===0?new Ie(t.segments,{}):r.match&&!t.hasChildren()?uw(t,e,n):r.match?pu(t,0,i):uw(t,e,n)}function pu(t,e,n){if(n.length===0)return new Ie(t.segments,{});{let r=xH(n),i={};if(Object.keys(r).some(s=>s!==re)&&t.children[re]&&t.numberOfChildren===1&&t.children[re].segments.length===0){let s=pu(t.children[re],e,n);return new Ie(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=UM(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ie(t.segments,i)}}function MH(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(_u(a))break;let c=`${a}`,u=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!IM(c,u,o))return s;r+=2}else{if(!IM(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function uw(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(_u(s)){let c=RH(s.outlets);return new Ie(r,c)}if(i===0&&Uf(n[0])){let c=t.segments[e];r.push(new Ms(c.path,EM(n[0]))),i++;continue}let o=_u(s)?s.outlets[re]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Uf(a)?(r.push(new Ms(o,EM(a))),i+=2):(r.push(new Ms(o,{})),i++)}return new Ie(r,{})}function RH(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=uw(new Ie([],{}),0,r))}),e}function EM(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function IM(t,e,n){return t==n.path&&vr(e,n.parameters)}var gu="imperative",_t=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(_t||{}),On=class{constructor(e,n){this.id=e,this.url=n}},pa=class extends On{constructor(e,n,r="imperative",i=null){super(e,n),this.type=_t.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},wr=class extends On{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=_t.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},gn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(gn||{}),$f=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}($f||{}),Si=class extends On{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=_t.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ai=class extends On{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=_t.NavigationSkipped}},vu=class extends On{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=_t.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Hf=class extends On{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lw=class extends On{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},dw=class extends On{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=_t.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},hw=class extends On{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fw=class extends On{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=_t.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pw=class{constructor(e){this.route=e,this.type=_t.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},gw=class{constructor(e){this.route=e,this.type=_t.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},mw=class{constructor(e){this.snapshot=e,this.type=_t.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yw=class{constructor(e){this.snapshot=e,this.type=_t.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},_w=class{constructor(e){this.snapshot=e,this.type=_t.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},vw=class{constructor(e){this.snapshot=e,this.type=_t.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qf=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=_t.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},wu=class{},Eu=class{constructor(e){this.url=e}};var ww=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Su,this.attachRef=null}},Su=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new ww,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Gf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=Ew(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=Ew(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=Iw(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Iw(e,this._root).map(n=>n.value)}};function Ew(t,e){if(t===e.value)return e;for(let n of e.children){let r=Ew(t,n);if(r)return r}return null}function Iw(t,e){if(t===e.value)return[e];for(let n of e.children){let r=Iw(t,n);if(r.length)return r.unshift(e),r}return[]}var pn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function ua(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Wf=class extends Gf{constructor(e,n){super(e),this.snapshot=n,Nw(this,e)}toString(){return this.snapshot.toString()}};function BM(t){let e=NH(t),n=new St([new Ms("",{})]),r=new St({}),i=new St({}),s=new St({}),o=new St(""),a=new Ns(n,r,s,o,i,re,t,e.root);return a.snapshot=e.root,new Wf(new pn(a,[]),e)}function NH(t){let e={},n={},r={},i="",s=new Iu([],e,r,i,n,re,t,null,{});return new zf("",new pn(s,[]))}var Ns=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(j(u=>u[Tu]))??U(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>ha(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>ha(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Rw(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:x(x({},e.params),t.params),data:x(x({},e.data),t.data),resolve:x(x(x(x({},t.data),e.data),i?.data),t._resolvedData)}:r={params:x({},t.params),data:x({},t.data),resolve:x(x({},t.data),t._resolvedData??{})},i&&HM(i)&&(r.resolve[Tu]=i.title),r}var Iu=class{get title(){return this.data?.[Tu]}constructor(e,n,r,i,s,o,a,c,u){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ha(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ha(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},zf=class extends Gf{constructor(e,n){super(n),this.url=e,Nw(this,n)}toString(){return $M(this._root)}};function Nw(t,e){e.value._routerState=t,e.children.forEach(n=>Nw(t,n))}function $M(t){let e=t.children.length>0?` { ${t.children.map($M).join(", ")} } `:"";return`${t.value}${e}`}function rw(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,vr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),vr(e.params,n.params)||t.paramsSubject.next(n.params),aH(e.url,n.url)||t.urlSubject.next(n.url),vr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Cw(t,e){let n=vr(t.params,e.params)&&dH(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||Cw(t.parent,e.parent))}function HM(t){return typeof t.title=="string"||t.title===null}var Pw=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=re,this.activateEvents=new dt,this.deactivateEvents=new dt,this.attachEvents=new dt,this.detachEvents=new dt,this.parentContexts=P(Su),this.location=P(iu),this.changeDetector=P(As),this.environmentInjector=P(dn),this.inputBinder=P(Xf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Dw(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ze({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ii]});let t=e;return t})(),Dw=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Ns?this.route:e===Su?this.childContexts:this.parent.get(e,n)}},Xf=new k(""),CM=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Vc([i.queryParams,i.params,i.data]).pipe(Ve(([o,a,c],u)=>(c=x(x(x({},o),a),c),u===0?U(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=Yx(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function PH(t,e,n){let r=Cu(t,e._root,n?n._root:void 0);return new Wf(r,e)}function Cu(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=kH(t,e,n);return new pn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Cu(t,a)),o}}let r=OH(e.value),i=e.children.map(s=>Cu(t,s));return new pn(r,i)}}function kH(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Cu(t,r,i);return Cu(t,r)})}function OH(t){return new Ns(new St(t.url),new St(t.params),new St(t.queryParams),new St(t.fragment),new St(t.data),t.outlet,t.component,t)}var qM="ngNavigationCancelingError";function GM(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=fa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=WM(!1,gn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function WM(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[qM]=!0,n.cancellationCode=e,n}function FH(t){return zM(t)&&fa(t.url)}function zM(t){return!!t&&t[qM]}var VH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=rn({type:e,selectors:[["ng-component"]],standalone:!0,features:[Ux],decls:1,vars:0,template:function(i,s){i&1&&Ge(0,"router-outlet")},dependencies:[Pw],encapsulation:2});let t=e;return t})();function LH(t,e){return t.providers&&!t._injector&&(t._injector=Ef(t.providers,e,`Route: ${t.path}`)),t._injector??e}function kw(t){let e=t.children&&t.children.map(kw),n=e?de(x({},t),{children:e}):x({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==re&&(n.component=VH),n}function Er(t){return t.outlet||re}function jH(t,e){let n=t.filter(r=>Er(r)===e);return n.push(...t.filter(r=>Er(r)!==e)),n}function Au(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var UH=(t,e,n,r)=>j(i=>(new Tw(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),Tw=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),rw(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=ua(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=ua(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=ua(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=ua(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new vw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new yw(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(rw(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),rw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Au(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Kf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},da=class{constructor(e,n){this.component=e,this.route=n}};function BH(t,e,n){let r=t._root,i=e?e._root:null;return hu(r,i,n,[r.value])}function $H(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function ma(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!qS(t)?t:e.get(t):r}function hu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ua(e);return t.children.forEach(o=>{HH(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>mu(a,n.getContext(o),i)),i}function HH(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=qH(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Kf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?hu(t,e,a?a.children:null,r,i):hu(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new da(a.outlet.component,o))}else o&&mu(e,a,i),i.canActivateChecks.push(new Kf(r)),s.component?hu(t,null,a?a.children:null,r,i):hu(t,null,n,r,i);return i}function qH(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Rs(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Rs(t.url,e.url)||!vr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Cw(t,e)||!vr(t.queryParams,e.queryParams);case"paramsChange":default:return!Cw(t,e)}}function mu(t,e,n){let r=ua(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?mu(o,e.children.getContext(s),n):mu(o,null,n):mu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new da(e.outlet.component,i)):n.canDeactivateChecks.push(new da(null,i)):n.canDeactivateChecks.push(new da(null,i))}function xu(t){return typeof t=="function"}function GH(t){return typeof t=="boolean"}function WH(t){return t&&xu(t.canLoad)}function zH(t){return t&&xu(t.canActivate)}function KH(t){return t&&xu(t.canActivateChild)}function QH(t){return t&&xu(t.canDeactivate)}function YH(t){return t&&xu(t.canMatch)}function KM(t){return t instanceof $r||t?.name==="EmptyError"}var Ff=Symbol("INITIAL_VALUE");function ga(){return Ve(t=>Vc(t.map(e=>e.pipe(Hr(1),ys(Ff)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===Ff)return Ff;if(n===!1||n instanceof bi)return n}return!0}),At(e=>e!==Ff),Hr(1)))}function ZH(t,e){return rt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?U(de(x({},n),{guardsResult:!0})):XH(o,r,i,t).pipe(rt(a=>a&&GH(a)?JH(r,s,t,e):U(a)),j(a=>de(x({},n),{guardsResult:a})))})}function XH(t,e,n,r){return _e(t).pipe(rt(i=>iq(i.component,i.route,n,e,r)),Sn(i=>i!==!0,!0))}function JH(t,e,n,r){return _e(e).pipe(ms(i=>Vo(tq(i.route.parent,r),eq(i.route,r),rq(t,i.path,n),nq(t,i.route,n))),Sn(i=>i!==!0,!0))}function eq(t,e){return t!==null&&e&&e(new _w(t)),U(!0)}function tq(t,e){return t!==null&&e&&e(new mw(t)),U(!0)}function nq(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>Eh(()=>{let o=Au(e)??n,a=ma(s,o),c=zH(a)?a.canActivate(e,t):Wr(o,()=>a(e,t));return Mi(c).pipe(Sn())}));return U(i).pipe(ga())}function rq(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>$H(o)).filter(o=>o!==null).map(o=>Eh(()=>{let a=o.guards.map(c=>{let u=Au(o.node)??n,l=ma(c,u),d=KH(l)?l.canActivateChild(r,t):Wr(u,()=>l(r,t));return Mi(d).pipe(Sn())});return U(a).pipe(ga())}));return U(s).pipe(ga())}function iq(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let o=s.map(a=>{let c=Au(e)??i,u=ma(a,c),l=QH(u)?u.canDeactivate(t,e,n,r):Wr(c,()=>u(t,e,n,r));return Mi(l).pipe(Sn())});return U(o).pipe(ga())}function sq(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(o=>{let a=ma(o,t),c=WH(a)?a.canLoad(e,n):Wr(t,()=>a(e,n));return Mi(c)});return U(s).pipe(ga(),QM(r))}function QM(t){return Ny(lt(e=>{if(fa(e))throw GM(t,e)}),j(e=>e===!0))}function oq(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(o=>{let a=ma(o,t),c=YH(a)?a.canMatch(e,n):Wr(t,()=>a(e,n));return Mi(c)});return U(s).pipe(ga(),QM(r))}var Du=class{constructor(e){this.segmentGroup=e||null}},Qf=class extends Error{constructor(e){super(),this.urlTree=e}};function ca(t){return Fo(new Du(t))}function aq(t){return Fo(new $(4e3,!1))}function cq(t){return Fo(WM(!1,gn.GuardRejected))}var bw=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[re])return aq(e.redirectTo);i=i.children[re]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Qf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new bi(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ie(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},Sw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function uq(t,e,n,r,i){let s=Ow(t,e,n);return s.matched?(r=LH(e,r),oq(r,e,n,i).pipe(j(o=>o===!0?s:x({},Sw)))):U(s)}function Ow(t,e,n){if(e.path==="**")return lq(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?x({},Sw):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||oH)(n,t,e);if(!i)return x({},Sw);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?x(x({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function lq(t){return{matched:!0,parameters:t.length>0?AM(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function DM(t,e,n,r){return n.length>0&&fq(t,n,r)?{segmentGroup:new Ie(e,hq(r,new Ie(n,t.children))),slicedSegments:[]}:n.length===0&&pq(t,n,r)?{segmentGroup:new Ie(t.segments,dq(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ie(t.segments,t.children),slicedSegments:n}}function dq(t,e,n,r){let i={};for(let s of n)if(Jf(t,e,s)&&!r[Er(s)]){let o=new Ie([],{});i[Er(s)]=o}return x(x({},r),i)}function hq(t,e){let n={};n[re]=e;for(let r of t)if(r.path===""&&Er(r)!==re){let i=new Ie([],{});n[Er(r)]=i}return n}function fq(t,e,n){return n.some(r=>Jf(t,e,r)&&Er(r)!==re)}function pq(t,e,n){return n.some(r=>Jf(t,e,r))}function Jf(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function gq(t,e,n,r){return Er(t)!==r&&(r===re||!Jf(e,n,t))?!1:Ow(e,t,n).matched}function mq(t,e,n){return e.length===0&&!t.children[n]}var Aw=class{};function yq(t,e,n,r,i,s,o="emptyOnly"){return new xw(t,e,n,r,i,o,s).recognize()}var _q=31,xw=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new bw(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}recognize(){let e=DM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let r=new Iu([],Object.freeze({}),Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,{},re,this.rootComponentType,null,{}),i=new pn(r,n),s=new zf("",i),o=TH(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,re).pipe(pi(r=>{if(r instanceof Qf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Du?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=Rw(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(j(s=>s instanceof pn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return _e(i).pipe(ms(s=>{let o=r.children[s],a=jH(n,s);return this.processSegmentGroup(e,a,o,s)}),ur((s,o)=>(s.push(...o),s)),gi(null),By(),rt(s=>{if(s===null)return ca(r);let o=YM(s);return vq(o),U(o)}))}processSegment(e,n,r,i,s,o){return _e(n).pipe(ms(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(pi(c=>{if(c instanceof Du)return U(null);throw c}))),Sn(a=>!!a),pi(a=>{if(KM(a))return mq(r,i,s)?U(new Aw):ca(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return gq(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):ca(i):ca(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:l}=Ow(n,i,s);if(!a)return ca(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>_q&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,d).pipe(rt(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=uq(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Ve(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ve(({routes:c})=>{let u=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new Iu(l,h,Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,Eq(r),Er(r),r.component??r._loadedComponent??null,r,Iq(r)),{segmentGroup:p,slicedSegments:g}=DM(n,l,d,c);if(g.length===0&&p.hasChildren())return this.processChildren(u,c,p).pipe(j(T=>T===null?null:new pn(f,T)));if(c.length===0&&g.length===0)return U(new pn(f,[]));let v=Er(r)===s;return this.processSegment(u,c,p,g,v?re:s,!0).pipe(j(T=>new pn(f,T instanceof pn?[T]:[])))}))):ca(n)))}getChildConfig(e,n,r){return n.children?U({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?U({routes:n._loadedRoutes,injector:n._loadedInjector}):sq(e,n,r,this.urlSerializer).pipe(rt(i=>i?this.configLoader.loadChildren(e,n).pipe(lt(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):cq(n))):U({routes:[],injector:e})}};function vq(t){t.sort((e,n)=>e.value.outlet===re?-1:n.value.outlet===re?1:e.value.outlet.localeCompare(n.value.outlet))}function wq(t){let e=t.value.routeConfig;return e&&e.path===""}function YM(t){let e=[],n=new Set;for(let r of t){if(!wq(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=YM(r.children);e.push(new pn(r.value,i))}return e.filter(r=>!n.has(r))}function Eq(t){return t.data||{}}function Iq(t){return t.resolve||{}}function Cq(t,e,n,r,i,s){return rt(o=>yq(t,e,n,r,o.extractedUrl,i,s).pipe(j(({state:a,tree:c})=>de(x({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function Dq(t,e){return rt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return U(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of ZM(c))o.add(u);let a=0;return _e(o).pipe(ms(c=>s.has(c)?Tq(c,r,t,e):(c.data=Rw(c,c.parent,t).resolve,U(void 0))),lt(()=>a++),jo(1),rt(c=>a===o.size?U(n):Lt))})}function ZM(t){let e=t.children.map(n=>ZM(n)).flat();return[t,...e]}function Tq(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!HM(i)&&(s[Tu]=i.title),bq(s,t,e,r).pipe(j(o=>(t._resolvedData=o,t.data=Rw(t,t.parent,n).resolve,null)))}function bq(t,e,n,r){let i=ow(t);if(i.length===0)return U({});let s={};return _e(i).pipe(rt(o=>Sq(t[o],e,n,r).pipe(Sn(),lt(a=>{s[o]=a}))),jo(1),Uy(s),pi(o=>KM(o)?Lt:Fo(o)))}function Sq(t,e,n,r){let i=Au(e)??r,s=ma(t,i),o=s.resolve?s.resolve(e,n):Wr(i,()=>s(e,n));return Mi(o)}function iw(t){return Ve(e=>{let n=t(e);return n?_e(n).pipe(j(()=>e)):U(e)})}var XM=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===re);return i}getResolvedTitleForRoute(r){return r.data[Tu]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Aq),providedIn:"root"});let t=e;return t})(),Aq=(()=>{let e=class e extends XM{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(E(yM))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Mu=new k("",{providedIn:"root",factory:()=>({})}),Yf=new k(""),Fw=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=P(xf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return U(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Mi(r.loadComponent()).pipe(j(JM),lt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),jc(()=>{this.componentLoaders.delete(r)})),s=new Ro(i,()=>new qe).pipe(Mo());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return U({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=xq(i,this.compiler,r,this.onLoadEndListener).pipe(jc(()=>{this.childrenLoaders.delete(i)})),a=new Ro(o,()=>new qe).pipe(Mo());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function xq(t,e,n,r){return Mi(t.loadChildren()).pipe(j(JM),rt(i=>i instanceof Xc||Array.isArray(i)?U(i):_e(e.compileModuleAsync(i))),j(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Yf,[],{optional:!0,self:!0}).flat()),{routes:o.map(kw),injector:s}}))}function Mq(t){return t&&typeof t=="object"&&"default"in t}function JM(t){return Mq(t)?t.default:t}var Vw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Rq),providedIn:"root"});let t=e;return t})(),Rq=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),eR=new k(""),tR=new k("");function Nq(t,e,n){let r=t.get(tR),i=t.get(an);return t.get(ie).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),Pq(t))),{onViewTransitionCreated:c}=r;return c&&Wr(t,()=>c({transition:a,from:e,to:n})),o})}function Pq(t){return new Promise(e=>{Av(e,{injector:t})})}var Lw=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new qe,this.transitionAbortSubject=new qe,this.configLoader=P(Fw),this.environmentInjector=P(dn),this.urlSerializer=P(bu),this.rootContexts=P(Su),this.location=P(aa),this.inputBindingEnabled=P(Xf,{optional:!0})!==null,this.titleStrategy=P(XM),this.options=P(Mu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=P(Vw),this.createViewTransition=P(eR,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>U(void 0),this.rootComponentType=null;let r=s=>this.events.next(new pw(s)),i=s=>this.events.next(new gw(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(de(x(x({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new St({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:gu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(At(o=>o.id!==0),j(o=>de(x({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ve(o=>{let a=!1,c=!1;return U(o).pipe(Ve(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",gn.SupersededByNewNavigation),Lt;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?de(x({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new Ai(u.id,this.urlSerializer.serialize(u.rawUrl),h,$f.IgnoredSameUrlNavigation)),u.resolve(null),Lt}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return U(u).pipe(Ve(h=>{let f=this.transitions?.getValue();return this.events.next(new pa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Lt:Promise.resolve(h)}),Cq(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),lt(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=de(x({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Hf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:v}=u,T=new pa(h,this.urlSerializer.serialize(f),p,g);this.events.next(T);let F=BM(this.rootComponentType).snapshot;return this.currentTransition=o=de(x({},u),{targetSnapshot:F,urlAfterRedirects:f,extras:de(x({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,U(o)}else{let h="";return this.events.next(new Ai(u.id,this.urlSerializer.serialize(u.extractedUrl),h,$f.IgnoredByUrlHandlingStrategy)),u.resolve(null),Lt}}),lt(u=>{let l=new lw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),j(u=>(this.currentTransition=o=de(x({},u),{guards:BH(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),ZH(this.environmentInjector,u=>this.events.next(u)),lt(u=>{if(o.guardsResult=u.guardsResult,fa(u.guardsResult))throw GM(this.urlSerializer,u.guardsResult);let l=new dw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),At(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",gn.GuardRejected),!1)),iw(u=>{if(u.guards.canActivateChecks.length)return U(u).pipe(lt(l=>{let d=new hw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Ve(l=>{let d=!1;return U(l).pipe(Dq(this.paramsInheritanceStrategy,this.environmentInjector),lt({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",gn.NoDataFromResolver)}}))}),lt(l=>{let d=new fw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),iw(u=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(lt(f=>{d.component=f}),j(()=>{})));for(let f of d.children)h.push(...l(f));return h};return Vc(l(u.targetSnapshot.root)).pipe(gi(null),Hr(1))}),iw(()=>this.afterPreactivation()),Ve(()=>{let{currentSnapshot:u,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?_e(d).pipe(j(()=>o)):U(o)}),j(u=>{let l=PH(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=de(x({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),lt(()=>{this.events.next(new wu)}),UH(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Hr(1),lt({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new wr(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),qy(this.transitionAbortSubject.pipe(lt(u=>{throw u}))),jc(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",gn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),pi(u=>{if(c=!0,zM(u))this.events.next(new Si(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),FH(u)?this.events.next(new Eu(u.url)):o.resolve(!1);else{this.events.next(new vu(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(u))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Lt}))}))}cancelNavigationTransition(r,i,s){let o=new Si(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kq(t){return t!==gu}var Oq=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Fq),providedIn:"root"});let t=e;return t})(),Mw=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},Fq=(()=>{let e=class e extends Mw{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),nR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>P(Vq),providedIn:"root"});let t=e;return t})(),Vq=(()=>{let e=class e extends nR{constructor(){super(...arguments),this.location=P(aa),this.urlSerializer=P(bu),this.options=P(Mu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=P(Vw),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new bi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=BM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof pa)this.stateMemento=this.createStateMemento();else if(r instanceof Ai)this.rawUrlTree=i.initialUrl;else if(r instanceof Hf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof wu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Si&&(r.code===gn.GuardRejected||r.code===gn.NoDataFromResolver)?this.restoreHistory(i):r instanceof vu?this.restoreHistory(i,!0):r instanceof wr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=x(x({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=x(x({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),fu=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(fu||{});function rR(t,e){t.events.pipe(At(n=>n instanceof wr||n instanceof Si||n instanceof vu||n instanceof Ai),j(n=>n instanceof wr||n instanceof Ai?fu.COMPLETE:(n instanceof Si?n.code===gn.Redirect||n.code===gn.SupersededByNewNavigation:!1)?fu.REDIRECTING:fu.FAILED),At(n=>n!==fu.REDIRECTING),Hr(1)).subscribe(()=>{e()})}function Lq(t){throw t}var jq={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Uq={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},xi=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=P(Tf),this.stateManager=P(nR),this.options=P(Mu,{optional:!0})||{},this.pendingTasks=P(If),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=P(Lw),this.urlSerializer=P(bu),this.location=P(aa),this.urlHandlingStrategy=P(Vw),this._events=new qe,this.errorHandler=this.options.errorHandler||Lq,this.navigated=!1,this.routeReuseStrategy=P(Oq),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=P(Yf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!P(Xf,{optional:!0}),this.eventsSubscription=new Ye,this.isNgZoneEnabled=P(ie)instanceof ie&&ie.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Si&&i.code!==gn.Redirect&&i.code!==gn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof wr)this.navigated=!0;else if(i instanceof Eu){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||kq(s.source)};this.scheduleNavigation(a,gu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}$q(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),gu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=x({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(kw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=i,l=u?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=x(x({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=VM(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return LM(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=fa(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,gu,null,i)}navigate(r,i={skipLocationChange:!1}){return Bq(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=x({},jq):i===!1?s=x({},Uq):s=i,fa(r))return vM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return vM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,l;a?(c=a.resolve,u=a.reject,l=a.promise):l=new Promise((h,f)=>{c=h,u=f});let d=this.pendingTasks.add();return rR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Bq(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new $(4008,!1)}function $q(t){return!(t instanceof wu)&&!(t instanceof Eu)}var ep=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new qe,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof wr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:tx(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(le(xi),le(Ns),dv("tabindex"),le(Qr),le(mr),le(Zr))},e.\u0275dir=Ze({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Ae("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Di("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Bt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ti],skipLocationChange:[Bt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ti],replaceUrl:[Bt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ti],routerLink:"routerLink"},standalone:!0,features:[Mv,Ii]});let t=e;return t})();var Zf=class{};var Hq=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(At(r=>r instanceof wr),ms(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Ef(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return _e(s).pipe(fi())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=U(null);let o=s.pipe(rt(a=>a===null?U(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return _e([o,a]).pipe(fi())}else return o})}};e.\u0275fac=function(i){return new(i||e)(E(xi),E(xf),E(dn),E(Zf),E(Fw))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),iR=new k(""),qq=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof pa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof wr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Ai&&r.code===$f.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof qf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new qf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){fx()},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function Gq(t){return t.routerState.root}function Ru(t,e){return{\u0275kind:t,\u0275providers:e}}function Wq(){let t=P($t);return e=>{let n=t.get(oa);if(e!==n.components[0])return;let r=t.get(xi),i=t.get(sR);t.get(jw)===1&&r.initialNavigation(),t.get(oR,null,ae.Optional)?.setUpPreloading(),t.get(iR,null,ae.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var sR=new k("",{factory:()=>new qe}),jw=new k("",{providedIn:"root",factory:()=>1});function zq(){return Ru(2,[{provide:jw,useValue:0},{provide:Af,multi:!0,deps:[$t],useFactory:e=>{let n=e.get(nM,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(xi),s=e.get(sR);rR(i,()=>{r(!0)}),e.get(Lw).afterPreactivation=()=>(r(!0),s.closed?U(void 0):s),i.initialNavigation()}))}}])}function Kq(){return Ru(3,[{provide:Af,multi:!0,useFactory:()=>{let e=P(xi);return()=>{e.setUpLocationChangeListener()}}},{provide:jw,useValue:2}])}var oR=new k("");function Qq(t){return Ru(0,[{provide:oR,useExisting:Hq},{provide:Zf,useExisting:t}])}function Yq(){return Ru(8,[CM,{provide:Xf,useExisting:CM}])}function Zq(t){let e=[{provide:eR,useValue:Nq},{provide:tR,useValue:x({skipNextTransition:!!t?.skipInitialTransition},t)}];return Ru(9,e)}var TM=new k("ROUTER_FORROOT_GUARD"),Xq=[aa,{provide:bu,useClass:yu},xi,Su,{provide:Ns,useFactory:Gq,deps:[xi]},Fw,[]],Uw=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[Xq,[],{provide:Yf,multi:!0,useValue:r},{provide:TM,useFactory:n4,deps:[[xi,new nn,new Q_]]},{provide:Mu,useValue:i||{}},i?.useHash?e4():t4(),Jq(),i?.preloadingStrategy?Qq(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?r4(i):[],i?.bindToComponentInputs?Yq().\u0275providers:[],i?.enableViewTransitions?Zq().\u0275providers:[],i4()]}}static forChild(r){return{ngModule:e,providers:[{provide:Yf,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(E(TM,8))},e.\u0275mod=je({type:e}),e.\u0275inj=Le({});let t=e;return t})();function Jq(){return{provide:iR,useFactory:()=>{let t=P(aM),e=P(ie),n=P(Mu),r=P(Lw),i=P(bu);return n.scrollOffset&&t.setOffset(n.scrollOffset),new qq(i,r,t,e,n)}}}function e4(){return{provide:Zr,useClass:iM}}function t4(){return{provide:Zr,useClass:qv}}function n4(t){return"guarded"}function r4(t){return[t.initialNavigation==="disabled"?Kq().\u0275providers:[],t.initialNavigation==="enabledBlocking"?zq().\u0275providers:[]]}var bM=new k("");function i4(){return[{provide:bM,useFactory:Wq},{provide:kv,multi:!0,useExisting:bM}]}var Ps=class{};var Xr=class{};var s4="firebase",o4="10.9.0";gt(s4,o4,"app");var mn=new Gr("ANGULARFIRE2_VERSION");function Hw(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var Nu=(t,e)=>{let n=e?[e]:Zd(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Fn=class{constructor(){return Nu(a4)}},a4="app-check";function ya(){}var tp=class{zone;delegate;constructor(e,n=Fy){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},$w=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ya,{},ya,ya)),n.pipe(lt({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Zn=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new tp(Zone.current)),this.insideAngular=n.run(()=>new tp(Zone.current,gs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(E(ie))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function np(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function c4(t){return np().ngZone.runOutsideAngular(()=>t())}function ks(t){return np().ngZone.run(()=>t())}function We(t){return u4(np())(t)}function u4(t){return function(n){return n=n.lift(new $w(t.ngZone)),n.pipe(bn(t.outsideAngular),ln(t.insideAngular))}}var l4=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),ks(()=>t.apply(void 0,r))},Pu=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=ks(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ya,{},ya,ya))),r[s]=l4(r[s],n));let i=c4(()=>t.apply(this,r));if(!e)if(i instanceof ne){let s=np();return i.pipe(bn(s.outsideAngular),ln(s.insideAngular))}else return ks(()=>i);return i instanceof ne?i.pipe(We):i instanceof Promise?ks(()=>new Promise((s,o)=>i.then(a=>ks(()=>s(a)),a=>ks(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:ks(()=>i)};var Os=class{constructor(e){return e}},ku=class{constructor(){return Zd()}};function d4(t){return t&&t.length===1?t[0]:new Os(To())}var Gw=new k("angularfire2._apps"),h4={provide:Os,useFactory:d4,deps:[[new nn,Gw]]},f4={provide:ku,deps:[[new nn,Gw]]};function p4(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Os(r)}}var g4=(()=>{class t{constructor(n){gt("angularfire",mn.full,"core"),gt("angularfire",mn.full,"app"),gt("angular",Df.full,n.toString())}static \u0275fac=function(r){return new(r||t)(E(mt))};static \u0275mod=je({type:t});static \u0275inj=Le({providers:[h4,f4]})}return t})();function aR(t,...e){return{ngModule:g4,providers:[{provide:Gw,useFactory:p4(t),multi:!0,deps:[ie,$t,Zn,...e]}]}}var cR=Pu(xb,!0);var m4=new Map,y4={activated:!1,tokenObservers:[]},_4={initialized:!1,enabled:!1};function Xn(t){return m4.get(t)||Object.assign({},y4)}function fR(){return _4}var v4="https://content-firebaseappcheck.googleapis.com/v1";var w4="exchangeDebugToken",uR={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},cne=24*60*60*1e3;var zw=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return _(this,null,function*(){this.stop();try{this.pending=new pt,this.pending.promise.catch(n=>{}),yield E4(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new pt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function E4(t){return new Promise(e=>{setTimeout(e,t)})}var I4={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ri=new Cb("appCheck","AppCheck",I4);function pR(t){if(!Xn(t).activated)throw Ri.create("use-before-activation",{appName:t.name})}function gR(r,i){return _(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(f){throw Ri.create("fetch-network-error",{originalErrorMessage:f?.message})}if(c.status!==200)throw Ri.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(f){throw Ri.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=u.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw Ri.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:u.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function mR(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${v4}/projects/${n}/apps/${r}:${w4}?key=${i}`,body:{debug_token:e}}}var C4="firebase-app-check-database",D4=1,Kw="firebase-app-check-store";var rp=null;function T4(){return rp||(rp=new Promise((t,e)=>{try{let n=indexedDB.open(C4,D4);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Ri.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Kw,{keyPath:"compositeKey"})}}}catch(n){e(Ri.create("storage-open",{originalErrorMessage:n?.message}))}}),rp)}function b4(t,e){return S4(A4(t),e)}function S4(t,e){return _(this,null,function*(){let r=(yield T4()).transaction(Kw,"readwrite"),s=r.objectStore(Kw).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;a(Ri.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function A4(t){return`${t.options.appId}-${t.name}`}var Qw=new hi("@firebase/app-check");function Ww(t,e){return Gd()?b4(t,e).catch(n=>{Qw.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function yR(){return fR().enabled}function _R(){return _(this,null,function*(){let t=fR();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var x4={error:"UNKNOWN_ERROR"};function M4(t){return Hd.encodeString(JSON.stringify(t),!1)}function Yw(t,e=!1){return _(this,null,function*(){let n=t.app;pR(n);let r=Xn(n),i=r.token,s;if(i&&!Ou(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(Ou(c)?i=c:yield Ww(n,void 0))}if(!e&&i&&Ou(i))return{token:i.token};let o=!1;if(yR()){r.exchangeTokenPromise||(r.exchangeTokenPromise=gR(mR(n,yield _R()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield Ww(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Xn(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Qw.warn(c.message):Qw.error(c),s=c}let a;return i?s?Ou(i)?a={token:i.token,internalError:s}:a=dR(s):(a={token:i.token},r.token=i,yield Ww(n,i)):a=dR(s),o&&k4(n,a),a})}function R4(t){return _(this,null,function*(){let e=t.app;pR(e);let{provider:n}=Xn(e);if(yR()){let r=yield _R(),{token:i}=yield gR(mR(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function N4(t,e,n,r){let{app:i}=t,s=Xn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ou(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),lR(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>lR(t))}function vR(t,e){let n=Xn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function lR(t){let{app:e}=t,n=Xn(e),r=n.tokenRefresher;r||(r=P4(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function P4(t){let{app:e}=t;return new zw(()=>_(this,null,function*(){let n=Xn(e),r;if(n.token?r=yield Yw(t,!0):r=yield Yw(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Xn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},uR.RETRIAL_MIN_WAIT,uR.RETRIAL_MAX_WAIT)}function k4(t,e){let n=Xn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ou(t){return t.expireTimeMillis-Date.now()>0}function dR(t){return{token:M4(x4),error:t}}var Zw=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Xn(this.app);for(let n of e)vR(this.app,n.next);return Promise.resolve()}};function O4(t,e){return new Zw(t,e)}function F4(t){return{getToken:e=>Yw(t,e),getLimitedUseToken:()=>R4(t),addTokenListener:e=>N4(t,"INTERNAL",e),removeTokenListener:e=>vR(t.app,e)}}var V4="@firebase/app-check",L4="0.8.2";var j4="app-check",hR="app-check-internal";function U4(){ls(new un(j4,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return O4(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(hR).initialize()})),ls(new un(hR,t=>{let e=t.getProvider("app-check").getImmediate();return F4(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),gt(V4,L4)}U4();var B4=["localhost","0.0.0.0","127.0.0.1"],wne=typeof window<"u"&&B4.includes(window.location.hostname);var $4="firebase",H4="10.9.0";Tt.registerVersion($4,H4,"app-compat");var q4=["ngOnDestroy"],ER=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(q4.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(u=>n.run(()=>u)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,u)=>o.then(l=>{let d=l?.(...u);return r?.spy?.apply&&r.spy.apply(s,u,d),d})})})});var ip=class{constructor(e){return e}},Ni=new k("angularfire2.app.options"),Pi=new k("angularfire2.app.name");function Fs(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=Tt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Tt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;G4("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new ip(o)}var G4=(t,...e)=>{Vv()&&typeof console<"u"&&console[t](...e)},W4={provide:ip,useFactory:Fs,deps:[Ni,ie,[new nn,Pi]]},IR=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Ni,useValue:n},{provide:Pi,useValue:r}]}}constructor(n){Tt.registerVersion("angularfire",mn.full,"core"),Tt.registerVersion("angularfire",mn.full,"app-compat"),Tt.registerVersion("angular",Df.full,n.toString())}static \u0275fac=function(r){return new(r||t)(E(mt))};static \u0275mod=je({type:t});static \u0275inj=Le({providers:[W4]})}return t})();function _a(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return z4(i,o)||(wR("error",`${e} was already initialized on the ${n} Firebase App with different settings.${K4?" You may need to reload as Firebase is not HMR aware.":""}`),wR("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function z4(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var K4=typeof module<"u"&&!!module.hot,wR=(t,...e)=>{Vv()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Fu=new k("angularfire2.auth.use-emulator"),Vu=new k("angularfire2.auth.settings"),Lu=new k("angularfire2.auth.tenant-id"),ju=new k("angularfire2.auth.langugage-code"),Uu=new k("angularfire2.auth.use-device-language"),Bu=new k("angularfire.auth.persistence"),$u=(t,e,n,r,i,s,o,a)=>_a(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[u,l]of Object.entries(o))c.settings[u]=l;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),sp=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,u,l,d,h,f){let p=new qe,g=U(void 0).pipe(ln(o.outsideAngular),Ve(()=>s.runOutsideAngular(()=>import("./chunk-COFPOME4.js"))),j(()=>Fs(n,s,r)),j(v=>$u(v,s,a,u,l,d,c,h)),Ch({bufferSize:1,refCount:!1}));if(xs(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=U(null);else{g.pipe(Sn()).subscribe();let v=g.pipe(Ve(S=>S.getRedirectResult().then(H=>H,()=>null)),We,Ch({bufferSize:1,refCount:!1})),T=g.pipe(Ve(S=>new ne(H=>({unsubscribe:s.runOutsideAngular(()=>S.onAuthStateChanged(W=>H.next(W),W=>H.error(W),()=>H.complete()))})))),F=g.pipe(Ve(S=>new ne(H=>({unsubscribe:s.runOutsideAngular(()=>S.onIdTokenChanged(W=>H.next(W),W=>H.error(W),()=>H.complete()))}))));this.authState=v.pipe(Dh(T),bn(o.outsideAngular),ln(o.insideAngular)),this.user=v.pipe(Dh(F),bn(o.outsideAngular),ln(o.insideAngular)),this.idToken=this.user.pipe(Ve(S=>S?_e(S.getIdToken()):U(null))),this.idTokenResult=this.user.pipe(Ve(S=>S?_e(S.getIdTokenResult()):U(null))),this.credential=Lo(v,p,this.authState.pipe(At(S=>!S))).pipe(j(S=>S?.user?S:null),bn(o.outsideAngular),ln(o.insideAngular))}return ER(this,g,s,{spy:{apply:(v,T,F)=>{(v.startsWith("signIn")||v.startsWith("createUser"))&&F.then(S=>p.next(S))}}})}static \u0275fac=function(r){return new(r||t)(E(Ni),E(Pi,8),E(mt),E(ie),E(Zn),E(Fu,8),E(Vu,8),E(Lu,8),E(ju,8),E(Uu,8),E(Bu,8),E(Fn,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var Q4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},er={},N,wE=wE||{},Q=Q4||self;function vp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function nl(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Y4(t){return Object.prototype.hasOwnProperty.call(t,Jw)&&t[Jw]||(t[Jw]=++Z4)}var Jw="closure_uid_"+(1e9*Math.random()>>>0),Z4=0;function X4(t,e,n){return t.call.apply(t.bind,arguments)}function J4(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Pt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Pt=X4:Pt=J4,Pt.apply(null,arguments)}function op(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function wt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function ki(){this.s=this.s,this.o=this.o}var eG=0;ki.prototype.s=!1;ki.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),eG!=0)&&Y4(this)};ki.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var FR=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function EE(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function DR(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(vp(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function kt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}kt.prototype.h=function(){this.defaultPrevented=!0};var tG=function(){if(!Q.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Q.addEventListener("test",n,e),Q.removeEventListener("test",n,e)}catch{}return t}();function Ku(t){return/^[\s\xa0]*$/.test(t)}function wp(){var t=Q.navigator;return t&&(t=t.userAgent)?t:""}function Ir(t){return wp().indexOf(t)!=-1}function IE(t){return IE[" "](t),t}IE[" "]=function(){};function nG(t,e){var n=qG;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var rG=Ir("Opera"),Ia=Ir("Trident")||Ir("MSIE"),VR=Ir("Edge"),iE=VR||Ia,LR=Ir("Gecko")&&!(wp().toLowerCase().indexOf("webkit")!=-1&&!Ir("Edge"))&&!(Ir("Trident")||Ir("MSIE"))&&!Ir("Edge"),iG=wp().toLowerCase().indexOf("webkit")!=-1&&!Ir("Edge");function jR(){var t=Q.document;return t?t.documentMode:void 0}var sE;e:{if(ap="",cp=function(){var t=wp();if(LR)return/rv:([^\);]+)(\)|;)/.exec(t);if(VR)return/Edge\/([\d\.]+)/.exec(t);if(Ia)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(iG)return/WebKit\/(\S+)/.exec(t);if(rG)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),cp&&(ap=cp?cp[1]:""),Ia&&(up=jR(),up!=null&&up>parseFloat(ap))){sE=String(up);break e}sE=ap}var ap,cp,up,oE;Q.document&&Ia?(eE=jR(),oE=eE||parseInt(sE,10)||void 0):oE=void 0;var eE,sG=oE;function Qu(t,e){if(kt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(LR){e:{try{IE(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:oG[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Qu.$.h.call(this)}}wt(Qu,kt);var oG={2:"touch",3:"pen",4:"mouse"};Qu.prototype.h=function(){Qu.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var rl="closure_listenable_"+(1e6*Math.random()|0),aG=0;function cG(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++aG,this.fa=this.ia=!1}function Ep(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function CE(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function uG(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function UR(t){let e={};for(let n in t)e[n]=t[n];return e}var TR="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function BR(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<TR.length;s++)n=TR[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ip(t){this.src=t,this.g={},this.h=0}Ip.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=cE(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new cG(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function aE(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=FR(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Ep(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function cE(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var DE="closure_lm_"+(1e6*Math.random()|0),tE={};function $R(t,e,n,r,i){if(r&&r.once)return qR(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)$R(t,e[s],n,r,i);return null}return n=SE(n),t&&t[rl]?t.O(e,n,nl(r)?!!r.capture:!!r,i):HR(t,e,n,!1,r,i)}function HR(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=nl(i)?!!i.capture:!!i,a=bE(t);if(a||(t[DE]=a=new Ip(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=lG(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)tG||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(WR(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function lG(){function t(n){return e.call(t.src,t.listener,n)}let e=dG;return t}function qR(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)qR(t,e[s],n,r,i);return null}return n=SE(n),t&&t[rl]?t.P(e,n,nl(r)?!!r.capture:!!r,i):HR(t,e,n,!0,r,i)}function GR(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)GR(t,e[s],n,r,i);else r=nl(r)?!!r.capture:!!r,n=SE(n),t&&t[rl]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=cE(s,n,r,i),-1<n&&(Ep(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=bE(t))&&(e=t.g[e.toString()],t=-1,e&&(t=cE(e,n,r,i)),(n=-1<t?e[t]:null)&&TE(n))}function TE(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[rl])aE(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(WR(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=bE(e))?(aE(n,t),n.h==0&&(n.src=null,e[DE]=null)):Ep(t)}}}function WR(t){return t in tE?tE[t]:tE[t]="on"+t}function dG(t,e){if(t.fa)t=!0;else{e=new Qu(e,this);var n=t.listener,r=t.la||t.src;t.ia&&TE(t),t=n.call(r,e)}return t}function bE(t){return t=t[DE],t instanceof Ip?t:null}var nE="__closure_events_fn_"+(1e9*Math.random()>>>0);function SE(t){return typeof t=="function"?t:(t[nE]||(t[nE]=function(e){return t.handleEvent(e)}),t[nE])}function vt(){ki.call(this),this.i=new Ip(this),this.S=this,this.J=null}wt(vt,ki);vt.prototype[rl]=!0;vt.prototype.removeEventListener=function(t,e,n,r){GR(this,t,e,n,r)};function Mt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new kt(e,t);else if(e instanceof kt)e.target=e.target||t;else{var i=e;e=new kt(r,t),BR(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=lp(o,r,!0,e)&&i}if(o=e.g=t,i=lp(o,r,!0,e)&&i,i=lp(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=lp(o,r,!1,e)&&i}vt.prototype.N=function(){if(vt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ep(n[r]);delete t.g[e],t.h--}}this.J=null};vt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};vt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function lp(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&aE(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var AE=Q.JSON.stringify,uE=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function hG(){var t=xE;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var lE=class{constructor(){this.h=this.g=null}add(e,n){let r=zR.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},zR=new uE(()=>new dE,t=>t.reset()),dE=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function fG(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function pG(t){Q.setTimeout(()=>{throw t},0)}var Yu,Zu=!1,xE=new lE,KR=()=>{let t=Q.Promise.resolve(void 0);Yu=()=>{t.then(gG)}},gG=()=>{for(var t;t=hG();){try{t.h.call(t.g)}catch(n){pG(n)}var e=zR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Zu=!1};function Cp(t,e){vt.call(this),this.h=t||1,this.g=e||Q,this.j=Pt(this.qb,this),this.l=Date.now()}wt(Cp,vt);N=Cp.prototype;N.ga=!1;N.T=null;N.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Mt(this,"tick"),this.ga&&(ME(this),this.start()))}};N.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function ME(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}N.N=function(){Cp.$.N.call(this),ME(this),delete this.g};function RE(t,e,n){if(typeof t=="function")n&&(t=Pt(t,n));else if(t&&typeof t.handleEvent=="function")t=Pt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Q.setTimeout(t,e||0)}function QR(t){t.g=RE(()=>{t.g=null,t.i&&(t.i=!1,QR(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var hE=class extends ki{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:QR(this)}N(){super.N(),this.g&&(Q.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Xu(t){ki.call(this),this.h=t,this.g={}}wt(Xu,ki);var bR=[];function YR(t,e,n,r){Array.isArray(n)||(n&&(bR[0]=n.toString()),n=bR);for(var i=0;i<n.length;i++){var s=$R(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function ZR(t){CE(t.g,function(e,n){this.g.hasOwnProperty(n)&&TE(e)},t),t.g={}}Xu.prototype.N=function(){Xu.$.N.call(this),ZR(this)};Xu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Dp(){this.g=!0}Dp.prototype.Ea=function(){this.g=!1};function mG(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function yG(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function wa(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+vG(t,n)+(r?" "+r:"")})}function _G(t,e){t.info(function(){return"TIMEOUT: "+e})}Dp.prototype.info=function(){};function vG(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return AE(n)}catch{return e}}var Us={},SR=null;function Tp(){return SR=SR||new vt}Us.Ta="serverreachability";function XR(t){kt.call(this,Us.Ta,t)}wt(XR,kt);function Ju(t){let e=Tp();Mt(e,new XR(e))}Us.STAT_EVENT="statevent";function JR(t,e){kt.call(this,Us.STAT_EVENT,t),this.stat=e}wt(JR,kt);function Gt(t){let e=Tp();Mt(e,new JR(e,t))}Us.Ua="timingevent";function eN(t,e){kt.call(this,Us.Ua,t),this.size=e}wt(eN,kt);function il(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Q.setTimeout(function(){t()},e)}var bp={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},tN={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function NE(){}NE.prototype.h=null;function AR(t){return t.h||(t.h=t.i())}function nN(){}var sl={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function PE(){kt.call(this,"d")}wt(PE,kt);function kE(){kt.call(this,"c")}wt(kE,kt);var fE;function Sp(){}wt(Sp,NE);Sp.prototype.g=function(){return new XMLHttpRequest};Sp.prototype.i=function(){return{}};fE=new Sp;function ol(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Xu(this),this.P=wG,t=iE?125:void 0,this.V=new Cp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new rN}function rN(){this.i=null,this.g="",this.h=!1}var wG=45e3,iN={},pE={};N=ol.prototype;N.setTimeout=function(t){this.P=t};function gE(t,e,n){t.L=1,t.A=xp(ei(e)),t.u=n,t.S=!0,sN(t,null)}function sN(t,e){t.G=Date.now(),al(t),t.B=ei(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),fN(n.i,"t",r),t.o=0,n=t.l.J,t.h=new rN,t.g=kN(t.l,n?e:null,!t.u),0<t.O&&(t.M=new hE(Pt(t.Pa,t,t.g),t.O)),YR(t.U,t.g,"readystatechange",t.nb),e=t.I?UR(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Ju(),mG(t.j,t.v,t.B,t.m,t.W,t.u)}N.nb=function(t){t=t.target;let e=this.M;e&&Cr(t)==3?e.l():this.Pa(t)};N.Pa=function(t){try{if(t==this.g)e:{let l=Cr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||iE||this.g&&(this.h.h||this.g.ja()||NR(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Ju(3):Ju(2)),Ap(this);var n=this.g.da();this.ca=n;t:if(oN(this)){var r=NR(this.g);t="";var i=r.length,s=Cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vs(this),zu(this);var o="";break t}this.h.i=new Q.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,yG(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ku(a)){var u=a;break t}}u=null}if(n=u)wa(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,mE(this,n);else{this.i=!1,this.s=3,Gt(12),Vs(this),zu(this);break e}}this.S?(aN(this,l,o),iE&&this.i&&l==3&&(YR(this.U,this.V,"tick",this.mb),this.V.start())):(wa(this.j,this.m,o,null),mE(this,o)),l==4&&Vs(this),this.i&&!this.J&&(l==4?MN(this.l,this):(this.i=!1,al(this)))}else BG(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),Vs(this),zu(this)}}}catch{}finally{}};function oN(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function aN(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=EG(t,n),i==pE){e==4&&(t.s=4,Gt(14),r=!1),wa(t.j,t.m,null,"[Incomplete Response]");break}else if(i==iN){t.s=4,Gt(15),wa(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else wa(t.j,t.m,i,null),mE(t,i);oN(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Gt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),UE(e),e.M=!0,Gt(11))):(wa(t.j,t.m,n,"[Invalid Chunked Response]"),Vs(t),zu(t))}N.mb=function(){if(this.g){var t=Cr(this.g),e=this.g.ja();this.o<e.length&&(Ap(this),aN(this,t,e),this.i&&t!=4&&al(this))}};function EG(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?pE:(n=Number(e.substring(n,r)),isNaN(n)?iN:(r+=1,r+n>e.length?pE:(e=e.slice(r,r+n),t.o=r+n,e)))}N.cancel=function(){this.J=!0,Vs(this)};function al(t){t.Y=Date.now()+t.P,cN(t,t.P)}function cN(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=il(Pt(t.lb,t),e)}function Ap(t){t.C&&(Q.clearTimeout(t.C),t.C=null)}N.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(_G(this.j,this.B),this.L!=2&&(Ju(),Gt(17)),Vs(this),this.s=2,zu(this)):cN(this,this.Y-t)};function zu(t){t.l.H==0||t.J||MN(t.l,t)}function Vs(t){Ap(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,ME(t.V),ZR(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function mE(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||yE(n.i,t))){if(!t.K&&yE(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)gp(n),Np(n);else break e;jE(n),Gt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=il(Pt(n.ib,n),6e3));if(1>=mN(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Ls(n,11)}else if((t.K||n.g==t)&&gp(n),!Ku(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=u[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=u[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(OE(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Oe(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=PN(r,r.J?r.pa:null,r.Y),o.K){yN(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Ap(a),al(a)),r.g=o}else AN(r);0<n.j.length&&Pp(n)}else u[0]!="stop"&&u[0]!="close"||Ls(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?Ls(n,7):LE(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Ju(4)}catch{}}function IG(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(vp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function CG(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(vp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function uN(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(vp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=CG(t),r=IG(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var lN=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function DG(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function js(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof js){this.h=t.h,fp(this,t.j),this.s=t.s,this.g=t.g,pp(this,t.m),this.l=t.l;var e=t.i,n=new el;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),xR(this,n),this.o=t.o}else t&&(e=String(t).match(lN))?(this.h=!1,fp(this,e[1]||"",!0),this.s=Gu(e[2]||""),this.g=Gu(e[3]||"",!0),pp(this,e[4]),this.l=Gu(e[5]||"",!0),xR(this,e[6]||"",!0),this.o=Gu(e[7]||"")):(this.h=!1,this.i=new el(null,this.h))}js.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Wu(e,MR,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Wu(e,MR,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Wu(n,n.charAt(0)=="/"?SG:bG,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Wu(n,xG)),t.join("")};function ei(t){return new js(t)}function fp(t,e,n){t.j=n?Gu(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function pp(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function xR(t,e,n){e instanceof el?(t.i=e,MG(t.i,t.h)):(n||(e=Wu(e,AG)),t.i=new el(e,t.h))}function Oe(t,e,n){t.i.set(e,n)}function xp(t){return Oe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Gu(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wu(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,TG),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function TG(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var MR=/[#\/\?@]/g,bG=/[#\?:]/g,SG=/[#\?]/g,AG=/[#\?@]/g,xG=/#/g;function el(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Oi(t){t.g||(t.g=new Map,t.h=0,t.i&&DG(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}N=el.prototype;N.add=function(t,e){Oi(this),this.i=null,t=Ca(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function dN(t,e){Oi(t),e=Ca(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function hN(t,e){return Oi(t),e=Ca(t,e),t.g.has(e)}N.forEach=function(t,e){Oi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};N.ta=function(){Oi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};N.Z=function(t){Oi(this);let e=[];if(typeof t=="string")hN(this,t)&&(e=e.concat(this.g.get(Ca(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};N.set=function(t,e){return Oi(this),this.i=null,t=Ca(this,t),hN(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};N.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function fN(t,e,n){dN(t,e),0<n.length&&(t.i=null,t.g.set(Ca(t,e),EE(n)),t.h+=n.length)}N.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ca(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function MG(t,e){e&&!t.j&&(Oi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(dN(this,r),fN(this,i,n))},t)),t.j=e}var RG=class{constructor(t,e){this.g=t,this.map=e}};function pN(t){this.l=t||NG,Q.PerformanceNavigationTiming?(t=Q.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Q.g&&Q.g.Ka&&Q.g.Ka()&&Q.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var NG=10;function gN(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function mN(t){return t.h?1:t.g?t.g.size:0}function yE(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function OE(t,e){t.g?t.g.add(e):t.h=e}function yN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}pN.prototype.cancel=function(){if(this.i=_N(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function _N(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return EE(t.i)}var PG=class{stringify(t){return Q.JSON.stringify(t,void 0)}parse(t){return Q.JSON.parse(t,void 0)}};function kG(){this.g=new PG}function OG(t,e,n){let r=n||"";try{uN(t,function(i,s){let o=i;nl(i)&&(o=AE(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function FG(t,e){let n=new Dp;if(Q.Image){let r=new Image;r.onload=op(dp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=op(dp,n,r,"TestLoadImage: error",!1,e),r.onabort=op(dp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=op(dp,n,r,"TestLoadImage: timeout",!1,e),Q.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function dp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function cl(t){this.l=t.ec||null,this.j=t.ob||!1}wt(cl,NE);cl.prototype.g=function(){return new Mp(this.l,this.j)};cl.prototype.i=function(t){return function(){return t}}({});function Mp(t,e){vt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=FE,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}wt(Mp,vt);var FE=0;N=Mp.prototype;N.open=function(t,e){if(this.readyState!=FE)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,tl(this)};N.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Q).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};N.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ul(this)),this.readyState=FE};N.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,tl(this)),this.g&&(this.readyState=3,tl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Q.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vN(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function vN(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}N.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ul(this):tl(this),this.readyState==3&&vN(this)}};N.Za=function(t){this.g&&(this.response=this.responseText=t,ul(this))};N.Ya=function(t){this.g&&(this.response=t,ul(this))};N.ka=function(){this.g&&ul(this)};function ul(t){t.readyState=4,t.l=null,t.j=null,t.A=null,tl(t)}N.setRequestHeader=function(t,e){this.v.append(t,e)};N.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};N.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function tl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Mp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var VG=Q.JSON.parse;function ze(t){vt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=wN,this.L=this.M=!1}wt(ze,vt);var wN="",LG=/^https?$/i,jG=["POST","PUT"];N=ze.prototype;N.Oa=function(t){this.M=t};N.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():fE.g(),this.C=this.u?AR(this.u):AR(fE),this.g.onreadystatechange=Pt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){RR(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Q.FormData&&t instanceof Q.FormData,!(0<=FR(jG,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{CN(this),0<this.B&&((this.L=UG(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Pt(this.ua,this)):this.A=RE(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){RR(this,s)}};function UG(t){return Ia&&typeof t.timeout=="number"&&t.ontimeout!==void 0}N.ua=function(){typeof wE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Mt(this,"timeout"),this.abort(8))};function RR(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,EN(t),Rp(t)}function EN(t){t.F||(t.F=!0,Mt(t,"complete"),Mt(t,"error"))}N.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Mt(this,"complete"),Mt(this,"abort"),Rp(this))};N.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Rp(this,!0)),ze.$.N.call(this)};N.La=function(){this.s||(this.G||this.v||this.l?IN(this):this.kb())};N.kb=function(){IN(this)};function IN(t){if(t.h&&typeof wE<"u"&&(!t.C[1]||Cr(t)!=4||t.da()!=2)){if(t.v&&Cr(t)==4)RE(t.La,0,t);else if(Mt(t,"readystatechange"),Cr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(lN)[1]||null;!i&&Q.self&&Q.self.location&&(i=Q.self.location.protocol.slice(0,-1)),r=!LG.test(i?i.toLowerCase():"")}n=r}if(n)Mt(t,"complete"),Mt(t,"success");else{t.m=6;try{var s=2<Cr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",EN(t)}}finally{Rp(t)}}}}function Rp(t,e){if(t.g){CN(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Mt(t,"ready");try{n.onreadystatechange=r}catch{}}}function CN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Q.clearTimeout(t.A),t.A=null)}N.isActive=function(){return!!this.g};function Cr(t){return t.g?t.g.readyState:0}N.da=function(){try{return 2<Cr(this)?this.g.status:-1}catch{return-1}};N.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};N.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),VG(e)}};function NR(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case wN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function BG(t){let e={};t=(t.g&&2<=Cr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Ku(t[r]))continue;var n=fG(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}uG(e,function(r){return r.join(", ")})}N.Ia=function(){return this.m};N.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function DN(t){let e="";return CE(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function VE(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=DN(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Oe(t,e,n))}function Hu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function TN(t){this.Ga=0,this.j=[],this.l=new Dp,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Hu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Hu("baseRetryDelayMs",5e3,t),this.hb=Hu("retryDelaySeedMs",1e4,t),this.eb=Hu("forwardChannelMaxRetries",2,t),this.xa=Hu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new pN(t&&t.concurrentRequestLimit),this.Ja=new kG,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}N=TN.prototype;N.ra=8;N.H=1;function LE(t){if(bN(t),t.H==3){var e=t.W++,n=ei(t.I);if(Oe(n,"SID",t.K),Oe(n,"RID",e),Oe(n,"TYPE","terminate"),ll(t,n),e=new ol(t,t.l,e),e.L=2,e.A=xp(ei(n)),n=!1,Q.navigator&&Q.navigator.sendBeacon)try{n=Q.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Q.Image&&(new Image().src=e.A,n=!0),n||(e.g=kN(e.l,null),e.g.ha(e.A)),e.G=Date.now(),al(e)}NN(t)}function Np(t){t.g&&(UE(t),t.g.cancel(),t.g=null)}function bN(t){Np(t),t.u&&(Q.clearTimeout(t.u),t.u=null),gp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Q.clearTimeout(t.m),t.m=null)}function Pp(t){if(!gN(t.i)&&!t.m){t.m=!0;var e=t.Na;Yu||KR(),Zu||(Yu(),Zu=!0),xE.add(e,t),t.C=0}}function $G(t,e){return mN(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=il(Pt(t.Na,t,e),RN(t,t.C)),t.C++,!0)}N.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new ol(this,this.l,t),s=this.s;if(this.U&&(s?(s=UR(s),BR(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=SN(this,i,e),n=ei(this.I),Oe(n,"RID",t),Oe(n,"CVER",22),this.F&&Oe(n,"X-HTTP-Session-Id",this.F),ll(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(DN(s)))+"&"+e:this.o&&VE(n,this.o,s)),OE(this.i,i),this.bb&&Oe(n,"TYPE","init"),this.P?(Oe(n,"$req",e),Oe(n,"SID","null"),i.aa=!0,gE(i,n,null)):gE(i,n,e),this.H=2}}else this.H==3&&(t?PR(this,t):this.j.length==0||gN(this.i)||PR(this))};function PR(t,e){var n;e?n=e.m:n=t.W++;let r=ei(t.I);Oe(r,"SID",t.K),Oe(r,"RID",n),Oe(r,"AID",t.V),ll(t,r),t.o&&t.s&&VE(r,t.o,t.s),n=new ol(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=SN(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),OE(t.i,n),gE(n,r,e)}function ll(t,e){t.na&&CE(t.na,function(n,r){Oe(e,r,n)}),t.h&&uN({},function(n,r){Oe(e,r,n)})}function SN(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Pt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{OG(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function AN(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Yu||KR(),Zu||(Yu(),Zu=!0),xE.add(e,t),t.A=0}}function jE(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=il(Pt(t.Ma,t),RN(t,t.A)),t.A++,!0)}N.Ma=function(){if(this.u=null,xN(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=il(Pt(this.jb,this),t)}};N.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Gt(10),Np(this),xN(this))};function UE(t){t.B!=null&&(Q.clearTimeout(t.B),t.B=null)}function xN(t){t.g=new ol(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=ei(t.wa);Oe(e,"RID","rpc"),Oe(e,"SID",t.K),Oe(e,"AID",t.V),Oe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Oe(e,"TO",t.qa),Oe(e,"TYPE","xmlhttp"),ll(t,e),t.o&&t.s&&VE(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=xp(ei(e)),n.u=null,n.S=!0,sN(n,t)}N.ib=function(){this.v!=null&&(this.v=null,Np(this),jE(this),Gt(19))};function gp(t){t.v!=null&&(Q.clearTimeout(t.v),t.v=null)}function MN(t,e){var n=null;if(t.g==e){gp(t),UE(t),t.g=null;var r=2}else if(yE(t.i,e))n=e.F,yN(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=Tp(),Mt(r,new eN(r,n)),Pp(t)}else AN(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&$G(t,e)||r==2&&jE(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ls(t,5);break;case 4:Ls(t,10);break;case 3:Ls(t,6);break;default:Ls(t,2)}}}function RN(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ls(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Pt(t.pb,t);n||(n=new js("//www.google.com/images/cleardot.gif"),Q.location&&Q.location.protocol=="http"||fp(n,"https"),xp(n)),FG(n.toString(),r)}else Gt(2);t.H=0,t.h&&t.h.za(e),NN(t),bN(t)}N.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Gt(2)):(this.l.info("Failed to ping google.com"),Gt(1))};function NN(t){if(t.H=0,t.ma=[],t.h){let e=_N(t.i);(e.length!=0||t.j.length!=0)&&(DR(t.ma,e),DR(t.ma,t.j),t.i.i.length=0,EE(t.j),t.j.length=0),t.h.ya()}}function PN(t,e,n){var r=n instanceof js?ei(n):new js(n);if(r.g!="")e&&(r.g=e+"."+r.g),pp(r,r.m);else{var i=Q.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new js(null);r&&fp(s,r),e&&(s.g=e),i&&pp(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Oe(r,n,e),Oe(r,"VER",t.ra),ll(t,r),r}function kN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new ze(new cl({ob:n})):new ze(t.va),e.Oa(t.J),e}N.isActive=function(){return!!this.h&&this.h.isActive(this)};function ON(){}N=ON.prototype;N.Ba=function(){};N.Aa=function(){};N.za=function(){};N.ya=function(){};N.isActive=function(){return!0};N.Va=function(){};function mp(){if(Ia&&!(10<=Number(sG)))throw Error("Environmental error: no available transport.")}mp.prototype.g=function(t,e){return new yn(t,e)};function yn(t,e){vt.call(this),this.g=new TN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Ku(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ku(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Da(this)}wt(yn,vt);yn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Gt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=PN(t,null,t.Y),Pp(t)};yn.prototype.close=function(){LE(this.g)};yn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=AE(t),t=n);e.j.push(new RG(e.fb++,t)),e.H==3&&Pp(e)};yn.prototype.N=function(){this.g.h=null,delete this.j,LE(this.g),delete this.g,yn.$.N.call(this)};function FN(t){PE.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}wt(FN,PE);function VN(){kE.call(this),this.status=1}wt(VN,kE);function Da(t){this.g=t}wt(Da,ON);Da.prototype.Ba=function(){Mt(this.g,"a")};Da.prototype.Aa=function(t){Mt(this.g,new FN(t))};Da.prototype.za=function(t){Mt(this.g,new VN)};Da.prototype.ya=function(){Mt(this.g,"b")};function HG(){this.blockSize=-1}function Jn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}wt(Jn,HG);Jn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function rE(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Jn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)rE(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){rE(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){rE(this,r),i=0;break}}this.h=i,this.i+=e};Jn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ce(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var qG={};function BE(t){return-128<=t&&128>t?nG(t,function(e){return new Ce([e|0],0>e?-1:0)}):new Ce([t|0],0>t?-1:0)}function Dr(t){if(isNaN(t)||!isFinite(t))return Ea;if(0>t)return xt(Dr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=_E;return new Ce(e,0)}function LN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return xt(LN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Dr(Math.pow(e,8)),r=Ea,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Dr(Math.pow(e,s)),r=r.R(s).add(Dr(o))):(r=r.R(n),r=r.add(Dr(o)))}return r}var _E=4294967296,Ea=BE(0),vE=BE(1),kR=BE(16777216);N=Ce.prototype;N.ea=function(){if(Vn(this))return-xt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:_E+r)*e,e*=_E}return t};N.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Jr(this))return"0";if(Vn(this))return"-"+xt(this).toString(t);for(var e=Dr(Math.pow(t,6)),n=this,r="";;){var i=_p(n,e).g;n=yp(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Jr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};N.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Jr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Vn(t){return t.h==-1}N.X=function(t){return t=yp(this,t),Vn(t)?-1:Jr(t)?0:1};function xt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ce(n,~t.h).add(vE)}N.abs=function(){return Vn(this)?xt(this):this};N.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ce(n,n[n.length-1]&-2147483648?-1:0)};function yp(t,e){return t.add(xt(e))}N.R=function(t){if(Jr(this)||Jr(t))return Ea;if(Vn(this))return Vn(t)?xt(this).R(xt(t)):xt(xt(this).R(t));if(Vn(t))return xt(this.R(xt(t)));if(0>this.X(kR)&&0>t.X(kR))return Dr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,hp(n,2*r+2*i),n[2*r+2*i+1]+=s*c,hp(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,hp(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,hp(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ce(n,0)};function hp(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function qu(t,e){this.g=t,this.h=e}function _p(t,e){if(Jr(e))throw Error("division by zero");if(Jr(t))return new qu(Ea,Ea);if(Vn(t))return e=_p(xt(t),e),new qu(xt(e.g),xt(e.h));if(Vn(e))return e=_p(t,xt(e)),new qu(xt(e.g),e.h);if(30<t.g.length){if(Vn(t)||Vn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=vE,r=e;0>=r.X(t);)n=OR(n),r=OR(r);var i=va(n,1),s=va(r,1);for(r=va(r,2),n=va(n,2);!Jr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=va(r,1),n=va(n,1)}return e=yp(t,i.R(e)),new qu(i,e)}for(i=Ea;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Dr(n),o=s.R(e);Vn(o)||0<o.X(t);)n-=r,s=Dr(n),o=s.R(e);Jr(s)&&(s=vE),i=i.add(s),t=yp(t,o)}return new qu(i,t)}N.gb=function(t){return _p(this,t).h};N.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ce(n,this.h&t.h)};N.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ce(n,this.h|t.h)};N.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ce(n,this.h^t.h)};function OR(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ce(n,t.h)}function va(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ce(i,t.h)}mp.prototype.createWebChannel=mp.prototype.g;yn.prototype.send=yn.prototype.u;yn.prototype.open=yn.prototype.m;yn.prototype.close=yn.prototype.close;bp.NO_ERROR=0;bp.TIMEOUT=8;bp.HTTP_ERROR=6;tN.COMPLETE="complete";nN.EventType=sl;sl.OPEN="a";sl.CLOSE="b";sl.ERROR="c";sl.MESSAGE="d";vt.prototype.listen=vt.prototype.O;ze.prototype.listenOnce=ze.prototype.P;ze.prototype.getLastError=ze.prototype.Sa;ze.prototype.getLastErrorCode=ze.prototype.Ia;ze.prototype.getStatus=ze.prototype.da;ze.prototype.getResponseJson=ze.prototype.Wa;ze.prototype.getResponseText=ze.prototype.ja;ze.prototype.send=ze.prototype.ha;ze.prototype.setWithCredentials=ze.prototype.Oa;Jn.prototype.digest=Jn.prototype.l;Jn.prototype.reset=Jn.prototype.reset;Jn.prototype.update=Jn.prototype.j;Ce.prototype.add=Ce.prototype.add;Ce.prototype.multiply=Ce.prototype.R;Ce.prototype.modulo=Ce.prototype.gb;Ce.prototype.compare=Ce.prototype.X;Ce.prototype.toNumber=Ce.prototype.ea;Ce.prototype.toString=Ce.prototype.toString;Ce.prototype.getBits=Ce.prototype.D;Ce.fromNumber=Dr;Ce.fromString=LN;var jN=er.createWebChannelTransport=function(){return new mp},UN=er.getStatEventTarget=function(){return Tp()},kp=er.ErrorCode=bp,BN=er.EventType=tN,$N=er.Event=Us,$E=er.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Gne=er.FetchXmlHttpFactory=cl,dl=er.WebChannel=nN,HN=er.XhrIo=ze,qN=er.Md5=Jn,Bs=er.Integer=Ce;var GN="@firebase/firestore";var ot=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ot.UNAUTHENTICATED=new ot(null),ot.GOOGLE_CREDENTIALS=new ot("google-credentials-uid"),ot.FIRST_PARTY=new ot("first-party-uid"),ot.MOCK_USER=new ot("mock-user");var tc="10.9.0";var $i=new hi("@firebase/firestore");function xa(){return $i.logLevel}function GC(t){$i.setLogLevel(t)}function I(t,...e){if($i.logLevel<=Tn.DEBUG){let n=e.map(WC);$i.debug(`Firestore (${tc}): ${t}`,...n)}}function Je(t,...e){if($i.logLevel<=Tn.ERROR){let n=e.map(WC);$i.error(`Firestore (${tc}): ${t}`,...n)}}function jn(t,...e){if($i.logLevel<=Tn.WARN){let n=e.map(WC);$i.warn(`Firestore (${tc}): ${t}`,...n)}}function WC(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function O(t="Unexpected state"){let e=`FIRESTORE (${tc}) INTERNAL ASSERTION FAILED: `+t;throw Je(e),new Error(e)}function L(t,e){t||O()}function GP(t,e){t||O()}function R(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=class extends Ib{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var at=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Gp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},zE=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ot.UNAUTHENTICATED))}shutdown(){}},KE=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},QE=class{constructor(e){this.t=e,this.currentUser=ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new at;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new at,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>_(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{I("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(I("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new at)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(I("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(L(typeof r.accessToken=="string"),new Gp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return L(e===null||typeof e=="string"),new ot(e)}},YE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=ot.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},ZE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new YE(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}},XE=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},JE=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&I("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,I("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{I("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):I("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(L(typeof n.token=="string"),this.R=n.token,new XE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function GG(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Wp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=GG(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function J(t,e){return t<e?-1:t>e?1:0}function La(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function WP(t){return t+"\0"}var $e=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var B=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new $e(0,0))}static max(){return new t(new $e(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var zp=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&O(),r===void 0?r=e.length-n:r>e.length-n&&O(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},me=class t extends zp{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},WG=/^[_a-zA-Z][_a-zA-Z0-9]*$/,et=class t extends zp{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return WG.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new w(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new w(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new w(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var M=class t{constructor(e){this.path=e}static fromPath(e){return new t(me.fromString(e))}static fromName(e){return new t(me.fromString(e).popFirst(5))}static empty(){return new t(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new me(e.slice()))}};var ja=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function eI(t){return t.fields.find(e=>e.kind===2)}function Hs(t){return t.fields.filter(e=>e.kind!==2)}ja.UNKNOWN_ID=-1;var Oa=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Cl=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Un.min())}};function zP(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new Un(i,M.empty(),e)}function KP(t){return new Un(t.readTime,t.key,-1)}var Un=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(B.min(),M.empty(),-1)}static max(){return new t(B.max(),M.empty(),-1)}};function zC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=M.comparator(t.documentKey,e.documentKey),n!==0?n:J(t.largestBatchId,e.largestBatchId))}var QP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Kp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Xi(t){return _(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==QP)throw t;I("LocalStore","Unexpectedly lost primary lease")})}var m=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&O(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Qp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new at,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Qs(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=KC(r.target.error);this.V.reject(new Qs(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Qs(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(I("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new nI(n)}},ri=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Nc())===12.2&&Je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return I("SimpleDb","Removing database:",e),qs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Gd())return!1;if(t.C())return!0;let e=Nc(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return _(this,null,function*(){return this.db||(I("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Qs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new w(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new w(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Qs(e,o))},i.onupgradeneeded=s=>{I("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{I("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=n=>this.L(n)),this.db})}B(e){this.L=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return _(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Qp.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),m.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(I("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},tI=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return qs(this.k.delete())}},Qs=class extends w{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Ji(t){return t.name==="IndexedDbTransactionError"}var nI=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(I("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(I("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),qs(r)}add(e){return I("SimpleDb","ADD",this.store.name,e,e),qs(this.store.add(e))}get(e){return qs(this.store.get(e)).next(n=>(n===void 0&&(n=null),I("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return I("SimpleDb","DELETE",this.store.name,e),qs(this.store.delete(e))}count(){return I("SimpleDb","COUNT",this.store.name),qs(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new m((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new m((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){I("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new m((r,i)=>{n.onerror=s=>{let o=KC(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new m((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new tI(a),u=n(a.primaryKey,a.value,c);if(u instanceof m){let l=u.catch(d=>(c.done(),m.reject(d)));r.push(l)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>m.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function qs(t){return new m((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=KC(r.target.error);n(i)}})}var WN=!1;function KC(t){let e=ri.S(Nc());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new w("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return WN||(WN=!0,setTimeout(()=>{throw r},0)),r}}return t}var rI=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){I("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>_(this,null,function*(){this.task=null;try{I("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){Ji(n)?I("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Xi(n)}yield this.ee(6e4)}))}},iI=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return _(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return m.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return I("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(I("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=KP(s);zC(o,r)>0&&(r=o)}),new Un(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var _n=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Gl(t){return t==null}function Dl(t){return t===0&&1/t==-1/0}function YP(t){return typeof t=="number"&&Number.isInteger(t)&&!Dl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Wt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=zN(e)),e=zG(t.get(n),e);return zN(e)}function zG(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function zN(t){return t+""}function Tr(t){let e=t.length;if(L(e>=2),e===2)return L(t.charAt(0)===""&&t.charAt(1)===""),me.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&O(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:O()}s=o+2}return new me(r)}var KN=["userId","batchId"];function jp(t,e){return[t,Wt(e)]}function ZP(t,e,n){return[t,Wt(e),n]}var KG={},QG=["prefixPath","collectionGroup","readTime","documentId"],YG=["prefixPath","collectionGroup","documentId"],ZG=["collectionGroup","readTime","prefixPath","documentId"],XG=["canonicalId","targetId"],JG=["targetId","path"],eW=["path","targetId"],tW=["collectionId","parent"],nW=["indexId","uid"],rW=["uid","sequenceNumber"],iW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],sW=["indexId","uid","orderedDocumentKey"],oW=["userId","collectionPath","documentId"],aW=["userId","collectionPath","largestBatchId"],cW=["userId","collectionGroup","largestBatchId"],XP=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],uW=[...XP,"documentOverlays"],JP=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ek=JP,lW=[...ek,"indexConfiguration","indexState","indexEntries"];var Tl=class extends Kp{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function It(t,e){let n=R(t);return ri.M(n.ae,e)}function QN(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ao(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function tk(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Fe=class t{constructor(e,n){this.comparator=e,this.root=n||Sr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Sr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ka(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ka(this.root,e,this.comparator,!1)}getReverseIterator(){return new ka(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ka(this.root,e,this.comparator,!0)}},ka=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Sr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw O();let e=this.left.check();if(e!==this.right.check())throw O();return e+(this.isRed()?0:1)}};Sr.EMPTY=null,Sr.RED=!0,Sr.BLACK=!1;Sr.EMPTY=new class{constructor(){this.size=0}get key(){throw O()}get value(){throw O()}get color(){throw O()}get left(){throw O()}get right(){throw O()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Sr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var xe=class t{constructor(e){this.comparator=e,this.data=new Fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Yp(this.data.getIterator())}getIteratorFrom(e){return new Yp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Yp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ta(t){return t.hasNext()?t.getNext():void 0}var vn=class t{constructor(e){this.fields=e,e.sort(et.comparator)}static empty(){return new t([])}unionWith(e){let n=new xe(et.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return La(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Zp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function nk(){return typeof atob<"u"}var Et=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Zp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Et.EMPTY_BYTE_STRING=new Et("");var dW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hi(t){if(L(!!t),typeof t=="string"){let e=0,n=dW.exec(t);if(L(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ke(t.seconds),nanos:Ke(t.nanos)}}function Ke(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function qi(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}function Bg(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function QC(t){let e=t.mapValue.fields.__previous_value__;return Bg(e)?QC(e):e}function bl(t){let e=Hi(t.mapValue.fields.__local_write_time__.timestampValue);return new $e(e.seconds,e.nanos)}var sI=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},Gi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Ui={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Up={nullValue:"NULL_VALUE"};function Ys(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bg(t)?4:rk(t)?9007199254740991:10:O()}function Mr(t,e){if(t===e)return!0;let n=Ys(t);if(n!==Ys(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bl(t).isEqual(bl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Hi(i.timestampValue),a=Hi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return qi(i.bytesValue).isEqual(qi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ke(i.geoPointValue.latitude)===Ke(s.geoPointValue.latitude)&&Ke(i.geoPointValue.longitude)===Ke(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ke(i.integerValue)===Ke(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ke(i.doubleValue),a=Ke(s.doubleValue);return o===a?Dl(o)===Dl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return La(t.arrayValue.values||[],e.arrayValue.values||[],Mr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(QN(o)!==QN(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Mr(o[c],a[c])))return!1;return!0}(t,e);default:return O()}}function Sl(t,e){return(t.values||[]).find(n=>Mr(n,e))!==void 0}function Wi(t,e){if(t===e)return 0;let n=Ys(t),r=Ys(e);if(n!==r)return J(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return J(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ke(s.integerValue||s.doubleValue),c=Ke(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return YN(t.timestampValue,e.timestampValue);case 4:return YN(bl(t),bl(e));case 5:return J(t.stringValue,e.stringValue);case 6:return function(s,o){let a=qi(s),c=qi(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=J(a[u],c[u]);if(l!==0)return l}return J(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=J(Ke(s.latitude),Ke(o.latitude));return a!==0?a:J(Ke(s.longitude),Ke(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=Wi(a[u],c[u]);if(l)return l}return J(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Ui.mapValue&&o===Ui.mapValue)return 0;if(s===Ui.mapValue)return 1;if(o===Ui.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let d=0;d<c.length&&d<l.length;++d){let h=J(c[d],l[d]);if(h!==0)return h;let f=Wi(a[c[d]],u[l[d]]);if(f!==0)return f}return J(c.length,l.length)}(t.mapValue,e.mapValue);default:throw O()}}function YN(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return J(t,e);let n=Hi(t),r=Hi(e),i=J(n.seconds,r.seconds);return i!==0?i:J(n.nanos,r.nanos)}function Ua(t){return oI(t)}function oI(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Hi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return qi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return M.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=oI(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${oI(n.fields[o])}`;return i+"}"}(t.mapValue):O()}function Zs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function aI(t){return!!t&&"integerValue"in t}function Al(t){return!!t&&"arrayValue"in t}function ZN(t){return!!t&&"nullValue"in t}function XN(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bp(t){return!!t&&"mapValue"in t}function _l(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return ao(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=_l(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=_l(t.arrayValue.values[n]);return e}return Object.assign({},t)}function rk(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function hW(t){return"nullValue"in t?Up:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Zs(Gi.empty(),M.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:O()}function fW(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Zs(Gi.empty(),M.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Ui:O()}function JN(t,e){let n=Wi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function eP(t,e){let n=Wi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Ft=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Bp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=_l(n)}setAll(e){let n=et.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=_l(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Bp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Bp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){ao(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(_l(this.value))}};function ik(t){let e=[];return ao(t.fields,(n,r)=>{let i=new et([n]);if(Bp(r)){let s=ik(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new vn(e)}var ct=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,B.min(),B.min(),B.min(),Ft.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,B.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,B.min(),B.min(),Ft.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,B.min(),B.min(),Ft.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ft.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Rr=class{constructor(e,n){this.position=e,this.inclusive=n}};function tP(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=M.comparator(M.fromName(o.referenceValue),n.key):r=Wi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function nP(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mr(t.position[n],e.position[n]))return!1;return!0}var Xs=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function pW(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Xp=class{},fe=class t extends Xp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new lI(e,n,r):n==="array-contains"?new fI(e,r):n==="in"?new Jp(e,r):n==="not-in"?new pI(e,r):n==="array-contains-any"?new gI(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new dI(e,r):new hI(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Wi(n,this.value)):n!==null&&Ys(this.value)===Ys(n)&&this.matchesComparison(Wi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return O()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},De=class t extends Xp{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Ba(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Ba(t){return t.op==="and"}function cI(t){return t.op==="or"}function YC(t){return sk(t)&&Ba(t)}function sk(t){for(let e of t.filters)if(e instanceof De)return!1;return!0}function uI(t){if(t instanceof fe)return t.field.canonicalString()+t.op.toString()+Ua(t.value);if(YC(t))return t.filters.map(e=>uI(e)).join(",");{let e=t.filters.map(n=>uI(n)).join(",");return`${t.op}(${e})`}}function ok(t,e){return t instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.field.isEqual(i.field)&&Mr(r.value,i.value)}(t,e):t instanceof De?function(r,i){return i instanceof De&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&ok(o,i.filters[a]),!0):!1}(t,e):void O()}function ak(t,e){let n=t.filters.concat(e);return De.create(n,t.op)}function ck(t){return t instanceof fe?function(n){return`${n.field.canonicalString()} ${n.op} ${Ua(n.value)}`}(t):t instanceof De?function(n){return n.op.toString()+" {"+n.getFilters().map(ck).join(" ,")+"}"}(t):"Filter"}var lI=class extends fe{constructor(e,n,r){super(e,n,r),this.key=M.fromName(r.referenceValue)}matches(e){let n=M.comparator(e.key,this.key);return this.matchesComparison(n)}},dI=class extends fe{constructor(e,n){super(e,"in",n),this.keys=uk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},hI=class extends fe{constructor(e,n){super(e,"not-in",n),this.keys=uk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function uk(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>M.fromName(r.referenceValue))}var fI=class extends fe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return Al(n)&&Sl(n.arrayValue,this.value)}},Jp=class extends fe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Sl(this.value.arrayValue,n)}},pI=class extends fe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Sl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Sl(this.value.arrayValue,n)}},gI=class extends fe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!Al(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Sl(this.value.arrayValue,r))}};var mI=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function yI(t,e=null,n=[],r=[],i=null,s=null,o=null){return new mI(t,e,n,r,i,s,o)}function Js(t){let e=R(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>uI(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Gl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ua(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ua(r)).join(",")),e.ce=n}return e.ce}function Wl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!pW(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ok(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!nP(t.startAt,e.startAt)&&nP(t.endAt,e.endAt)}function eg(t){return M.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function tg(t,e){return t.filters.filter(n=>n instanceof fe&&n.field.isEqual(e))}function rP(t,e,n){let r=Up,i=!0;for(let s of tg(t,e)){let o=Up,a=!0;switch(s.op){case"<":case"<=":o=hW(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Up}JN({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];JN({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function iP(t,e,n){let r=Ui,i=!0;for(let s of tg(t,e)){let o=Ui,a=!0;switch(s.op){case">=":case">":o=fW(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ui}eP({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];eP({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var tr=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function lk(t,e,n,r,i,s,o,a){return new tr(t,e,n,r,i,s,o,a)}function nc(t){return new tr(t)}function sP(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ZC(t){return t.collectionGroup!==null}function Fa(t){let e=R(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new xe(et.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new Xs(s,r))}),n.has(et.keyField().canonicalString())||e.le.push(new Xs(et.keyField(),r))}return e.le}function zt(t){let e=R(t);return e.he||(e.he=gW(e,Fa(t))),e.he}function gW(t,e){if(t.limitType==="F")return yI(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Xs(i.field,s)});let n=t.endAt?new Rr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Rr(t.startAt.position,t.startAt.inclusive):null;return yI(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function _I(t,e){let n=t.filters.concat([e]);return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ng(t,e,n){return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function zl(t,e){return Wl(zt(t),zt(e))&&t.limitType===e.limitType}function dk(t){return`${Js(zt(t))}|lt:${t.limitType}`}function Ma(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>ck(i)).join(", ")}]`),Gl(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ua(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ua(i)).join(",")),`Target(${r})`}(zt(t))}; limitType=${t.limitType})`}function Kl(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):M.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Fa(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=tP(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,Fa(r),i)||r.endAt&&!function(o,a,c){let u=tP(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,Fa(r),i))}(t,e)}function hk(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function fk(t){return(e,n)=>{let r=!1;for(let i of Fa(t)){let s=mW(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function mW(t,e,n){let r=t.field.isKeyField()?M.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Wi(c,u):O()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return O()}}var Nr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ao(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return tk(this.inner)}size(){return this.innerSize}};var yW=new Fe(M.comparator);function cn(){return yW}var pk=new Fe(M.comparator);function ml(...t){let e=pk;for(let n of t)e=e.insert(n.key,n);return e}function gk(t){let e=pk;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function br(){return vl()}function mk(){return vl()}function vl(){return new Nr(t=>t.toString(),(t,e)=>t.isEqual(e))}var _W=new Fe(M.comparator),vW=new xe(M.comparator);function te(...t){let e=vW;for(let n of t)e=e.add(n);return e}var wW=new xe(J);function XC(){return wW}function yk(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dl(e)?"-0":e}}function _k(t){return{integerValue:""+t}}function vk(t,e){return YP(e)?_k(e):yk(t,e)}var $a=class{constructor(){this._=void 0}};function EW(t,e,n){return t instanceof zi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Bg(s)&&(s=QC(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ii?Ek(t,e):t instanceof si?Ik(t,e):function(i,s){let o=wk(i,s),a=oP(o)+oP(i.Ie);return aI(o)&&aI(i.Ie)?_k(a):yk(i.serializer,a)}(t,e)}function IW(t,e,n){return t instanceof ii?Ek(t,e):t instanceof si?Ik(t,e):n}function wk(t,e){return t instanceof Ki?function(r){return aI(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var zi=class extends $a{},ii=class extends $a{constructor(e){super(),this.elements=e}};function Ek(t,e){let n=Ck(e);for(let r of t.elements)n.some(i=>Mr(i,r))||n.push(r);return{arrayValue:{values:n}}}var si=class extends $a{constructor(e){super(),this.elements=e}};function Ik(t,e){let n=Ck(e);for(let r of t.elements)n=n.filter(i=>!Mr(i,r));return{arrayValue:{values:n}}}var Ki=class extends $a{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function oP(t){return Ke(t.integerValue||t.doubleValue)}function Ck(t){return Al(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var eo=class{constructor(e,n){this.field=e,this.transform=n}};function CW(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ii&&i instanceof ii||r instanceof si&&i instanceof si?La(r.elements,i.elements,Mr):r instanceof Ki&&i instanceof Ki?Mr(r.Ie,i.Ie):r instanceof zi&&i instanceof zi}(t.transform,e.transform)}var vI=class{constructor(e,n){this.version=e,this.transformResults=n}},Qe=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function $p(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Ha=class{};function Dk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yi(t.key,Qe.none()):new Qi(t.key,t.data,Qe.none());{let n=t.data,r=Ft.empty(),i=new xe(et.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new nr(t.key,r,new vn(i.toArray()),Qe.none())}}function DW(t,e,n){t instanceof Qi?function(i,s,o){let a=i.value.clone(),c=cP(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof nr?function(i,s,o){if(!$p(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=cP(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Tk(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function wl(t,e,n,r){return t instanceof Qi?function(s,o,a,c){if(!$p(s.precondition,o))return a;let u=s.value.clone(),l=uP(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof nr?function(s,o,a,c){if(!$p(s.precondition,o))return a;let u=uP(s.fieldTransforms,c,o),l=o.data;return l.setAll(Tk(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return $p(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function TW(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=wk(r.transform,i||null);s!=null&&(n===null&&(n=Ft.empty()),n.set(r.field,s))}return n||null}function aP(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&La(r,i,(s,o)=>CW(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Qi=class extends Ha{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nr=class extends Ha{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Tk(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function cP(t,e,n){let r=new Map;L(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,IW(o,a,n[i]))}return r}function uP(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,EW(s,o,e))}return r}var Yi=class extends Ha{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},xl=class extends Ha{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ml=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&DW(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=wl(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=wl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=mk();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=Dk(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(B.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),te())}isEqual(e){return this.batchId===e.batchId&&La(this.mutations,e.mutations,(n,r)=>aP(n,r))&&La(this.baseMutations,e.baseMutations,(n,r)=>aP(n,r))}},wI=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){L(e.mutations.length===r.length);let i=function(){return _W}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Rl=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var EI=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var it,ge;function bk(t){switch(t){default:return O();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function Sk(t){if(t===void 0)return Je("GRPC error has no .code"),y.UNKNOWN;switch(t){case it.OK:return y.OK;case it.CANCELLED:return y.CANCELLED;case it.UNKNOWN:return y.UNKNOWN;case it.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case it.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case it.INTERNAL:return y.INTERNAL;case it.UNAVAILABLE:return y.UNAVAILABLE;case it.UNAUTHENTICATED:return y.UNAUTHENTICATED;case it.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case it.NOT_FOUND:return y.NOT_FOUND;case it.ALREADY_EXISTS:return y.ALREADY_EXISTS;case it.PERMISSION_DENIED:return y.PERMISSION_DENIED;case it.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case it.ABORTED:return y.ABORTED;case it.OUT_OF_RANGE:return y.OUT_OF_RANGE;case it.UNIMPLEMENTED:return y.UNIMPLEMENTED;case it.DATA_LOSS:return y.DATA_LOSS;default:return O()}}(ge=it||(it={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";var lP=null;function Ak(){return new TextEncoder}var bW=new Bs([4294967295,4294967295],0);function dP(t){let e=Ak().encode(t),n=new qN;return n.update(e),new Uint8Array(n.digest())}function hP(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Bs([n,r],0),new Bs([i,s],0)]}var II=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ks(`Invalid padding: ${n}`);if(r<0)throw new Ks(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ks(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ks(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Bs.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Bs.fromNumber(r)));return i.compare(bW)===1&&(i=new Bs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=dP(e),[r,i]=hP(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=dP(e),[r,i]=hP(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ks=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Nl=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Pl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(B.min(),i,new Fe(J),cn(),te())}},Pl=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,te(),te(),te())}};var Va=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},rg=class{constructor(e,n){this.targetId=e,this.fe=n}},ig=class{constructor(e,n,r=Et.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},sg=class{constructor(){this.ge=0,this.pe=pP(),this.ye=Et.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=te(),n=te(),r=te();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:O()}}),new Pl(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=pP()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,L(this.ge>=0)}Le(){this.Se=!0,this.we=!0}},CI=class{constructor(e){this.Be=e,this.ke=new Map,this.qe=cn(),this.Qe=fP(),this.Ke=new Fe(J)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:O()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(eg(s))if(r===0){let o=new M(s.path);this.We(n,o,ct.newNoDocument(o,B.min()))}else L(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}lP?.tt(function(l,d,h,f,p){var g,v,T,F,S,H;let W={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},Y=d.unchangedNames;return Y&&(W.bloomFilter={applied:p===0,hashCount:(g=Y?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(F=(T=(v=Y?.bits)===null||v===void 0?void 0:v.bitmap)===null||T===void 0?void 0:T.length)!==null&&F!==void 0?F:0,padding:(H=(S=Y?.bits)===null||S===void 0?void 0:S.padding)!==null&&H!==void 0?H:0,mightContain:Te=>{var Xt;return(Xt=f?.mightContain(Te))!==null&&Xt!==void 0&&Xt}}),W}(o,e.fe,this.Be.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=qi(r).toUint8Array()}catch(c){if(c instanceof Zp)return jn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new II(o,i,s)}catch(c){return jn(c instanceof Ks?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Be.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Be.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&eg(a.target)){let c=new M(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,ct.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=te();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Nl(e,n,this.Ke,this.qe,r);return this.qe=cn(),this.Qe=fP(),this.Ke=new Fe(J),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new sg,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new xe(J),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||I("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Be._t(e)}He(e){this.ke.set(e,new sg),this.Be.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Be.getRemoteKeysForTarget(e).has(n)}};function fP(){return new Fe(M.comparator)}function pP(){return new Fe(M.comparator)}var SW={asc:"ASCENDING",desc:"DESCENDING"},AW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xW={and:"AND",or:"OR"},DI=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function TI(t,e){return t.useProto3Json||Gl(e)?e:{value:e}}function qa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function MW(t,e){return qa(t,e.toTimestamp())}function tt(t){return L(!!t),B.fromTimestamp(function(n){let r=Hi(n);return new $e(r.seconds,r.nanos)}(t))}function JC(t,e){return bI(t,e).canonicalString()}function bI(t,e){let n=function(i){return new me(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Mk(t){let e=me.fromString(t);return L(Uk(e)),e}function kl(t,e){return JC(t.databaseId,e.path)}function Ar(t,e){let n=Mk(e);if(n.get(1)!==t.databaseId.projectId)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new M(Pk(n))}function Rk(t,e){return JC(t.databaseId,e)}function Nk(t){let e=Mk(t);return e.length===4?me.emptyPath():Pk(e)}function SI(t){return new me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Pk(t){return L(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function gP(t,e,n){return{name:kl(t,e),fields:n.value.mapValue.fields}}function kk(t,e,n){let r=Ar(t,e.name),i=tt(e.updateTime),s=e.createTime?tt(e.createTime):B.min(),o=new Ft({mapValue:{fields:e.fields}}),a=ct.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function RW(t,e){return"found"in e?function(r,i){L(!!i.found),i.found.name,i.found.updateTime;let s=Ar(r,i.found.name),o=tt(i.found.updateTime),a=i.found.createTime?tt(i.found.createTime):B.min(),c=new Ft({mapValue:{fields:i.found.fields}});return ct.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){L(!!i.missing),L(!!i.readTime);let s=Ar(r,i.missing),o=tt(i.readTime);return ct.newNoDocument(s,o)}(t,e):O()}function NW(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:O()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,l){return u.useProto3Json?(L(l===void 0||typeof l=="string"),Et.fromBase64String(l||"")):(L(l===void 0||l instanceof Uint8Array),Et.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let l=u.code===void 0?y.UNKNOWN:Sk(u.code);return new w(l,u.message||"")}(o);n=new ig(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ar(t,r.document.name),s=tt(r.document.updateTime),o=r.document.createTime?tt(r.document.createTime):B.min(),a=new Ft({mapValue:{fields:r.document.fields}}),c=ct.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Va(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ar(t,r.document),s=r.readTime?tt(r.readTime):B.min(),o=ct.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Va([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ar(t,r.document),s=r.removedTargetIds||[];n=new Va([],s,i,null)}else{if(!("filter"in e))return O();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new EI(i,s),a=r.targetId;n=new rg(a,o)}}return n}function Ol(t,e){let n;if(e instanceof Qi)n={update:gP(t,e.key,e.value)};else if(e instanceof Yi)n={delete:kl(t,e.key)};else if(e instanceof nr)n={update:gP(t,e.key,e.data),updateMask:LW(e.fieldMask)};else{if(!(e instanceof xl))return O();n={verify:kl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof zi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ii)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof si)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ki)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw O()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:MW(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:O()}(t,e.precondition)),n}function AI(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?Qe.updateTime(tt(s.updateTime)):s.exists!==void 0?Qe.exists(s.exists):Qe.none()}(e.currentDocument):Qe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)L(a.setToServerValue==="REQUEST_TIME"),c=new zi;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];c=new ii(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];c=new si(l)}else"increment"in a?c=new Ki(o,a.increment):O();let u=et.fromServerFormat(a.fieldPath);return new eo(u,c)}(t,i)):[];if(e.update){e.update.name;let i=Ar(t,e.update.name),s=new Ft({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new vn(u.map(l=>et.fromServerFormat(l)))}(e.updateMask);return new nr(i,s,o,n,r)}return new Qi(i,s,n,r)}if(e.delete){let i=Ar(t,e.delete);return new Yi(i,n)}if(e.verify){let i=Ar(t,e.verify);return new xl(i,n)}return O()}function PW(t,e){return t&&t.length>0?(L(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?tt(i.updateTime):tt(s);return o.isEqual(B.min())&&(o=tt(s)),new vI(o,i.transformResults||[])}(n,e))):[]}function Ok(t,e){return{documents:[Rk(t,e.path)]}}function Fk(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Rk(t,i);let s=function(u){if(u.length!==0)return jk(De.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(l=>function(h){return{field:Ra(h.field),direction:OW(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=TI(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ut:n,parent:i}}function Vk(t){let e=Nk(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){L(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=Lk(d);return h instanceof De&&YC(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new Xs(Na(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Gl(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){let h=!!d.before,f=d.values||[];return new Rr(f,h)}(n.startAt));let u=null;return n.endAt&&(u=function(d){let h=!d.before,f=d.values||[];return new Rr(f,h)}(n.endAt)),lk(e,i,o,s,a,"F",c,u)}function kW(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return O()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Lk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Na(n.unaryFilter.field);return fe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Na(n.unaryFilter.field);return fe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Na(n.unaryFilter.field);return fe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Na(n.unaryFilter.field);return fe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return O()}}(t):t.fieldFilter!==void 0?function(n){return fe.create(Na(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return O()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return De.create(n.compositeFilter.filters.map(r=>Lk(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return O()}}(n.compositeFilter.op))}(t):O()}function OW(t){return SW[t]}function FW(t){return AW[t]}function VW(t){return xW[t]}function Ra(t){return{fieldPath:t.canonicalString()}}function Na(t){return et.fromServerFormat(t.fieldPath)}function jk(t){return t instanceof fe?function(n){if(n.op==="=="){if(XN(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NAN"}};if(ZN(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(XN(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NOT_NAN"}};if(ZN(n.value))return{unaryFilter:{field:Ra(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ra(n.field),op:FW(n.op),value:n.value}}}(t):t instanceof De?function(n){let r=n.getFilters().map(i=>jk(i));return r.length===1?r[0]:{compositeFilter:{op:VW(n.op),filters:r}}}(t):O()}function LW(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Uk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Ga=class t{constructor(e,n,r,i,s=B.min(),o=B.min(),a=Et.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var og=class{constructor(e){this.ct=e}};function jW(t,e){let n;if(e.document)n=kk(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=M.fromSegments(e.noDocument.path),i=no(e.noDocument.readTime);n=ct.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return O();{let r=M.fromSegments(e.unknownDocument.path),i=no(e.unknownDocument.version);n=ct.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new $e(i[0],i[1]);return B.fromTimestamp(s)}(e.readTime)),n}function mP(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ag(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:kl(s,o.key),fields:o.data.value.mapValue.fields,updateTime:qa(s,o.version.toTimestamp()),createTime:qa(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:to(e.version)};else{if(!e.isUnknownDocument())return O();r.unknownDocument={path:n.path.toArray(),version:to(e.version)}}return r}function ag(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function to(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function no(t){let e=new $e(t.seconds,t.nanoseconds);return B.fromTimestamp(e)}function Gs(t,e){let n=(e.baseMutations||[]).map(s=>AI(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>AI(t.ct,s)),i=$e.fromMillis(e.localWriteTimeMs);return new Ml(e.batchId,i,n,r)}function yl(t){let e=no(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?no(t.lastLimboFreeSnapshotVersion):B.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return L(s.documents.length===1),zt(nc(Nk(s.documents[0])))}(t.query):function(s){return zt(Vk(s))}(t.query),new Ga(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Et.fromBase64String(t.resumeToken))}function Bk(t,e){let n=to(e.snapshotVersion),r=to(e.lastLimboFreeSnapshotVersion),i;i=eg(e.target)?Ok(t.ct,e.target):Fk(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Js(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function e0(t){let e=Vk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ng(e,e.limit,"L"):e}function HE(t,e){return new Rl(e.largestBatchId,AI(t.ct,e.overlayMutation))}function yP(t,e){let n=e.path.lastSegment();return[t,Wt(e.path.popLast()),n]}function _P(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:to(r.readTime),documentKey:Wt(r.documentKey.path),largestBatchId:r.largestBatchId}}var xI=class{getBundleMetadata(e,n){return vP(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:no(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return vP(e).put(function(i){return{bundleId:i.id,createTime:to(tt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return wP(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:e0(s.bundledQuery),readTime:no(s.readTime)}}(r)})}saveNamedQuery(e,n){return wP(e).put(function(i){return{name:i.name,readTime:to(tt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function vP(t){return It(t,"bundles")}function wP(t){return It(t,"namedQueries")}var cg=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return hl(e).get(yP(this.userId,n)).next(r=>r?HE(this.serializer,r):null)}getOverlays(e,n){let r=br();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Rl(n,o);i.push(this.ht(e,a))}),m.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Wt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(hl(e).H("collectionPathOverlayIndex",a))}),m.waitFor(s)}getOverlaysForCollection(e,n,r){let i=br(),s=Wt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return hl(e).W("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=HE(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=br(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return hl(e).Y({index:"collectionGroupOverlayIndex",range:a},(c,u,l)=>{let d=HE(this.serializer,u);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return hl(e).put(function(i,s,o){let[a,c,u]=yP(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ol(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function hl(t){return It(t,"documentOverlays")}var ti=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Ke(e.integerValue));else if("doubleValue"in e){let r=Ke(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Dl(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(qi(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?rk(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):O()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),M.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};ti.bt=new ti;function UW(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function EP(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=UW(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var MI=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let n=this.Bt(e),r=EP(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Bt(e),r=EP(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},RI=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},NI=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Ws=class{constructor(){this.Gt=new MI,this.zt=new RI(this.Gt),this.jt=new NI(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var zs=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Fi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=IP(t.arrayValue,e.arrayValue),n!==0?n:(n=IP(t.directionalValue,e.directionalValue),n!==0?n:M.comparator(t.documentKey,e.documentKey)))}function IP(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var ug=class{constructor(e){this.Yt=new xe((n,r)=>et.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(L(e.collectionGroup===this.collectionId),this.en)return!1;let n=eI(e);if(n!==void 0&&!this.nn(n))return!1;let r=Hs(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new xe(et.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Oa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Oa(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Oa(r.field,r.dir==="asc"?0:1)));return new ja(ja.UNKNOWN_ID,this.collectionId,n,Cl.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function $k(t){var e,n;if(L(t instanceof fe||t instanceof De),t instanceof fe){if(t instanceof Jp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>fe.create(t.field,"==",s)))||[];return De.create(i,"or")}return t}let r=t.filters.map(i=>$k(i));return De.create(r,t.op)}function BW(t){if(t.getFilters().length===0)return[];let e=OI($k(t));return L(Hk(e)),PI(e)||kI(e)?[e]:e.getFilters()}function PI(t){return t instanceof fe}function kI(t){return t instanceof De&&YC(t)}function Hk(t){return PI(t)||kI(t)||function(n){if(n instanceof De&&cI(n)){for(let r of n.getFilters())if(!PI(r)&&!kI(r))return!1;return!0}return!1}(t)}function OI(t){if(L(t instanceof fe||t instanceof De),t instanceof fe)return t;if(t.filters.length===1)return OI(t.filters[0]);let e=t.filters.map(r=>OI(r)),n=De.create(e,t.op);return n=lg(n),Hk(n)?n:(L(n instanceof De),L(Ba(n)),L(n.filters.length>1),n.filters.reduce((r,i)=>t0(r,i)))}function t0(t,e){let n;return L(t instanceof fe||t instanceof De),L(e instanceof fe||e instanceof De),n=t instanceof fe?e instanceof fe?function(i,s){return De.create([i,s],"and")}(t,e):CP(t,e):e instanceof fe?CP(e,t):function(i,s){if(L(i.filters.length>0&&s.filters.length>0),Ba(i)&&Ba(s))return ak(i,s.getFilters());let o=cI(i)?i:s,a=cI(i)?s:i,c=o.filters.map(u=>t0(u,a));return De.create(c,"or")}(t,e),lg(n)}function CP(t,e){if(Ba(e))return ak(e,t.getFilters());{let n=e.filters.map(r=>t0(t,r));return De.create(n,"or")}}function lg(t){if(L(t instanceof fe||t instanceof De),t instanceof fe)return t;let e=t.getFilters();if(e.length===1)return lg(e[0]);if(sk(t))return t;let n=e.map(i=>lg(i)),r=[];return n.forEach(i=>{i instanceof fe?r.push(i):i instanceof De&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:De.create(r,t.op)}var FI=class{constructor(){this._n=new Fl}addToCollectionParentIndex(e,n){return this._n.add(n),m.resolve()}getCollectionParents(e,n){return m.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return m.resolve()}deleteFieldIndex(e,n){return m.resolve()}deleteAllFieldIndexes(e){return m.resolve()}createTargetIndexes(e,n){return m.resolve()}getDocumentsMatchingTarget(e,n){return m.resolve(null)}getIndexType(e,n){return m.resolve(0)}getFieldIndexes(e,n){return m.resolve([])}getNextCollectionGroupToUpdate(e){return m.resolve(null)}getMinOffset(e,n){return m.resolve(Un.min())}getMinOffsetFromCollectionGroup(e,n){return m.resolve(Un.min())}updateCollectionGroup(e,n,r){return m.resolve()}updateIndexEntries(e,n){return m.resolve()}},Fl=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new xe(me.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new xe(me.comparator)).toArray()}};var Op=new Uint8Array(0),VI=class{constructor(e,n){this.databaseId=n,this.an=new Fl,this.un=new Nr(r=>Js(r),(r,i)=>Wl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Wt(i)};return DP(e).put(s)}return m.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[WP(n),""],!1,!0);return DP(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(Tr(o.parent))}return r})}addFieldIndex(e,n){let r=fl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Sa(e);return s.next(a=>{o.put(_P(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=fl(e),i=Sa(e),s=ba(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=fl(e),r=ba(e),i=Sa(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return m.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new ug(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=ba(e),i=!0,s=new Map;return m.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=te(),a=[];return m.forEach(s,(c,u)=>{I("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(H=>`${H.fieldPath}:${H.kind}`).join(",")}`}(c)} to execute ${Js(n)}`);let l=function(S,H){let W=eI(H);if(W===void 0)return null;for(let Y of tg(S,W.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(u,c),d=function(S,H){let W=new Map;for(let Y of Hs(H))for(let Te of tg(S,Y.fieldPath))switch(Te.op){case"==":case"in":W.set(Y.fieldPath.canonicalString(),Te.value);break;case"not-in":case"!=":return W.set(Y.fieldPath.canonicalString(),Te.value),Array.from(W.values())}return null}(u,c),h=function(S,H){let W=[],Y=!0;for(let Te of Hs(H)){let Xt=Te.kind===0?rP(S,Te.fieldPath,S.startAt):iP(S,Te.fieldPath,S.startAt);W.push(Xt.value),Y&&(Y=Xt.inclusive)}return new Rr(W,Y)}(u,c),f=function(S,H){let W=[],Y=!0;for(let Te of Hs(H)){let Xt=Te.kind===0?iP(S,Te.fieldPath,S.endAt):rP(S,Te.fieldPath,S.endAt);W.push(Xt.value),Y&&(Y=Xt.inclusive)}return new Rr(W,Y)}(u,c),p=this.hn(c,u,h),g=this.hn(c,u,f),v=this.Pn(c,u,d),T=this.In(c.indexId,l,p,h.inclusive,g,f.inclusive,v);return m.forEach(T,F=>r.j(F,n.limit).next(S=>{S.forEach(H=>{let W=M.fromSegments(H.documentKey);o.has(W)||(o=o.add(W),a.push(W))})}))}).next(()=>a)}return m.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=BW(De.create(e.filters,"and")).map(r=>yI(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),u=c/(n!=null?n.length:1),l=[];for(let d=0;d<c;++d){let h=n?this.Tn(n[d/u]):Op,f=this.En(e,h,r[d%u],i),p=this.dn(e,h,s[d%u],o),g=a.map(v=>this.En(e,h,v,!0));l.push(...this.createRange(f,p,g))}return l}En(e,n,r,i){let s=new zs(e,M.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new zs(e,M.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new ug(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return m.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new xe(et.comparator),l=!1;for(let d of c.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:u=u.add(h.field));for(let d of c.orderBy)d.field.isKeyField()||(u=u.add(d.field));return u.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new Ws;for(let i of Hs(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);ti.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new Ws;return ti.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new Ws;return ti.bt.Pt(Zs(this.databaseId,n),r.Ht(function(s){let o=Hs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Ws);let s=0;for(let o of Hs(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&Al(a))i=this.mn(i,o,a);else{let u=c.Ht(o.kind);ti.bt.Pt(a,u)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Ws;c.seed(a.Wt()),ti.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof fe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=fl(e),i=Sa(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return m.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(l,d){let h=d?new Cl(d.sequenceNumber,new Un(no(d.readTime),new M(Tr(d.documentKey)),d.largestBatchId)):Cl.empty(),f=l.fields.map(([p,g])=>new Oa(et.fromServerFormat(p),g));return new ja(l.indexId,l.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:J(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=fl(e),s=Sa(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>m.forEach(a,c=>s.put(_P(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return m.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?m.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),m.forEach(a,c=>this.pn(e,i,c).next(u=>{let l=this.yn(s,c);return u.isEqual(l)?m.resolve():this.wn(e,s,c,u,l)}))))})}Sn(e,n,r,i){return ba(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return ba(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=ba(e),s=new xe(Fi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new zs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new xe(Fi),i=this.An(n,e);if(i==null)return r;let s=eI(n);if(s!=null){let o=e.data.field(s.fieldPath);if(Al(o))for(let a of o.arrayValue.values||[])r=r.add(new zs(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new zs(n.indexId,e.key,Op,i));return r}wn(e,n,r,i,s){I("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,u,l,d,h){let f=c.getIterator(),p=u.getIterator(),g=Ta(f),v=Ta(p);for(;g||v;){let T=!1,F=!1;if(g&&v){let S=l(g,v);S<0?F=!0:S>0&&(T=!0)}else g!=null?F=!0:T=!0;T?(d(v),v=Ta(p)):F?(h(g),g=Ta(f)):(g=Ta(f),v=Ta(p))}}(i,s,Fi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),m.waitFor(o)}gn(e){let n=1;return Sa(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Fi(o,a)).filter((o,a,c)=>!a||Fi(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Fi(o,e),c=Fi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Op,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Op,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return Fi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(TP)}getMinOffset(e,n){return m.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||O())).next(TP)}};function DP(t){return It(t,"collectionParents")}function ba(t){return It(t,"indexEntries")}function fl(t){return It(t,"indexConfiguration")}function Sa(t){return It(t,"indexState")}function TP(t){L(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;zC(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Un(e.readTime,e.documentKey,n)}var bP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ln=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function qk(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(c.next(()=>{L(a===1)}));let u=[];for(let l of n.mutations){let d=ZP(e,l.key.path,n.batchId);s.push(i.delete(d)),u.push(l.key)}return m.waitFor(s).next(()=>u)}function dg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw O();e=t.noDocument}return JSON.stringify(e).length}Ln.DEFAULT_COLLECTION_PERCENTILE=10,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ln.DEFAULT=new Ln(41943040,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ln.DISABLED=new Ln(-1,0,0);var hg=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){L(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Pa(e),o=Vi(e);return o.add({}).next(a=>{L(typeof a=="number");let c=new Ml(a,n,r,i),u=function(f,p,g){let v=g.baseMutations.map(F=>Ol(f.ct,F)),T=g.mutations.map(F=>Ol(f.ct,F));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:v,mutations:T}}(this.serializer,this.userId,c),l=[],d=new xe((h,f)=>J(h.canonicalString(),f.canonicalString()));for(let h of i){let f=ZP(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(u)),l.push(s.put(f,KG))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),m.waitFor(l).next(()=>c)})}lookupMutationBatch(e,n){return Vi(e).get(n).next(r=>r?(L(r.userId===this.userId),Gs(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?m.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Vi(e).Y({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(L(a.batchId>=r),s=Gs(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Vi(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).W("userMutationsIndex",n).next(r=>r.map(i=>Gs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=jp(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Pa(e).Y({range:i},(o,a,c)=>{let[u,l,d]=o,h=Tr(l);if(u===this.userId&&n.path.isEqual(h))return Vi(e).get(d).next(f=>{if(!f)throw O();L(f.userId===this.userId),s.push(Gs(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xe(J),i=[];return n.forEach(s=>{let o=jp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Pa(e).Y({range:a},(u,l,d)=>{let[h,f,p]=u,g=Tr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(c)}),m.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=jp(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new xe(J);return Pa(e).Y({range:o},(c,u,l)=>{let[d,h,f]=c,p=Tr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Vi(e).get(s).next(o=>{if(o===null)throw O();L(o.userId===this.userId),r.push(Gs(this.serializer,o))}))}),m.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return qk(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),m.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return m.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Pa(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=Tr(s[1]);i.push(c)}else a.done()}).next(()=>{L(i.length===0)})})}containsKey(e,n){return Gk(e,this.userId,n)}xn(e){return Wk(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function Gk(t,e,n){let r=jp(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Pa(t).Y({range:s,J:!0},(a,c,u)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),u.done()}).next(()=>o)}function Vi(t){return It(t,"mutations")}function Pa(t){return It(t,"documentMutations")}function Wk(t){return It(t,"mutationQueues")}var Wa=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var LI=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new Wa(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>B.fromTimestamp(new $e(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Aa(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(L(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Aa(e).Y((o,a)=>{let c=yl(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>m.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Aa(e).Y((r,i)=>{let s=yl(i);n(s)})}Bn(e){return SP(e).get("targetGlobalKey").next(n=>(L(n!==null),n))}kn(e,n){return SP(e).put("targetGlobalKey",n)}qn(e,n){return Aa(e).put(Bk(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Js(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Aa(e).Y({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=yl(a);Wl(n,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Li(e);return n.forEach(o=>{let a=Wt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),m.waitFor(i)}removeMatchingKeys(e,n,r){let i=Li(e);return m.forEach(n,s=>{let o=Wt(s.path);return m.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Li(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Li(e),s=te();return i.Y({range:r,J:!0},(o,a,c)=>{let u=Tr(o[1]),l=new M(u);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=Wt(n.path),i=IDBKeyRange.bound([r],[WP(r)],!1,!0),s=0;return Li(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}_t(e,n){return Aa(e).get(n).next(r=>r?yl(r):null)}};function Aa(t){return It(t,"targets")}function SP(t){return It(t,"targetGlobal")}function Li(t){return It(t,"targetDocuments")}function AP([t,e],[n,r]){let i=J(t,n);return i===0?J(e,r):i}var jI=class{constructor(e){this.Kn=e,this.buffer=new xe(AP),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();AP(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},UI=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){I("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>_(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ji(n)?I("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Xi(n)}yield this.zn(3e5)}))}},BI=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return m.resolve(_n._e);let r=new jI(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(I("LruGarbageCollector","Garbage collection skipped; disabled"),m.resolve(bP)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(I("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bP):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,u,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(I("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),xa()<=Tn.DEBUG&&I("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),m.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function $W(t,e){return new BI(t,e)}var $I=class{constructor(e,n){this.db=e,this.garbageCollector=$W(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return Fp(e,r)}removeReference(e,n,r){return Fp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Fp(e,n)}er(e,n){return function(i,s){let o=!1;return Wk(i).Z(a=>Gk(i,a,s).next(c=>(c&&(o=!0),m.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,B.min()),Li(e).delete(function(d){return[0,Wt(d.path)]}(o))))});i.push(c)}}).next(()=>m.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Fp(e,n)}Xn(e,n){let r=Li(e),i,s=_n._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==_n._e&&n(new M(Tr(i)),s),s=u,i=c):s=_n._e}).next(()=>{s!==_n._e&&n(new M(Tr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Fp(t,e){return Li(t).put(function(r,i){return{targetId:0,path:Wt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var fg=class{constructor(){this.changes=new Nr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ct.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?m.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var HI=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return $s(e).put(r)}removeEntry(e,n,r){return $s(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],ag(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=ct.newInvalidDocument(n);return $s(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(pl(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:ct.newInvalidDocument(n)};return $s(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(pl(n))},(i,s)=>{r={document:this.nr(n,s),size:dg(s)}}).next(()=>r)}getEntries(e,n){let r=cn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=cn(),i=new Fe(M.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,dg(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return m.resolve();let i=new xe(RP);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(pl(i.first()),pl(i.last())),o=i.getIterator(),a=o.getNext();return $s(e).Y({index:"documentKeyIndex",range:s},(c,u,l)=>{let d=M.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&RP(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?l.U(pl(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),ag(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return $s(e).W(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let l=cn();for(let d of u){let h=this.nr(M.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Kl(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=cn(),o=MP(n,r),a=MP(n,Un.max());return $s(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,l)=>{let d=this.nr(M.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new qI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return xP(e).get("remoteDocumentGlobalKey").next(n=>(L(!!n),n))}tr(e,n){return xP(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=jW(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(B.min())))return r}return ct.newInvalidDocument(e)}};function zk(t){return new HI(t)}var qI=class extends fg{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Nr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new xe((s,o)=>J(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=mP(this.ar.serializer,o);i=i.add(s.path.popLast());let u=dg(c);r+=u-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=mP(this.ar.serializer,o.convertToNoDocument(B.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),m.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function xP(t){return It(t,"remoteDocumentGlobal")}function $s(t){return It(t,"remoteDocumentsV14")}function pl(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function MP(t,e){let n=e.documentKey.path.toArray();return[t,ag(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function RP(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=J(n[s],r[s]),i)return i;return i=J(n.length,r.length),i||(i=J(n[n.length-2],r[r.length-2]),i||J(n[n.length-1],r[r.length-1]))}var GI=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var pg=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&wl(r.mutation,i,vn.empty(),$e.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=te()){let i=br();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ml();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=br();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,te()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=cn(),o=vl(),a=function(){return vl()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof nr)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),wl(l.mutation,u,l.mutation.getFieldMask(),$e.now())):o.set(u.key,vn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var d;return a.set(u,new GI(l,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=vl(),i=new Fe((o,a)=>o-a),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||vn.empty();l=a.applyToLocalView(u,l),r.set(c,l);let d=(i.get(a.batchId)||te()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,d=mk();l.forEach(h=>{if(!s.has(h)){let f=Dk(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return m.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return M.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):ZC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):m.resolve(br()),a=-1,c=s;return o.next(u=>m.forEach(u,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?m.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{c=c.insert(l,h)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,te())).next(l=>({batchId:a,changes:gk(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new M(n)).next(r=>{let i=ml();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=ml();return this.indexManager.getCollectionParents(e,s).next(a=>m.forEach(a,c=>{let u=function(d,h){return new tr(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,ct.newInvalidDocument(l)))});let a=ml();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&wl(l.mutation,u,vn.empty(),$e.now()),Kl(n,u)&&(a=a.insert(c,u))}),a})}};var WI=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return m.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:tt(i.createTime)}}(n)),m.resolve()}getNamedQuery(e,n){return m.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:e0(i.bundledQuery),readTime:tt(i.readTime)}}(n)),m.resolve()}};var zI=class{constructor(){this.overlays=new Fe(M.comparator),this.hr=new Map}getOverlay(e,n){return m.resolve(this.overlays.get(n))}getOverlays(e,n){let r=br();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),m.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),m.resolve()}getOverlaysForCollection(e,n,r){let i=br(),s=n.length+1,o=new M(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return m.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Fe((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=br(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=br(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return m.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Rl(n,r));let s=this.hr.get(n);s===void 0&&(s=te(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var Vl=class{constructor(){this.Pr=new xe(st.Ir),this.Tr=new xe(st.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new st(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new st(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new M(new me([])),r=new st(n,e),i=new st(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new M(new me([])),r=new st(n,e),i=new st(n,e+1),s=te();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new st(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},st=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return M.comparator(e.key,n.key)||J(e.pr,n.pr)}static Er(e,n){return J(e.pr,n.pr)||M.comparator(e.key,n.key)}};var KI=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new xe(st.Ir)}checkEmpty(e){return m.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Ml(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new st(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return m.resolve(o)}lookupMutationBatch(e,n){return m.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return m.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return m.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return m.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new st(n,0),i=new st(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),m.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xe(J);return n.forEach(i=>{let s=new st(i,0),o=new st(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),m.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;M.isDocumentKey(s)||(s=s.child(""));let o=new st(new M(s),0),a=new xe(J);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),m.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){L(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return m.forEach(n.mutations,i=>{let s=new st(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new st(n,0),i=this.wr.firstAfterOrEqual(r);return m.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,m.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var QI=class{constructor(e){this.vr=e,this.docs=function(){return new Fe(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return m.resolve(r?r.document.mutableCopy():ct.newInvalidDocument(n))}getEntries(e,n){let r=cn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ct.newInvalidDocument(i))}),m.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=cn(),o=n.path,a=new M(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||zC(KP(l),r)<=0||(i.has(l.key)||Kl(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return m.resolve(s)}getAllFromCollectionGroup(e,n,r,i){O()}Fr(e,n){return m.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new YI(this)}getSize(e){return m.resolve(this.size)}},YI=class extends fg{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),m.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var ZI=class{constructor(e){this.persistence=e,this.Mr=new Nr(n=>Js(n),Wl),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Vl,this.targetCount=0,this.Lr=Wa.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),m.resolve()}getLastRemoteSnapshotVersion(e){return m.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return m.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),m.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),m.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new Wa(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,m.resolve()}updateTargetData(e,n){return this.qn(n),m.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,m.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),m.waitFor(s).next(()=>i)}getTargetCount(e){return m.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return m.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),m.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),m.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),m.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return m.resolve(r)}containsKey(e,n){return m.resolve(this.Nr.containsKey(n))}};var gg=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new _n(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new ZI(this),this.indexManager=new FI,this.remoteDocumentCache=function(i){return new QI(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new og(n),this.$r=new WI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new zI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new KI(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){I("MemoryPersistence","Starting transaction:",e);let i=new XI(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return m.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},XI=class extends Kp{constructor(e){super(),this.currentSequenceNumber=e}},mg=class t{constructor(e){this.persistence=e,this.zr=new Vl,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw O()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),m.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),m.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),m.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m.forEach(this.Jr,r=>{let i=M.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,B.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return m.or([()=>m.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var JI=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Qp("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",KN,{unique:!0}),c.createObjectStore("documentMutations")}(e),NP(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=m.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),NP(e)),o=o.next(()=>function(c){let u=c.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:B.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").W().next(l=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",KN,{unique:!0});let d=u.store("mutations"),h=l.map(f=>d.put(f));return m.waitFor(h)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore("documentOverlays",{keyPath:oW});u.createIndex("collectionPathOverlayIndex",aW,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",cW,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore("remoteDocumentsV14",{keyPath:QG});u.createIndex("documentKeyIndex",YG),u.createIndex("collectionGroupIndex",ZG)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:nW}).createIndex("sequenceNumberIndex",rW,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:iW}).createIndex("documentKeyIndex",sW,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=dg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>m.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>m.forEach(a,c=>{L(c.userId===s.userId);let u=Gs(this.serializer,c);return qk(e,s.userId,u).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let c=new me(o),u=function(d){return[0,Wt(d)]}(c);s.push(n.get(u).next(l=>l?m.resolve():(d=>n.put({targetId:0,path:Wt(d),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>m.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:tW});let r=n.store("collectionParents"),i=new Fl,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Wt(c)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let c=new me(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,c],u)=>{let l=Tr(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=yl(i),o=Bk(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(d){return d.document?new M(me.fromString(d.document.name).popFirst(5)):d.noDocument?M.fromSegments(d.noDocument.path):d.unknownDocument?M.fromSegments(d.unknownDocument.path):O()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>m.waitFor(i))}si(e,n){let r=n.store("mutations"),i=zk(this.serializer),s=new gg(mg.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(c=>{var u;let l=(u=a.get(c.userId))!==null&&u!==void 0?u:te();Gs(this.serializer,c).keys().forEach(d=>l=l.add(d)),a.set(c.userId,l)}),m.forEach(a,(c,u)=>{let l=new ot(u),d=cg.lt(this.serializer,l),h=s.getIndexManager(l),f=hg.lt(l,this.serializer,h,s.referenceDelegate);return new pg(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Tl(n,_n._e),c).next()})})}};function NP(t){t.createObjectStore("targetDocuments",{keyPath:JG}).createIndex("documentTargetsIndex",eW,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",XG,{unique:!0}),t.createObjectStore("targetGlobal")}var qE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",eC=class t{constructor(e,n,r,i,s,o,a,c,u,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new w(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $I(this,i),this.Ti=n+"main",this.serializer=new og(c),this.Ei=new ri(this.Ti,this.ui,new JI(this.serializer)),this.Qr=new LI(this.referenceDelegate,this.serializer),this.remoteDocumentCache=zk(this.serializer),this.$r=new xI,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&Je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,qE);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new _n(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>_(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B(n=>_(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>_(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Vp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Ji(e))return I("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return I("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return gl(e).get("owner").next(n=>m.resolve(this.Si(n)))}bi(e){return Vp(e).delete(this.clientId)}Di(){return _(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=It(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return m.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?m.resolve(!0):gl(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,qE);return!1}}return!(!this.networkEnabled||!this.inForeground)||Vp(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&I("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return _(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Tl(e,_n._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Li()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Vp(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return hg.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new VI(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return cg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){I("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?lW:c===14?ek:c===13?JP:c===12?uW:c===11?XP:void O()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Tl(a,this.kr?this.kr.next():_n._e),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new w(y.FAILED_PRECONDITION,QP);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return gl(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new w(y.FAILED_PRECONDITION,qE)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return gl(e).put("owner",n)}static D(){return ri.D()}yi(e){let n=gl(e);return n.get("owner").next(r=>this.Si(r)?(I("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):m.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Je(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;_y()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return I("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Je("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function gl(t){return It(t,"owner")}function Vp(t){return It(t,"clientMetadata")}function n0(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var tC=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=te(),i=te();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var nC=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var yg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return _y()?8:ri.v(Nc())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new nC;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(xa()<=Tn.DEBUG&&I("QueryEngine","SDK will not create cache indexes for query:",Ma(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),m.resolve()):(xa()<=Tn.DEBUG&&I("QueryEngine","Query:",Ma(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(xa()<=Tn.DEBUG&&I("QueryEngine","The SDK decides to create cache indexes for query:",Ma(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zt(n))):m.resolve())}ji(e,n){if(sP(n))return m.resolve(null);let r=zt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=ng(n,null,"F"),r=zt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Zi(n,a);return this.Xi(n,u,o,c.readTime)?this.ji(e,ng(n,null,"F")):this.es(e,u,n,c)}))})))}Hi(e,n,r,i){return sP(n)||i.isEqual(B.min())?m.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?m.resolve(null):(xa()<=Tn.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ma(n)),this.es(e,o,n,zP(i,-1)).next(a=>a))})}Zi(e,n){let r=new xe(fk(e));return n.forEach((i,s)=>{Kl(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return xa()<=Tn.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",Ma(n)),this.zi.getDocumentsMatchingQuery(e,n,Un.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var rC=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Fe(J),this.rs=new Nr(s=>Js(s),Wl),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pg(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function Kk(t,e,n,r){return new rC(t,e,n,r)}function Qk(t,e){return _(this,null,function*(){let n=R(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=te();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function HW(t,e){let n=R(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){let d=u.batch,h=d.keys(),f=m.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(c,p)).next(g=>{let v=u.docVersions.get(p);L(v!==null),g.version.compareTo(v)<0&&(d.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=te();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function Yk(t){let e=R(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function qW(t,e){let n=R(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Et.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,v,T){return g.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let c=cn(),u=te();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(Zk(s,o,e.documentUpdates).next(l=>{c=l.cs,u=l.ls})),!r.isEqual(B.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return m.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ns=i,s))}function Zk(t,e,n){let r=te(),i=te();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=cn();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(B.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):I("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function GW(t,e){let n=R(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function za(t,e){let n=R(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,m.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Ga(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function Ka(t,e,n){return _(this,null,function*(){let r=R(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ji(o))throw o;I("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function _g(t,e,n){let r=R(t),i=B.min(),s=te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){let d=R(c),h=d.rs.get(l);return h!==void 0?m.resolve(d.ns.get(h)):d.Qr.getTargetData(u,l)}(r,o,zt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:B.min(),n?s:te())).next(a=>(e1(r,hk(e),a),{documents:a,hs:s})))}function Xk(t,e){let n=R(t),r=R(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function Jk(t,e){let n=R(t),r=n.ss.get(e)||B.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,zP(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(e1(n,e,i),i))}function e1(t,e,n){let r=t.ss.get(e)||B.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function WW(t,e,n,r){return _(this,null,function*(){let i=R(t),s=te(),o=cn();for(let u of n){let l=e.Ps(u.metadata.name);u.document&&(s=s.add(l));let d=e.Is(u);d.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield za(i,function(l){return zt(nc(me.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>Zk(u,a,o).next(l=>(a.apply(u),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Qr.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,l.cs,l.ls)).next(()=>l.cs)))})}function zW(r,i){return _(this,arguments,function*(t,e,n=te()){let s=yield za(t,zt(e0(e.bundledQuery))),o=R(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=tt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let u=s.withResumeToken(Et.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(u.targetId,u),o.Qr.updateTargetData(a,u).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function PP(t,e){return`firestore_clients_${t}_${e}`}function kP(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function GE(t,e){return`firestore_targets_${t}_${e}`}var vg=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new w(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Je("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},El=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new w(r.error.code,r.error.message))),s?new t(e,r.state,i):(Je("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},wg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=XC();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=YP(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Je("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},iC=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Je("SharedClientState",`Failed to parse online state: ${e}`),null)}},Ll=class{constructor(){this.activeTargetIds=XC()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Il=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Fe(J),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=PP(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Ll),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return _(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(PP(this.persistenceKey,r));if(i){let s=wg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,n,r){this.Ls(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(GE(this.persistenceKey,e));if(r){let i=El.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(GE(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return I("SharedClientState","READ",e,n),n}setItem(e,n){I("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){I("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(I("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>_(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=_n._e;if(s!=null)try{let a=JSON.parse(s);L(typeof a=="number"),o=a}catch(a){Je("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==_n._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,n,r){let i=new vg(this.currentUser,e,n,r),s=kP(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let n=kP(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=GE(this.persistenceKey,e),s=new El(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return wg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return vg.Es(new ot(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return El.Es(i,n)}xs(e){return iC.Es(e)}Js(e){return JSON.parse(e)}zs(e){return _(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);I("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=XC();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},Eg=class{constructor(){this.no=new Ll,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Ll,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var sC=class{io(e){}shutdown(){}};var Ig=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){I("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){I("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Lp=null;function WE(){return Lp===null?Lp=function(){return 268435456+Math.round(2147483648*Math.random())}():Lp++,"0x"+Lp.toString(16)}var KW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var oC=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Ot="WebChannelConnection",aC=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=WE(),c=this.bo(n,r.toUriEncodedString());I("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(u,s,o),this.Co(n,c,u,i).then(l=>(I("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw jn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+tc}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=KW[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=WE();return new Promise((o,a)=>{let c=new HN;c.setWithCredentials(!0),c.listenOnce(BN.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case kp.NO_ERROR:let l=c.getResponseJson();I(Ot,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case kp.TIMEOUT:I(Ot,`RPC '${e}' ${s} timed out`),a(new w(y.DEADLINE_EXCEEDED,"Request time out"));break;case kp.HTTP_ERROR:let d=c.getStatus();if(I(Ot,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(v){let T=v.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(T)>=0?T:y.UNKNOWN}(f.status);a(new w(p,f.message))}else a(new w(y.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new w(y.UNAVAILABLE,"Connection failed."));break;default:O()}}finally{I(Ot,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);I(Ot,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Fo(e,n,r){let i=WE(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=jN(),a=UN(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");I(Ot,`Creating RPC '${e}' stream ${i}: ${l}`,c);let d=o.createWebChannel(l,c),h=!1,f=!1,p=new oC({lo:v=>{f?I(Ot,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(h||(I(Ot,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),I(Ot,`RPC '${e}' stream ${i} sending:`,v),d.send(v))},ho:()=>d.close()}),g=(v,T,F)=>{v.listen(T,S=>{try{F(S)}catch(H){setTimeout(()=>{throw H},0)}})};return g(d,dl.EventType.OPEN,()=>{f||I(Ot,`RPC '${e}' stream ${i} transport opened.`)}),g(d,dl.EventType.CLOSE,()=>{f||(f=!0,I(Ot,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,dl.EventType.ERROR,v=>{f||(f=!0,jn(Ot,`RPC '${e}' stream ${i} transport errored:`,v),p.Vo(new w(y.UNAVAILABLE,"The operation could not be completed")))}),g(d,dl.EventType.MESSAGE,v=>{var T;if(!f){let F=v.data[0];L(!!F);let S=F,H=S.error||((T=S[0])===null||T===void 0?void 0:T.error);if(H){I(Ot,`RPC '${e}' stream ${i} received error:`,H);let W=H.status,Y=function(py){let Bd=it[py];if(Bd!==void 0)return Sk(Bd)}(W),Te=H.message;Y===void 0&&(Y=y.INTERNAL,Te="Unknown error status: "+W+" with message "+H.message),f=!0,p.Vo(new w(Y,Te)),d.close()}else I(Ot,`RPC '${e}' stream ${i} received:`,F),p.mo(F)}}),g(a,$N.STAT_EVENT,v=>{v.stat===$E.PROXY?I(Ot,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===$E.NOPROXY&&I(Ot,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function t1(){return typeof window<"u"?window:null}function Hp(){return typeof document<"u"?document:null}function Ql(t){return new DI(t,!0)}var jl=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&I("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Lo!==null&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){this.Lo!==null&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}};var Cg=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new jl(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return _(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return _(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return _(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(Je(n.toString()),Je("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new w(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>_(this,null,function*(){this.state=0,this.start()}))}__(e){return I("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(I("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},cC=class extends Cg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=NW(this.serializer,e),r=function(s){if(!("targetChange"in s))return B.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?B.min():o.readTime?tt(o.readTime):B.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=SI(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=eg(c)?{documents:Ok(s,c)}:{query:Fk(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=xk(s,o.resumeToken);let u=TI(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(B.min())>0){a.readTime=qa(s,o.snapshotVersion.toTimestamp());let u=TI(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=kW(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=SI(this.serializer),n.removeTarget=e,this.t_(n)}},uC=class extends Cg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(L(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=PW(e.writeResults,e.commitTime),r=tt(e.commitTime);return this.listener.T_(r,n)}return L(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=SI(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Ol(this.serializer,r))};this.t_(n)}};var lC=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,bI(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new w(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,bI(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new w(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var dC=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Je(n),this.g_=!1):I("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var hC=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>_(this,null,function*(){es(this)&&(I("RemoteStore","Restarting streams for network reachability change."),yield function(c){return _(this,null,function*(){let u=R(c);u.v_.add(4),yield rc(u),u.x_.set("Unknown"),u.v_.delete(4),yield Yl(u)})}(this))}))}),this.x_=new dC(r,i)}};function Yl(t){return _(this,null,function*(){if(es(t))for(let e of t.F_)yield e(!0)})}function rc(t){return _(this,null,function*(){for(let e of t.F_)yield e(!1)})}function $g(t,e){let n=R(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),s0(n)?i0(n):sc(n).Jo()&&r0(n,e))}function Qa(t,e){let n=R(t),r=sc(n);n.C_.delete(e),r.Jo()&&n1(n,e),n.C_.size===0&&(r.Jo()?r.Xo():es(n)&&n.x_.set("Unknown"))}function r0(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}sc(t).c_(e)}function n1(t,e){t.O_.Oe(e),sc(t).l_(e)}function i0(t){t.O_=new CI({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),sc(t).start(),t.x_.p_()}function s0(t){return es(t)&&!sc(t).Ho()&&t.C_.size>0}function es(t){return R(t).v_.size===0}function r1(t){t.O_=void 0}function QW(t){return _(this,null,function*(){t.C_.forEach((e,n)=>{r0(t,e)})})}function YW(t,e){return _(this,null,function*(){r1(t),s0(t)?(t.x_.S_(e),i0(t)):t.x_.set("Unknown")})}function ZW(t,e,n){return _(this,null,function*(){if(t.x_.set("Online"),e instanceof ig&&e.state===2&&e.cause)try{yield function(i,s){return _(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){I("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Dg(t,r)}else if(e instanceof Va?t.O_.$e(e):e instanceof rg?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(B.min()))try{let r=yield Yk(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let l=s.C_.get(u);l&&s.C_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let l=s.C_.get(c);if(!l)return;s.C_.set(c,l.withResumeToken(Et.EMPTY_BYTE_STRING,l.snapshotVersion)),n1(s,c);let d=new Ga(l.target,c,u,l.sequenceNumber);r0(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){I("RemoteStore","Failed to raise snapshot:",r),yield Dg(t,r)}})}function Dg(t,e,n){return _(this,null,function*(){if(!Ji(e))throw e;t.v_.add(1),yield rc(t),t.x_.set("Offline"),n||(n=()=>Yk(t.localStore)),t.asyncQueue.enqueueRetryable(()=>_(this,null,function*(){I("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Yl(t)}))})}function i1(t,e){return e().catch(n=>Dg(t,n,e))}function ic(t){return _(this,null,function*(){let e=R(t),n=Zi(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;XW(e);)try{let i=yield GW(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,JW(e,i)}catch(i){yield Dg(e,i)}s1(e)&&o1(e)})}function XW(t){return es(t)&&t.D_.length<10}function JW(t,e){t.D_.push(e);let n=Zi(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function s1(t){return es(t)&&!Zi(t).Ho()&&t.D_.length>0}function o1(t){Zi(t).start()}function ez(t){return _(this,null,function*(){Zi(t).d_()})}function tz(t){return _(this,null,function*(){let e=Zi(t);for(let n of t.D_)e.I_(n.mutations)})}function nz(t,e,n){return _(this,null,function*(){let r=t.D_.shift(),i=wI.from(r,e,n);yield i1(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield ic(t)})}function rz(t,e){return _(this,null,function*(){e&&Zi(t).P_&&(yield function(r,i){return _(this,null,function*(){if(function(o){return bk(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();Zi(r).Zo(),yield i1(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield ic(r)}})}(t,e)),s1(t)&&o1(t)})}function OP(t,e){return _(this,null,function*(){let n=R(t);n.asyncQueue.verifyOperationInProgress(),I("RemoteStore","RemoteStore received new credentials");let r=es(n);n.v_.add(3),yield rc(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Yl(n)})}function fC(t,e){return _(this,null,function*(){let n=R(t);e?(n.v_.delete(2),yield Yl(n)):e||(n.v_.add(2),yield rc(n),n.x_.set("Unknown"))})}function sc(t){return t.N_||(t.N_=function(n,r,i){let s=R(n);return s.R_(),new cC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:QW.bind(null,t),To:YW.bind(null,t),u_:ZW.bind(null,t)}),t.F_.push(e=>_(this,null,function*(){e?(t.N_.Zo(),s0(t)?i0(t):t.x_.set("Unknown")):(yield t.N_.stop(),r1(t))}))),t.N_}function Zi(t){return t.L_||(t.L_=function(n,r,i){let s=R(n);return s.R_(),new uC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:ez.bind(null,t),To:rz.bind(null,t),E_:tz.bind(null,t),T_:nz.bind(null,t)}),t.F_.push(e=>_(this,null,function*(){e?(t.L_.Zo(),yield ic(t)):(yield t.L_.stop(),t.D_.length>0&&(I("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_}var pC=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new at,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function oc(t,e){if(Je("AsyncQueue",`${e}: ${t}`),Ji(t))return new w(y.UNAVAILABLE,`${e}: ${t}`);throw t}var Tg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||M.comparator(n.key,r.key):(n,r)=>M.comparator(n.key,r.key),this.keyedMap=ml(),this.sortedSet=new Fe(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var bg=class{constructor(){this.B_=new Fe(M.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):O():this.B_=this.B_.insert(n,e)}k_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},Ya=class t{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,Tg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var gC=class{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some(e=>e.U_())}},mC=class{constructor(){this.queries=new Nr(e=>dk(e),zl),this.onlineState="Unknown",this.W_=new Set}};function o0(t,e){return _(this,null,function*(){let n=R(t),r=3,i=e.query,s=n.queries.get(i);s?!s.K_()&&e.U_()&&(r=2):(s=new gC,r=e.U_()?0:1);try{switch(r){case 0:s.q_=yield n.onListen(i,!0);break;case 1:s.q_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=oc(o,`Initialization of query '${Ma(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Q_.push(e),e.G_(n.onlineState),s.q_&&e.z_(s.q_)&&c0(n)})}function a0(t,e){return _(this,null,function*(){let n=R(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),s.Q_.length===0?i=e.U_()?0:1:!s.K_()&&e.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function iz(t,e){let n=R(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.z_(i)&&(r=!0);o.q_=i}}r&&c0(n)}function sz(t,e,n){let r=R(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function c0(t){t.W_.forEach(e=>{e.next()})}var yC,FP;(FP=yC||(yC={})).j_="default",FP.Cache="cache";var Ul=class{constructor(e,n,r){this.query=e,this.H_=n,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=r||{}}z_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ya(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),n=!0):this.X_(e,this.onlineState)&&(this.ea(e),n=!0),this.Y_=e,n}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let n=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),n=!0),n}X_(e,n){if(!e.fromCache||!this.U_())return!0;let r=n!=="Offline";return(!this.options.ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Z_(e){if(e.docChanges.length>0)return!0;let n=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ea(e){e=Ya.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==yC.Cache}};var _C=class{constructor(e,n){this.na=e,this.byteLength=n}ra(){return"metadata"in this.na}};var Sg=class{constructor(e){this.serializer=e}Ps(e){return Ar(this.serializer,e)}Is(e){return e.metadata.exists?kk(this.serializer,e.document,!1):ct.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return tt(e)}},vC=class{constructor(e,n,r){this.ia=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=a1(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++n;let r=me.fromString(e.na.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}oa(e){let n=new Map,r=new Sg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||te()).add(s);n.set(o,a)}}return n}complete(){return _(this,null,function*(){let e=yield WW(this.localStore,new Sg(this.serializer),this.documents,this.ia.id),n=this.oa(this.documents);for(let r of this.queries)yield zW(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}})}};function a1(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Ag=class{constructor(e){this.key=e}},xg=class{constructor(e){this.key=e}},Mg=class{constructor(e,n){this.query=e,this.ua=n,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=te(),this.mutatedKeys=te(),this.ha=fk(e),this.Pa=new Tg(this.ha)}get Ia(){return this.ua}Ta(e,n){let r=n?n.Ea:new bg,i=n?n.Pa:this.Pa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Kl(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),v=!0):this.da(h,f)||(r.track({type:2,doc:f}),v=!0,(c&&this.ha(f,c)>0||u&&this.ha(f,u)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),v=!0):h&&!f&&(r.track({type:1,doc:h}),v=!0,(c||u)&&(a=!0)),v&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{Pa:o,Ea:r,Xi:a,mutatedKeys:s}}da(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;let o=e.Ea.k_();o.sort((l,d)=>function(f,p){let g=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O()}};return g(f)-g(p)}(l.type,d.type)||this.ha(l.doc,d.doc)),this.Aa(r),i=i!=null&&i;let a=n&&!i?this.Ra():[],c=this.la.size===0&&this.current&&!i?1:0,u=c!==this.ca;return this.ca=c,o.length!==0||u?{snapshot:new Ya(this.query,e.Pa,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Va:a}:{Va:a}}G_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new bg,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach(n=>this.ua=this.ua.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ua=this.ua.delete(n)),this.current=e.current)}Ra(){if(!this.current)return[];let e=this.la;this.la=te(),this.Pa.forEach(r=>{this.ma(r.key)&&(this.la=this.la.add(r.key))});let n=[];return e.forEach(r=>{this.la.has(r)||n.push(new xg(r))}),this.la.forEach(r=>{e.has(r)||n.push(new Ag(r))}),n}fa(e){this.ua=e.hs,this.la=te();let n=this.Ta(e.documents);return this.applyChanges(n,!0)}ga(){return Ya.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,this.ca===0,this.hasCachedResults)}},wC=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},EC=class{constructor(e){this.key=e,this.pa=!1}},IC=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Nr(a=>dk(a),zl),this.Sa=new Map,this.ba=new Set,this.Da=new Fe(M.comparator),this.Ca=new Map,this.va=new Vl,this.Fa={},this.Ma=new Map,this.xa=Wa.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return this.Oa===!0}};function oz(t,e,n=!0){return _(this,null,function*(){let r=Hg(t),i,s=r.wa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ga()):i=yield c1(r,e,n,!0),i})}function az(t,e){return _(this,null,function*(){let n=Hg(t);yield c1(n,e,!0,!1)})}function c1(t,e,n,r){return _(this,null,function*(){let i=yield za(t.localStore,zt(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield u0(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&$g(t.remoteStore,i),a})}function u0(t,e,n,r,i){return _(this,null,function*(){t.Na=(d,h,f)=>function(g,v,T,F){return _(this,null,function*(){let S=v.view.Ta(T);S.Xi&&(S=yield _g(g.localStore,v.query,!1).then(({documents:Te})=>v.view.Ta(Te,S)));let H=F&&F.targetChanges.get(v.targetId),W=F&&F.targetMismatches.get(v.targetId)!=null,Y=v.view.applyChanges(S,g.isPrimaryClient,H,W);return CC(g,v.targetId,Y.Va),Y.snapshot})}(t,d,h,f);let s=yield _g(t.localStore,e,!0),o=new Mg(e,s.hs),a=o.Ta(s.documents),c=Pl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);CC(t,n,u.Va);let l=new wC(e,n,o);return t.wa.set(e,l),t.Sa.has(n)?t.Sa.get(n).push(e):t.Sa.set(n,[e]),u.snapshot})}function cz(t,e,n){return _(this,null,function*(){let r=R(t),i=r.wa.get(e),s=r.Sa.get(i.targetId);if(s.length>1)return r.Sa.set(i.targetId,s.filter(o=>!zl(o,e))),void r.wa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Ka(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Qa(r.remoteStore,i.targetId),Za(r,i.targetId)}).catch(Xi))):(Za(r,i.targetId),yield Ka(r.localStore,i.targetId,!0))})}function uz(t,e){return _(this,null,function*(){let n=R(t),r=n.wa.get(e),i=n.Sa.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Qa(n.remoteStore,r.targetId))})}function lz(t,e,n){return _(this,null,function*(){let r=f0(t);try{let i=yield function(o,a){let c=R(o),u=$e.now(),l=a.reduce((f,p)=>f.add(p.key),te()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=cn(),g=te();return c.os.getEntries(f,l).next(v=>{p=v,p.forEach((T,F)=>{F.isValidDocument()||(g=g.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(v=>{d=v;let T=[];for(let F of a){let S=TW(F,d.get(F.key).overlayedDocument);S!=null&&T.push(new nr(F.key,S,ik(S.value.mapValue),Qe.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,T,a)}).next(v=>{h=v;let T=v.applyToLocalDocumentSet(d,g);return c.documentOverlayCache.saveOverlays(f,v.batchId,T)})}).then(()=>({batchId:h.batchId,changes:gk(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Fa[o.currentUser.toKey()];u||(u=new Fe(J)),u=u.insert(a,c),o.Fa[o.currentUser.toKey()]=u}(r,i.batchId,n),yield ci(r,i.changes),yield ic(r.remoteStore)}catch(i){let s=oc(i,"Failed to persist write");n.reject(s)}})}function u1(t,e){return _(this,null,function*(){let n=R(t);try{let r=yield qW(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Ca.get(s);o&&(L(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.pa=!0:i.modifiedDocuments.size>0?L(o.pa):i.removedDocuments.size>0&&(L(o.pa),o.pa=!1))}),yield ci(n,r,e)}catch(r){yield Xi(r)}})}function VP(t,e,n){let r=R(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.wa.forEach((s,o)=>{let a=o.view.G_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=R(o);c.onlineState=a;let u=!1;c.queries.forEach((l,d)=>{for(let h of d.Q_)h.G_(a)&&(u=!0)}),u&&c0(c)}(r.eventManager,e),i.length&&r.ya.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function dz(t,e,n){return _(this,null,function*(){let r=R(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Ca.get(e),s=i&&i.key;if(s){let o=new Fe(M.comparator);o=o.insert(s,ct.newNoDocument(s,B.min()));let a=te().add(s),c=new Nl(B.min(),new Map,new Fe(J),o,a);yield u1(r,c),r.Da=r.Da.remove(s),r.Ca.delete(e),h0(r)}else yield Ka(r.localStore,e,!1).then(()=>Za(r,e,n)).catch(Xi)})}function hz(t,e){return _(this,null,function*(){let n=R(t),r=e.batch.batchId;try{let i=yield HW(n.localStore,e);d0(n,r,null),l0(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield ci(n,i)}catch(i){yield Xi(i)}})}function fz(t,e,n){return _(this,null,function*(){let r=R(t);try{let i=yield function(o,a){let c=R(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(d=>(L(d!==null),l=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,e);d0(r,e,n),l0(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield ci(r,i)}catch(i){yield Xi(i)}})}function pz(t,e){return _(this,null,function*(){let n=R(t);es(n.remoteStore)||I("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=R(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ma.get(r)||[];i.push(e),n.Ma.set(r,i)}catch(r){let i=oc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function l0(t,e){(t.Ma.get(e)||[]).forEach(n=>{n.resolve()}),t.Ma.delete(e)}function d0(t,e,n){let r=R(t),i=r.Fa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Fa[r.currentUser.toKey()]=i}}function Za(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Sa.get(e))t.wa.delete(r),n&&t.ya.La(r,n);t.Sa.delete(e),t.isPrimaryClient&&t.va.Vr(e).forEach(r=>{t.va.containsKey(r)||l1(t,r)})}function l1(t,e){t.ba.delete(e.path.canonicalString());let n=t.Da.get(e);n!==null&&(Qa(t.remoteStore,n),t.Da=t.Da.remove(e),t.Ca.delete(n),h0(t))}function CC(t,e,n){for(let r of n)r instanceof Ag?(t.va.addReference(r.key,e),gz(t,r)):r instanceof xg?(I("SyncEngine","Document no longer in limbo: "+r.key),t.va.removeReference(r.key,e),t.va.containsKey(r.key)||l1(t,r.key)):O()}function gz(t,e){let n=e.key,r=n.path.canonicalString();t.Da.get(n)||t.ba.has(r)||(I("SyncEngine","New document in limbo: "+n),t.ba.add(r),h0(t))}function h0(t){for(;t.ba.size>0&&t.Da.size<t.maxConcurrentLimboResolutions;){let e=t.ba.values().next().value;t.ba.delete(e);let n=new M(me.fromString(e)),r=t.xa.next();t.Ca.set(r,new EC(n)),t.Da=t.Da.insert(n,r),$g(t.remoteStore,new Ga(zt(nc(n.path)),r,"TargetPurposeLimboResolution",_n._e))}}function ci(t,e,n){return _(this,null,function*(){let r=R(t),i=[],s=[],o=[];r.wa.isEmpty()||(r.wa.forEach((a,c)=>{o.push(r.Na(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=tC.Ki(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.ya.u_(i),yield function(c,u){return _(this,null,function*(){let l=R(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>m.forEach(u,h=>m.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>m.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Ji(d))throw d;I("LocalStore","Failed to update sequence numbers: "+d)}for(let d of u){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,g)}}})}(r.localStore,s))})}function mz(t,e){return _(this,null,function*(){let n=R(t);if(!n.currentUser.isEqual(e)){I("SyncEngine","User change. New user:",e.toKey());let r=yield Qk(n.localStore,e);n.currentUser=e,function(s,o){s.Ma.forEach(a=>{a.forEach(c=>{c.reject(new w(y.CANCELLED,o))})}),s.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ci(n,r.us)}})}function yz(t,e){let n=R(t),r=n.Ca.get(e);if(r&&r.pa)return te().add(r.key);{let i=te(),s=n.Sa.get(e);if(!s)return i;for(let o of s){let a=n.wa.get(o);i=i.unionWith(a.view.Ia)}return i}}function _z(t,e){return _(this,null,function*(){let n=R(t),r=yield _g(n.localStore,e.query,!0),i=e.view.fa(r);return n.isPrimaryClient&&CC(n,e.targetId,i.Va),i})}function vz(t,e){return _(this,null,function*(){let n=R(t);return Jk(n.localStore,e).then(r=>ci(n,r))})}function wz(t,e,n,r){return _(this,null,function*(){let i=R(t),s=yield function(a,c){let u=R(a),l=R(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,c).next(h=>h?u.localDocuments.getDocuments(d,h):m.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield ic(i.remoteStore):n==="acknowledged"||n==="rejected"?(d0(i,e,r||null),l0(i,e),function(a,c){R(R(a).mutationQueue).Mn(c)}(i.localStore,e)):O(),yield ci(i,s)):I("SyncEngine","Cannot apply mutation batch with id: "+e)})}function Ez(t,e){return _(this,null,function*(){let n=R(t);if(Hg(n),f0(n),e===!0&&n.Oa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield LP(n,r.toArray());n.Oa=!0,yield fC(n.remoteStore,!0);for(let s of i)$g(n.remoteStore,s)}else if(e===!1&&n.Oa!==!1){let r=[],i=Promise.resolve();n.Sa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Za(n,o),Ka(n.localStore,o,!0))),Qa(n.remoteStore,o)}),yield i,yield LP(n,r),function(o){let a=R(o);a.Ca.forEach((c,u)=>{Qa(a.remoteStore,u)}),a.va.mr(),a.Ca=new Map,a.Da=new Fe(M.comparator)}(n),n.Oa=!1,yield fC(n.remoteStore,!1)}})}function LP(t,e,n){return _(this,null,function*(){let r=R(t),i=[],s=[];for(let o of e){let a,c=r.Sa.get(o);if(c&&c.length!==0){a=yield za(r.localStore,zt(c[0]));for(let u of c){let l=r.wa.get(u),d=yield _z(r,l);d.snapshot&&s.push(d.snapshot)}}else{let u=yield Xk(r.localStore,o);a=yield za(r.localStore,u),yield u0(r,d1(u),o,!1,a.resumeToken)}i.push(a)}return r.ya.u_(s),i})}function d1(t){return lk(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Iz(t){return function(n){return R(R(n).persistence).Bi()}(R(t).localStore)}function Cz(t,e,n,r){return _(this,null,function*(){let i=R(t);if(i.Oa)return void I("SyncEngine","Ignoring unexpected query state notification.");let s=i.Sa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield Jk(i.localStore,hk(s[0])),a=Nl.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Et.EMPTY_BYTE_STRING);yield ci(i,o,a);break}case"rejected":yield Ka(i.localStore,e,!0),Za(i,e,r);break;default:O()}})}function Dz(t,e,n){return _(this,null,function*(){let r=Hg(t);if(r.Oa){for(let i of e){if(r.Sa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){I("SyncEngine","Adding an already active target "+i);continue}let s=yield Xk(r.localStore,i),o=yield za(r.localStore,s);yield u0(r,d1(s),o.targetId,!1,o.resumeToken),$g(r.remoteStore,o)}for(let i of n)r.Sa.has(i)&&(yield Ka(r.localStore,i,!1).then(()=>{Qa(r.remoteStore,i),Za(r,i)}).catch(Xi))}})}function Hg(t){let e=R(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=u1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dz.bind(null,e),e.ya.u_=iz.bind(null,e.eventManager),e.ya.La=sz.bind(null,e.eventManager),e}function f0(t){let e=R(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fz.bind(null,e),e}function Tz(t,e,n){let r=R(t);(function(s,o,a){return _(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(f,p){let g=R(f),v=tt(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",T=>g.$r.getBundleMetadata(T,p.id)).then(T=>!!T&&T.createTime.compareTo(v)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(a1(c));let u=new vC(c,s.localStore,o.serializer),l=yield o.Ba();for(;l;){let h=yield u.sa(l);h&&a._updateProgress(h),l=yield o.Ba()}let d=yield u.complete();return yield ci(s,d.aa,void 0),yield function(f,p){let g=R(f);return g.persistence.runTransaction("Save bundle","readwrite",v=>g.$r.saveBundleMetadata(v,p))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d._a)}catch(c){return jn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Bl=class{constructor(){this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){this.serializer=Ql(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Kk(this.persistence,new yg,e.initialUser,this.serializer)}createPersistence(e){return new gg(mg.Hr,this.serializer)}createSharedClientState(e){return new Eg}terminate(){return _(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Rg=class t extends Bl{constructor(e,n,r){super(),this.ka=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){yield gy(t.prototype,this,"initialize").call(this,e),yield this.ka.initialize(this,e),yield f0(this.ka.syncEngine),yield ic(this.ka.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return Kk(this.persistence,new yg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new UI(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new iI(n,this.persistence);return new rI(e.asyncQueue,r)}createPersistence(e){let n=n0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new eC(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,t1(),Hp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Eg}},DC=class t extends Rg{constructor(e,n){super(e,n,!1),this.ka=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return _(this,null,function*(){yield gy(t.prototype,this,"initialize").call(this,e);let n=this.ka.syncEngine;this.sharedClientState instanceof Il&&(this.sharedClientState.syncEngine={Zs:wz.bind(null,n),Xs:Cz.bind(null,n),eo:Dz.bind(null,n),Bi:Iz.bind(null,n),Ys:vz.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>_(this,null,function*(){yield Ez(this.ka.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=t1();if(!Il.D(n))throw new w(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=n0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Il(n,e.asyncQueue,r,e.clientId,e.initialUser)}},$l=class{initialize(e,n){return _(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>VP(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=mz.bind(null,this.syncEngine),yield fC(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new mC}()}createDatastore(e){let n=Ql(e.databaseInfo.databaseId),r=function(s){return new aC(s)}(e.databaseInfo);return function(s,o,a,c){return new lC(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new hC(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>VP(this.syncEngine,n,0),function(){return Ig.D()?new Ig:new sC}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,l){let d=new IC(i,s,o,a,c,u);return l&&(d.Oa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return _(this,null,function*(){var e;yield function(r){return _(this,null,function*(){let i=R(r);I("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield rc(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function jP(t,e=10240){let n=0;return{read(){return _(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return _(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Xa=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):Je("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var TC=class{constructor(e,n){this.Ka=e,this.serializer=n,this.metadata=new at,this.buffer=new Uint8Array,this.$a=function(){return new TextDecoder("utf-8")}(),this.Ua().then(r=>{r&&r.ra()?this.metadata.resolve(r.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.na)}`))},r=>this.metadata.reject(r))}close(){return this.Ka.cancel()}getMetadata(){return _(this,null,function*(){return this.metadata.promise})}Ba(){return _(this,null,function*(){return yield this.getMetadata(),this.Ua()})}Ua(){return _(this,null,function*(){let e=yield this.Wa();if(e===null)return null;let n=this.$a.decode(e),r=Number(n);isNaN(r)&&this.Ga(`length string (${n}) is not valid number`);let i=yield this.za(r);return new _C(JSON.parse(i),e.length+r)})}ja(){return this.buffer.findIndex(e=>e===123)}Wa(){return _(this,null,function*(){for(;this.ja()<0&&!(yield this.Ha()););if(this.buffer.length===0)return null;let e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}za(e){return _(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ha())&&this.Ga("Reached the end of bundle when more is expected.");let n=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ha(){return _(this,null,function*(){let e=yield this.Ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var bC=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new w(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return _(this,null,function*(){let o=R(i),a={documents:s.map(d=>kl(o.serializer,d))},c=yield o.vo("BatchGetDocuments",o.serializer.databaseId,me.emptyPath(),a,s.length),u=new Map;c.forEach(d=>{let h=RW(o.serializer,d);u.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=u.get(d.toString());L(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Yi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=M.fromPath(r);this.mutations.push(new xl(i,this.precondition(i)))}),yield function(r,i){return _(this,null,function*(){let s=R(r),o={writes:i.map(a=>Ol(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,me.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw O();n=B.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new w(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(B.min())?Qe.exists(!1):Qe.updateTime(n):Qe.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(B.min()))throw new w(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qe.updateTime(n)}return Qe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var SC=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Ja=r.maxAttempts,this.jo=new jl(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo(()=>_(this,null,function*(){let e=new bC(this.datastore),n=this.Xa(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.eu(i)}))}).catch(r=>{this.eu(r)})}))}Xa(e){try{let n=this.updateFunction(e);return!Gl(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget(()=>(this.Za(),Promise.resolve()))):this.deferred.reject(e)}tu(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!bk(n)}return!1}};var AC=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ot.UNAUTHENTICATED,this.clientId=Wp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>_(this,null,function*(){I("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(I("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new at;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=oc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function qp(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),I("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>_(this,null,function*(){r.isEqual(i)||(yield Qk(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function xC(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield p0(t);I("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>OP(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>OP(e.remoteStore,i)),t._onlineComponents=e})}function h1(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function p0(t){return _(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){I("FirestoreClient","Using user provided OfflineComponentProvider");try{yield qp(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!h1(n))throw n;jn("Error using user provided cache. Falling back to memory cache: "+n),yield qp(t,new Bl)}}else I("FirestoreClient","Using default OfflineComponentProvider"),yield qp(t,new Bl);return t._offlineComponents})}function qg(t){return _(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(I("FirestoreClient","Using user provided OnlineComponentProvider"),yield xC(t,t._uninitializedComponentsProvider._online)):(I("FirestoreClient","Using default OnlineComponentProvider"),yield xC(t,new $l))),t._onlineComponents})}function f1(t){return p0(t).then(e=>e.persistence)}function g0(t){return p0(t).then(e=>e.localStore)}function p1(t){return qg(t).then(e=>e.remoteStore)}function m0(t){return qg(t).then(e=>e.syncEngine)}function bz(t){return qg(t).then(e=>e.datastore)}function Ja(t){return _(this,null,function*(){let e=yield qg(t),n=e.eventManager;return n.onListen=oz.bind(null,e.syncEngine),n.onUnlisten=cz.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=az.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=uz.bind(null,e.syncEngine),n})}function Sz(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield f1(t),n=yield p1(t);return e.setNetworkEnabled(!0),function(i){let s=R(i);return s.v_.delete(0),Yl(s)}(n)}))}function Az(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield f1(t),n=yield p1(t);return e.setNetworkEnabled(!1),function(i){return _(this,null,function*(){let s=R(i);s.v_.add(0),yield rc(s),s.x_.set("Offline")})}(n)}))}function xz(t,e){let n=new at;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield function(u,l){let d=R(u);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new w(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=oc(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield g0(t),e,n)})),n.promise}function g1(t,e,n={}){let r=new at;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,c,u){let l=new Xa({next:h=>{o.enqueueAndForget(()=>a0(s,d));let f=h.docs.has(a);!f&&h.fromCache?u.reject(new w(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?u.reject(new w(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new Ul(nc(a.path),l,{includeMetadataChanges:!0,ta:!0});return o0(s,d)}(yield Ja(t),t.asyncQueue,e,n,r)})),r.promise}function Mz(t,e){let n=new at;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield _g(i,s,!0),c=new Mg(s,a.hs),u=c.Ta(a.documents),l=c.applyChanges(u,!1);o.resolve(l.snapshot)}catch(a){let c=oc(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield g0(t),e,n)})),n.promise}function m1(t,e,n={}){let r=new at;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,c,u){let l=new Xa({next:h=>{o.enqueueAndForget(()=>a0(s,d)),h.fromCache&&c.source==="server"?u.reject(new w(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new Ul(a,l,{includeMetadataChanges:!0,ta:!0});return o0(s,d)}(yield Ja(t),t.asyncQueue,e,n,r)})),r.promise}function Rz(t,e){let n=new Xa(e);return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){R(i).W_.add(s),s.next()}(yield Ja(t),n)})),()=>{n.Qa(),t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){R(i).W_.delete(s)}(yield Ja(t),n)}))}}function Nz(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?Ak().encode(o):o,function(l,d){return new TC(l,d)}(function(l,d){if(l instanceof Uint8Array)return jP(l,d);if(l instanceof ArrayBuffer)return jP(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,Ql(e));t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){Tz(yield m0(t),i,r)}))}function Pz(t,e){return t.asyncQueue.enqueue(()=>_(this,null,function*(){return function(r,i){let s=R(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield g0(t),e)}))}function y1(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var UP=new Map;function y0(t,e,n){if(!n)throw new w(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _0(t,e,n,r){if(e===!0&&r===!0)throw new w(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function BP(t){if(!M.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $P(t){if(M.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Gg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":O()}function ye(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new w(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Gg(t);throw new w(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function _1(t,e){if(e<=0)throw new w(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Ng=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new w(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new w(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=y1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ro=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ng({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new w(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ng(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new zE;switch(r.type){case"firstParty":return new ZE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new w(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=UP.get(n);r&&(I("ComponentProvider","Removing Datastore"),UP.delete(n),r.terminate())}(this),Promise.resolve()}};function Wg(t,e,n,r={}){var i;let s=(t=ye(t,ro))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=ot.MOCK_USER;else{a=qd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new w(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ot(u)}t._authCredentials=new KE(new Gp(a,c))}}var Rt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Re=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},xr=class t extends Rt{constructor(e,n,r){super(e,n,nc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Re(this.firestore,null,new M(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function zg(t,e,...n){if(t=ue(t),y0("collection","path",e),t instanceof ro){let r=me.fromString(e,...n);return $P(r),new xr(t,null,r)}{if(!(t instanceof Re||t instanceof xr))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return $P(r),new xr(t.firestore,null,r)}}function v0(t,e){if(t=ye(t,ro),y0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Rt(t,null,function(r){return new tr(me.emptyPath(),r)}(e))}function ac(t,e,...n){if(t=ue(t),arguments.length===1&&(e=Wp.newId()),y0("doc","path",e),t instanceof ro){let r=me.fromString(e,...n);return BP(r),new Re(t,null,new M(r))}{if(!(t instanceof Re||t instanceof xr))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return BP(r),new Re(t.firestore,t instanceof xr?t.converter:null,new M(r))}}function Kg(t,e){return t=ue(t),e=ue(e),(t instanceof Re||t instanceof xr)&&(e instanceof Re||e instanceof xr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Qg(t,e){return t=ue(t),e=ue(e),t instanceof Rt&&e instanceof Rt&&t.firestore===e.firestore&&zl(t._query,e._query)&&t.converter===e.converter}var MC=class{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new jl(this,"async_queue_retry"),this.cu=()=>{let n=Hp();n&&I("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Hp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;let n=Hp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise(()=>{});let n=new at;return this.hu(()=>this.iu&&this.au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.ru.push(e),this.Pu()))}Pu(){return _(this,null,function*(){if(this.ru.length!==0){try{yield this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Ji(e))throw e;I("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo(()=>this.Pu())}})}hu(e){let n=this.nu.then(()=>(this._u=!0,e().catch(r=>{this.ou=r,this._u=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Je("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this._u=!1,r))));return this.nu=n,n}enqueueAfterDelay(e,n,r){this.lu(),this.uu.indexOf(e)>-1&&(n=0);let i=pC.createAndSchedule(this,e,n,r,s=>this.Iu(s));return this.su.push(i),i}lu(){this.ou&&O()}verifyOperationInProgress(){}Tu(){return _(this,null,function*(){let e;do e=this.nu,yield e;while(e!==this.nu)})}Eu(e){for(let n of this.su)if(n.timerId===e)return!0;return!1}du(e){return this.Tu().then(()=>{this.su.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.su)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tu()})}Au(e){this.uu.push(e)}Iu(e){let n=this.su.indexOf(e);this.su.splice(n,1)}};function RC(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var NC=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new at,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var v1=-1,Ue=class extends ro{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new MC}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||E1(this),this._firestoreClient.terminate()}};function w1(t,e){let n=typeof t=="object"?t:To(),r=typeof t=="string"?t:e||"(default)",i=Qd(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=my("firestore");s&&Wg(i,...s)}return i}function ft(t){return t._firestoreClient||E1(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function E1(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,l){return new sI(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,y1(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new AC(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function w0(t,e){C1(t=ye(t,Ue));let n=ft(t);if(n._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");jn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new $l;return I1(n,i,new Rg(i,r.cacheSizeBytes,e?.forceOwnership))}function E0(t){C1(t=ye(t,Ue));let e=ft(t);if(e._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");jn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new $l;return I1(e,r,new DC(r,n.cacheSizeBytes))}function I1(t,e,n){let r=new at;return t.asyncQueue.enqueue(()=>_(this,null,function*(){try{yield qp(t,n),yield xC(t,e),r.resolve()}catch(i){let s=i;if(!h1(s))throw s;jn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function I0(t){if(t._initialized&&!t._terminated)throw new w(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new at;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{yield function(r){return _(this,null,function*(){if(!ri.D())return Promise.resolve();let i=r+"main";yield ri.delete(i)})}(n0(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function C0(t){return function(n){let r=new at;return n.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return pz(yield m0(n),r)})),r.promise}(ft(t=ye(t,Ue)))}function D0(t){return Sz(ft(t=ye(t,Ue)))}function T0(t){return Az(ft(t=ye(t,Ue)))}function b0(t,e){let n=ft(t=ye(t,Ue)),r=new NC;return Nz(n,t._databaseId,e,r),r}function S0(t,e){return Pz(ft(t=ye(t,Ue)),e).then(n=>n?new Rt(t,null,n.query):null)}function C1(t){if(t._initialized||t._terminated)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Pr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Et.fromBase64String(e))}catch(n){throw new w(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var rr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new w(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var oi=class{constructor(e){this._methodName=e}};var io=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new w(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new w(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}};var kz=/^__.*__$/,PC=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new nr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Qi(e,this.data,n,this.fieldTransforms)}},Pg=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new nr(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function D1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O()}}var kg=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.pu(e),i}yu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.mu({path:r,gu:!1});return i.Ru(),i}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return Og(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(e.length===0)throw this.Su("Document fields must not be empty");if(D1(this.Vu)&&kz.test(e))throw this.Su('Document fields cannot begin and end with "__"')}},kC=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ql(e)}Cu(e,n,r,i=!1){return new kg({Vu:e,methodName:n,Du:r,path:et.emptyPath(),gu:!1,bu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function co(t){let e=t._freezeSettings(),n=Ql(t._databaseId);return new kC(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Yg(t,e,n,r,i,s={}){let o=t.Cu(s.merge||s.mergeFields?2:0,e,n,i);M0("Data must be an object, but it was:",o,r);let a=S1(r,o),c,u;if(s.merge)c=new vn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=jC(e,d,n);if(!o.contains(h))throw new w(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);x1(l,h)||l.push(h)}c=new vn(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new PC(new Ft(a),c,u)}var Hl=class t extends oi{_toFieldTransform(e){if(e.Vu!==2)throw e.Vu===1?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function T1(t,e,n){return new kg({Vu:3,Du:e.settings.Du,methodName:t._methodName,gu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var OC=class t extends oi{_toFieldTransform(e){return new eo(e.path,new zi)}isEqual(e){return e instanceof t}},FC=class t extends oi{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=T1(this,e,!0),r=this.vu.map(s=>uo(s,n)),i=new ii(r);return new eo(e.path,i)}isEqual(e){return e instanceof t&&vy(this.vu,e.vu)}},VC=class t extends oi{constructor(e,n){super(e),this.vu=n}_toFieldTransform(e){let n=T1(this,e,!0),r=this.vu.map(s=>uo(s,n)),i=new si(r);return new eo(e.path,i)}isEqual(e){return e instanceof t&&vy(this.vu,e.vu)}},LC=class t extends oi{constructor(e,n){super(e),this.Fu=n}_toFieldTransform(e){let n=new Ki(e.serializer,vk(e.serializer,this.Fu));return new eo(e.path,n)}isEqual(e){return e instanceof t&&this.Fu===e.Fu}};function A0(t,e,n,r){let i=t.Cu(1,e,n);M0("Data must be an object, but it was:",i,r);let s=[],o=Ft.empty();ao(r,(c,u)=>{let l=R0(e,c,n);u=ue(u);let d=i.yu(l);if(u instanceof Hl)s.push(l);else{let h=uo(u,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new vn(s);return new Pg(o,a,i.fieldTransforms)}function x0(t,e,n,r,i,s){let o=t.Cu(1,e,n),a=[jC(e,r,n)],c=[i];if(s.length%2!=0)throw new w(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(jC(e,s[h])),c.push(s[h+1]);let u=[],l=Ft.empty();for(let h=a.length-1;h>=0;--h)if(!x1(u,a[h])){let f=a[h],p=c[h];p=ue(p);let g=o.yu(f);if(p instanceof Hl)u.push(f);else{let v=uo(p,g);v!=null&&(u.push(f),l.set(f,v))}}let d=new vn(u);return new Pg(l,d,o.fieldTransforms)}function b1(t,e,n,r=!1){return uo(n,t.Cu(r?4:3,e))}function uo(t,e){if(A1(t=ue(t)))return M0("Unsupported field value:",e,t),S1(t,e);if(t instanceof oi)return function(r,i){if(!D1(i.Vu))throw i.Su(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Su(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&e.Vu!==4)throw e.Su("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=uo(a,i.wu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ue(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vk(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=$e.fromDate(r);return{timestampValue:qa(i.serializer,s)}}if(r instanceof $e){let s=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:qa(i.serializer,s)}}if(r instanceof io)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pr)return{bytesValue:xk(i.serializer,r._byteString)};if(r instanceof Re){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Su(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:JC(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Su(`Unsupported field value: ${Gg(r)}`)}(t,e)}function S1(t,e){let n={};return tk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ao(t,(r,i)=>{let s=uo(i,e.fu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function A1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof io||t instanceof Pr||t instanceof Re||t instanceof oi)}function M0(t,e,n){if(!A1(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Gg(n);throw r==="an object"?e.Su(t+" a custom object"):e.Su(t+" "+r)}}function jC(t,e,n){if((e=ue(e))instanceof rr)return e._internalPath;if(typeof e=="string")return R0(t,e);throw Og("Field path arguments must be of type string or ",t,!1,void 0,n)}var Oz=new RegExp("[~\\*/\\[\\]]");function R0(t,e,n){if(e.search(Oz)>=0)throw Og(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rr(...e.split("."))._internalPath}catch{throw Og(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Og(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new w(y.INVALID_ARGUMENT,a+t+c)}function x1(t,e){return t.some(n=>n.isEqual(e))}var so=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Re(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new UC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Zg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},UC=class extends so{data(){return super.data()}};function Zg(t,e){return typeof e=="string"?R0(t,e):e instanceof rr?e._internalPath:e._delegate._internalPath}function M1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new w(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ql=class{},oo=class extends ql{};function kr(t,e,...n){let r=[];e instanceof ql&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof BC).length,a=s.filter(c=>c instanceof Fg).length;if(o>1||o>0&&a>0)throw new w(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Fg=class t extends oo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return N1(e._query,n),new Rt(e.firestore,e.converter,_I(e._query,n))}_parse(e){let n=co(e.firestore);return function(s,o,a,c,u,l,d){let h;if(u.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new w(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){qP(d,l);let f=[];for(let p of d)f.push(HP(c,s,p));h={arrayValue:{values:f}}}else h=HP(c,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||qP(d,l),h=b1(a,o,d,l==="in"||l==="not-in");return fe.create(u,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function N0(t,e,n){let r=e,i=Zg("where",t);return Fg._create(i,r,n)}var BC=class t extends ql{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:De.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)N1(o,c),o=_I(o,c)}(e._query,n),new Rt(e.firestore,e.converter,_I(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var $C=class t extends oo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xs(s,o)}(e._query,this._field,this._direction);return new Rt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new tr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function P0(t,e="asc"){let n=e,r=Zg("orderBy",t);return $C._create(r,n)}var Vg=class t extends oo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Rt(e.firestore,e.converter,ng(e._query,this._limit,this._limitType))}};function k0(t){return _1("limit",t),Vg._create("limit",t,"F")}function O0(t){return _1("limitToLast",t),Vg._create("limitToLast",t,"L")}var Lg=class t extends oo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=R1(e,this.type,this._docOrFields,this._inclusive);return new Rt(e.firestore,e.converter,function(i,s){return new tr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function F0(...t){return Lg._create("startAt",t,!0)}function V0(...t){return Lg._create("startAfter",t,!1)}var jg=class t extends oo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=R1(e,this.type,this._docOrFields,this._inclusive);return new Rt(e.firestore,e.converter,function(i,s){return new tr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function L0(...t){return jg._create("endBefore",t,!1)}function j0(...t){return jg._create("endAt",t,!0)}function R1(t,e,n,r){if(n[0]=ue(n[0]),n[0]instanceof so)return function(s,o,a,c,u){if(!c)throw new w(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of Fa(s))if(d.field.isKeyField())l.push(Zs(o,c.key));else{let h=c.data.field(d.field);if(Bg(h))throw new w(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new w(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new Rr(l,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=co(t.firestore);return function(o,a,c,u,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new w(y.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new w(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof g}`);if(!ZC(o)&&g.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${g}' contains a slash.`);let v=o.path.child(me.fromString(g));if(!M.isDocumentKey(v))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);let T=new M(v);f.push(Zs(a,T))}else{let v=b1(c,u,g);f.push(v)}}return new Rr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function HP(t,e,n){if(typeof(n=ue(n))=="string"){if(n==="")throw new w(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ZC(e)&&n.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(me.fromString(n));if(!M.isDocumentKey(r))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Zs(t,new M(r))}if(n instanceof Re)return Zs(t,n._key);throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gg(n)}.`)}function qP(t,e){if(!Array.isArray(t)||t.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function N1(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var ec=class{convertValue(e,n="none"){switch(Ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(qi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw O()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return ao(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new io(Ke(e.latitude),Ke(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=QC(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(bl(e));default:return null}}convertTimestamp(e){let n=Hi(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=me.fromString(e);L(Uk(r));let i=new Gi(r.get(1),r.get(3)),s=new M(r.popFirst(5));return i.isEqual(n)||Je(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Xg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var HC=class extends ec{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,n)}};var ni=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Bn=class extends so{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Bi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Zg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Bi=class extends Bn{data(e={}){return super.data(e)}},ir=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ni(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Bi(this._firestore,this._userDataWriter,r.key,r,new ni(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Bi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ni(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Bi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ni(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:Fz(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function Fz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O()}}function Jg(t,e){return t instanceof Bn&&e instanceof Bn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ir&&e instanceof ir&&t._firestore===e._firestore&&Qg(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function U0(t){t=ye(t,Re);let e=ye(t.firestore,Ue);return g1(ft(e),t._key).then(n=>Q0(e,t,n))}var ai=class extends ec{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Re(this.firestore,null,n)}};function B0(t){t=ye(t,Re);let e=ye(t.firestore,Ue),n=ft(e),r=new ai(e);return xz(n,t._key).then(i=>new Bn(e,r,t._key,i,new ni(i!==null&&i.hasLocalMutations,!0),t.converter))}function $0(t){t=ye(t,Re);let e=ye(t.firestore,Ue);return g1(ft(e),t._key,{source:"server"}).then(n=>Q0(e,t,n))}function H0(t){t=ye(t,Rt);let e=ye(t.firestore,Ue),n=ft(e),r=new ai(e);return M1(t._query),m1(n,t._query).then(i=>new ir(e,r,t,i))}function q0(t){t=ye(t,Rt);let e=ye(t.firestore,Ue),n=ft(e),r=new ai(e);return Mz(n,t._query).then(i=>new ir(e,r,t,i))}function G0(t){t=ye(t,Rt);let e=ye(t.firestore,Ue),n=ft(e),r=new ai(e);return m1(n,t._query,{source:"server"}).then(i=>new ir(e,r,t,i))}function em(t,e,n){t=ye(t,Re);let r=ye(t.firestore,Ue),i=Xg(t.converter,e,n);return cc(r,[Yg(co(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Qe.none())])}function tm(t,e,n,...r){t=ye(t,Re);let i=ye(t.firestore,Ue),s=co(i),o;return o=typeof(e=ue(e))=="string"||e instanceof rr?x0(s,"updateDoc",t._key,e,n,r):A0(s,"updateDoc",t._key,e),cc(i,[o.toMutation(t._key,Qe.exists(!0))])}function W0(t){return cc(ye(t.firestore,Ue),[new Yi(t._key,Qe.none())])}function z0(t,e){let n=ye(t.firestore,Ue),r=ac(t),i=Xg(t.converter,e);return cc(n,[Yg(co(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Qe.exists(!1))]).then(()=>r)}function nm(t,...e){var n,r,i;t=ue(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||RC(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(RC(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,u,l;if(t instanceof Re)u=ye(t.firestore,Ue),l=nc(t._key.path),c={next:d=>{e[o]&&e[o](Q0(u,t,d))},error:e[o+1],complete:e[o+2]};else{let d=ye(t,Rt);u=ye(d.firestore,Ue),l=d._query;let h=new ai(u);c={next:f=>{e[o]&&e[o](new ir(u,h,d,f))},error:e[o+1],complete:e[o+2]},M1(t._query)}return function(h,f,p,g){let v=new Xa(g),T=new Ul(f,v,p);return h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return o0(yield Ja(h),T)})),()=>{v.Qa(),h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return a0(yield Ja(h),T)}))}}(ft(u),l,a,c)}function K0(t,e){return Rz(ft(t=ye(t,Ue)),RC(e)?e:{next:e})}function cc(t,e){return function(r,i){let s=new at;return r.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return lz(yield m0(r),i,s)})),s.promise}(ft(t),e)}function Q0(t,e,n){let r=n.docs.get(e._key),i=new ai(t);return new Bn(t,i,e._key,r,new ni(n.hasPendingWrites,n.fromCache),e.converter)}var Vz={maxAttempts:5};var Ug=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=co(e)}set(e,n,r){this._verifyNotCommitted();let i=ji(e,this._firestore),s=Xg(i.converter,n,r),o=Yg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Qe.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=ji(e,this._firestore),o;return o=typeof(n=ue(n))=="string"||n instanceof rr?x0(this._dataReader,"WriteBatch.update",s._key,n,r,i):A0(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Qe.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=ji(e,this._firestore);return this._mutations=this._mutations.concat(new Yi(n._key,Qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new w(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ji(t,e){if((t=ue(t)).firestore!==e)throw new w(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var qC=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=co(n)}get(n){let r=ji(n,this._firestore),i=new HC(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return O();let o=s[0];if(o.isFoundDocument())return new so(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new so(this._firestore,i,r._key,null,r.converter);throw O()})}set(n,r,i){let s=ji(n,this._firestore),o=Xg(s.converter,r,i),a=Yg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=ji(n,this._firestore),a;return a=typeof(r=ue(r))=="string"||r instanceof rr?x0(this._dataReader,"Transaction.update",o._key,r,i,s):A0(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=ji(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=ji(e,this._firestore),r=new ai(this._firestore);return super.get(e).then(i=>new Bn(this._firestore,r,n._key,i._document,new ni(!1,!1),n.converter))}};function Y0(t,e,n){t=ye(t,Ue);let r=Object.assign(Object.assign({},Vz),n);return function(s){if(s.maxAttempts<1)throw new w(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new at;return s.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){let u=yield bz(s);new SC(s.asyncQueue,u,a,o,c).Ya()})),c.promise}(ft(t),i=>e(new qC(t,i)),r)}function Z0(){return new Hl("deleteField")}function X0(){return new OC("serverTimestamp")}function J0(...t){return new FC("arrayUnion",t)}function eD(...t){return new VC("arrayRemove",t)}function tD(t){return new LC("increment",t)}(function(e,n=!0){(function(i){tc=i})(Yd),ls(new un("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ue(new QE(r.getProvider("auth-internal")),new JE(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new w(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gi(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),gt(GN,"4.5.0",e),gt(GN,"4.5.0","esm2017")})();var Lz="@firebase/firestore-compat",jz="0.3.27";function aD(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new w("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function P1(){if(typeof Uint8Array>"u")throw new w("unimplemented","Uint8Arrays are not available in this environment.")}function k1(){if(!nk())throw new w("unimplemented","Blobs are unavailable in Firestore in this environment.")}var rm=class t{constructor(e){this._delegate=e}static fromBase64String(e){return k1(),new t(Pr.fromBase64String(e))}static fromUint8Array(e){return P1(),new t(Pr.fromUint8Array(e))}toBase64(){return k1(),this._delegate.toBase64()}toUint8Array(){return P1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function nD(t){return Uz(t,["next","error","complete"])}function Uz(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var rD=class{enableIndexedDbPersistence(e,n){return w0(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return E0(e._delegate)}clearIndexedDbPersistence(e){return I0(e._delegate)}},im=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Gi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&jn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){Wg(this._delegate,e,n,r)}enableNetwork(){return D0(this._delegate)}disableNetwork(){return T0(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,_0("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return C0(this._delegate)}onSnapshotsInSync(e){return K0(this._delegate,e)}get app(){if(!this._appCompat)throw new w("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new dc(this,zg(this._delegate,e))}catch(n){throw Kt(n,"collection()","Firestore.collection()")}}doc(e){try{return new Or(this,ac(this._delegate,e))}catch(n){throw Kt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new po(this,v0(this._delegate,e))}catch(n){throw Kt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Y0(this._delegate,n=>e(new sm(this,n)))}batch(){return ft(this._delegate),new om(new Ug(this._delegate,e=>cc(this._delegate,e)))}loadBundle(e){return b0(this._delegate,e)}namedQuery(e){return S0(this._delegate,e).then(n=>n?new po(this,n):null)}},uc=class extends ec{constructor(e){super(),this.firestore=e}convertBytes(e){return new rm(new Pr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Or.forKey(n,this.firestore,null)}};function Bz(t){GC(t)}var sm=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new uc(e)}get(e){let n=lo(e);return this._delegate.get(n).then(r=>new ho(this._firestore,new Bn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=lo(e);return r?(aD("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=lo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=lo(e);return this._delegate.delete(n),this}},om=class{constructor(e){this._delegate=e}set(e,n,r){let i=lo(e);return r?(aD("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=lo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=lo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},lc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Bi(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new fo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new uc(e),n),i.set(n,s)),s}};lc.INSTANCES=new WeakMap;var Or=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new uc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new w("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Re(n._delegate,r,new M(e)))}static forKey(e,n,r){return new t(n,new Re(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new dc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new dc(this.firestore,zg(this._delegate,e))}catch(n){throw Kt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ue(e),e instanceof Re?Kg(this._delegate,e):!1}set(e,n){n=aD("DocumentReference.set",n);try{return n?em(this._delegate,e,n):em(this._delegate,e)}catch(r){throw Kt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?tm(this._delegate,e):tm(this._delegate,e,n,...r)}catch(i){throw Kt(i,"updateDoc()","DocumentReference.update()")}}delete(){return W0(this._delegate)}onSnapshot(...e){let n=O1(e),r=F1(e,i=>new ho(this.firestore,new Bn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return nm(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=B0(this._delegate):e?.source==="server"?n=$0(this._delegate):n=U0(this._delegate),n.then(r=>new ho(this.firestore,new Bn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(lc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Kt(t,e,n){return t.message=t.message.replace(e,n),t}function O1(t){for(let e of t)if(typeof e=="object"&&!nD(e))return e;return{}}function F1(t,e){var n,r;let i;return nD(t[0])?i=t[0]:nD(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var ho=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Or(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Jg(this._delegate,e._delegate)}},fo=class extends ho{data(e){let n=this._delegate.data(e);return this._delegate._converter||GP(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},po=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new uc(e)}where(e,n,r){try{return new t(this.firestore,kr(this._delegate,N0(e,n,r)))}catch(i){throw Kt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,kr(this._delegate,P0(e,n)))}catch(r){throw Kt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,kr(this._delegate,k0(e)))}catch(n){throw Kt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,kr(this._delegate,O0(e)))}catch(n){throw Kt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,kr(this._delegate,F0(...e)))}catch(n){throw Kt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,kr(this._delegate,V0(...e)))}catch(n){throw Kt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,kr(this._delegate,L0(...e)))}catch(n){throw Kt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,kr(this._delegate,j0(...e)))}catch(n){throw Kt(n,"endAt()","Query.endAt()")}}isEqual(e){return Qg(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=q0(this._delegate):e?.source==="server"?n=G0(this._delegate):n=H0(this._delegate),n.then(r=>new Zl(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=O1(e),r=F1(e,i=>new Zl(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return nm(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(lc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},iD=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new fo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Zl=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new po(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new fo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new iD(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new fo(this._firestore,r))})}isEqual(e){return Jg(this._delegate,e._delegate)}},dc=class t extends po{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Or(this.firestore,e):null}doc(e){try{return e===void 0?new Or(this.firestore,ac(this._delegate)):new Or(this.firestore,ac(this._delegate,e))}catch(n){throw Kt(n,"doc()","CollectionReference.doc()")}}add(e){return z0(this._delegate,e).then(n=>new Or(this.firestore,n))}isEqual(e){return Kg(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(lc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function lo(t){return ye(t,Re)}var sD=class t{constructor(...e){this._delegate=new rr(...e)}static documentId(){return new t(et.keyField().canonicalString())}isEqual(e){return e=ue(e),e instanceof rr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var oD=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=X0();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=Z0();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=J0(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=eD(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=tD(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var $z={Firestore:im,GeoPoint:io,Timestamp:$e,Blob:rm,Transaction:sm,WriteBatch:om,DocumentReference:Or,DocumentSnapshot:ho,Query:po,QueryDocumentSnapshot:fo,QuerySnapshot:Zl,CollectionReference:dc,FieldPath:sD,FieldValue:oD,setLogLevel:Bz,CACHE_SIZE_UNLIMITED:v1};function Hz(t,e){t.INTERNAL.registerComponent(new un("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},$z)))}function qz(t){Hz(t,(e,n)=>new im(e,n,new rD)),t.registerVersion(Lz,jz)}qz(Tt);function Gz(t,e=gs){return new ne(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function V1(t,e){return Gz(t,e)}function Wz(t,e){return V1(t,e).pipe(ys(void 0),Uc(),j(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function lD(t,e){return V1(t,e).pipe(j(n=>({payload:n,type:"query"})))}var am=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=U1(r,n);return new um(i,s,this.afs)}snapshotChanges(){return Wz(this.ref,this.afs.schedulers.outsideAngular).pipe(We)}valueChanges(e={}){return this.snapshotChanges().pipe(j(({payload:n})=>e.idField?de(x({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return _e(this.ref.get(e)).pipe(We)}};function cm(t,e){return lD(t,e).pipe(ys(void 0),Uc(),j(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let u=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function L1(t,e,n){return cm(t,n).pipe(ur((r,i)=>zz(r,i.map(s=>s.payload),e),[]),Lc(),j(r=>r.map(i=>({type:i.type,payload:i}))))}function zz(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=Kz(t,r))}),t}function cD(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function Kz(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return cD(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return cD(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return cD(t,e.oldIndex,1);break}return t}function j1(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var um=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=cm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(j(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(ys(void 0),Uc(),At(([r,i])=>i.length>0||!r),j(([,r])=>r),We)}auditTrail(e){return this.stateChanges(e).pipe(ur((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=j1(e);return L1(this.query,n,this.afs.schedulers.outsideAngular).pipe(We)}valueChanges(e={}){return lD(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.payload.docs.map(r=>e.idField?de(x({},r.data()),{[e.idField]:r.id}):r.data())),We)}get(e){return _e(this.query.get(e)).pipe(We)}add(e){return this.ref.add(e)}doc(e){return new am(this.ref.doc(e),this.afs)}},uD=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?cm(this.query,this.afs.schedulers.outsideAngular).pipe(We):cm(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.filter(r=>e.indexOf(r.type)>-1)),At(n=>n.length>0),We)}auditTrail(e){return this.stateChanges(e).pipe(ur((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=j1(e);return L1(this.query,n,this.afs.schedulers.outsideAngular).pipe(We)}valueChanges(e={}){return lD(this.query,this.afs.schedulers.outsideAngular).pipe(j(r=>r.payload.docs.map(i=>e.idField?x({[e.idField]:i.id},i.data()):i.data())),We)}get(e){return _e(this.query.get(e)).pipe(We)}},Qz=new k("angularfire2.enableFirestorePersistence"),Yz=new k("angularfire2.firestore.persistenceSettings"),Zz=new k("angularfire2.firestore.settings"),Xz=new k("angularfire2.firestore.use-emulator");function U1(t,e=n=>n){return{query:e(t),ref:t}}var lm=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,g,v,T,F){this.schedulers=c;let S=Fs(n,a,r),H=l;d&&$u(S,a,h,p,g,v,f,T),[this.firestore,this.persistenceEnabled$]=_a(`${S.name}.firestore`,"AngularFirestore",S.name,()=>{let W=a.runOutsideAngular(()=>S.firestore());if(s&&W.settings(s),H&&W.useEmulator(...H),i&&!xs(o)){let Y=()=>{try{return _e(W.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(Te){return typeof console<"u"&&console.warn(Te),U(!1)}};return[W,a.runOutsideAngular(Y)]}else return[W,U(!1)]},[s,H,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=U1(i,r),a=this.schedulers.ngZone.run(()=>s);return new um(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new uD(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new am(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(E(Ni),E(Pi,8),E(Qz,8),E(Zz,8),E(mt),E(ie),E(Zn),E(Yz,8),E(Xz,8),E(sp,8),E(Fu,8),E(Vu,8),E(Lu,8),E(ju,8),E(Uu,8),E(Bu,8),E(Fn,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var $1=(()=>{let e=class e{constructor(r){this.firestore=r}getTipo(){return this.firestore.collection("tipo").snapshotChanges()}getPokemon(){return this.firestore.collection("pokemon").snapshotChanges()}createPokemon(r){return this.firestore.collection("pokemon").add(Object.assign({},r))}updatePokemon(r){this.firestore.doc("pokemon/"+r.id).update(r)}deletePokemon(r){this.firestore.doc("pokemon/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(E(lm))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var dm=(()=>{let e=class e{constructor(r){this.firestore=r}getTipo(){return this.firestore.collection("tipo").snapshotChanges()}createTipo(r){return this.firestore.collection("tipo").add(Object.assign({},r))}updateTipo(r){this.firestore.doc("tipo/"+r.id).update(r)}deleteTipo(r){this.firestore.doc("tipo/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(E(lm))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var J1=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(le(Qr),le(mr))},e.\u0275dir=Ze({type:e});let t=e;return t})(),gm=(()=>{let e=class e extends J1{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275dir=Ze({type:e,features:[fn]});let t=e;return t})(),nd=new k("");var e9={provide:nd,useExisting:Rn(()=>fc),multi:!0};function t9(){let t=_r()?_r().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var n9=new k(""),fc=(()=>{let e=class e extends J1{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!t9())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(le(Qr),le(mr),le(n9,8))},e.\u0275dir=Ze({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Ae("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[yr([e9]),fn]});let t=e;return t})();function ed(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function r9(t){return t!=null&&typeof t.length=="number"}var rd=new k(""),i9=new k("");function s9(t){return e=>{if(ed(e.value)||ed(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function o9(t){return e=>{if(ed(e.value)||ed(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function a9(t){return ed(t.value)?{required:!0}:null}function c9(t){return e=>r9(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function q1(t){return null}function eO(t){return t!=null}function tO(t){return Ss(t)?_e(t):t}function nO(t){let e={};return t.forEach(n=>{e=n!=null?x(x({},e),n):e}),Object.keys(e).length===0?null:e}function rO(t,e){return e.map(n=>n(t))}function u9(t){return!t.validate}function iO(t){return t.map(e=>u9(e)?e:n=>e.validate(n))}function l9(t){if(!t)return null;let e=t.filter(eO);return e.length==0?null:function(n){return nO(rO(n,e))}}function sO(t){return t!=null?l9(iO(t)):null}function d9(t){if(!t)return null;let e=t.filter(eO);return e.length==0?null:function(n){let r=rO(n,e).map(tO);return jy(r).pipe(j(nO))}}function oO(t){return t!=null?d9(iO(t)):null}function G1(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function h9(t){return t._rawValidators}function f9(t){return t._rawAsyncValidators}function dD(t){return t?Array.isArray(t)?t:[t]:[]}function fm(t,e){return Array.isArray(t)?t.includes(e):t===e}function W1(t,e){let n=dD(e);return dD(t).forEach(i=>{fm(n,i)||n.push(i)}),n}function z1(t,e){return dD(e).filter(n=>!fm(t,n))}var pm=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=sO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=oO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},hD=class extends pm{get formDirective(){return null}get path(){return null}},td=class extends pm{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},fD=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},p9={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Hre=de(x({},p9),{"[class.ng-submitted]":"isSubmitted"}),mm=(()=>{let e=class e extends fD{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(le(td,2))},e.\u0275dir=Ze({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Rv("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[fn]});let t=e;return t})();var Xl="VALID",hm="INVALID",hc="PENDING",Jl="DISABLED";function g9(t){return(ym(t)?t.validators:t)||null}function m9(t){return Array.isArray(t)?sO(t):t||null}function y9(t,e){return(ym(e)?e.asyncValidators:t)||null}function _9(t){return Array.isArray(t)?oO(t):t||null}function ym(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var pD=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Xl}get invalid(){return this.status===hm}get pending(){return this.status==hc}get disabled(){return this.status===Jl}get enabled(){return this.status!==Jl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(W1(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(W1(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(z1(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(z1(e,this._rawAsyncValidators))}hasValidator(e){return fm(this._rawValidators,e)}hasAsyncValidator(e){return fm(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=hc,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Jl,this.errors=null,this._forEachChild(r=>{r.disable(de(x({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(de(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Xl,this._forEachChild(r=>{r.enable(de(x({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(de(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Xl||this.status===hc)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jl:Xl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=hc,this._hasOwnPendingAsyncValidator=!0;let n=tO(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new dt,this.statusChanges=new dt}_calculateStatus(){return this._allControlsDisabled()?Jl:this.errors?hm:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(hc)?hc:this._anyControlsHaveStatus(hm)?hm:Xl}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ym(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=m9(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=_9(this._rawAsyncValidators)}};var aO=new k("CallSetDisabledState",{providedIn:"root",factory:()=>gD}),gD="always";function v9(t,e){return[...e.path,t]}function w9(t,e,n=gD){I9(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),C9(t,e),T9(t,e),D9(t,e),E9(t,e)}function K1(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function E9(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function I9(t,e){let n=h9(t);e.validator!==null?t.setValidators(G1(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=f9(t);e.asyncValidator!==null?t.setAsyncValidators(G1(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();K1(e._rawValidators,i),K1(e._rawAsyncValidators,i)}function C9(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&cO(t,e)})}function D9(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&cO(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function cO(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function T9(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function b9(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function S9(t){return Object.getPrototypeOf(t.constructor)===gm}function A9(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===fc?n=s:S9(s)?r=s:i=s}),i||r||n||null}function Q1(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Y1(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var x9=class extends pD{constructor(e=null,n,r){super(g9(n),y9(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ym(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Y1(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Q1(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Q1(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Y1(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var M9={provide:td,useExisting:Rn(()=>id)},Z1=Promise.resolve(),id=(()=>{let e=class e extends td{constructor(r,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new x9,this._registered=!1,this.name="",this.update=new dt,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=A9(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),b9(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){w9(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Z1.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Ti(i);Z1.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?v9(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(le(hD,9),le(rd,10),le(i9,10),le(nd,10),le(As,8),le(aO,8))},e.\u0275dir=Ze({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Bt.None,"disabled","isDisabled"],model:[Bt.None,"ngModel","model"],options:[Bt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[yr([M9]),fn,Ii]});let t=e;return t})();var R9={provide:nd,useExisting:Rn(()=>mD),multi:!0},mD=(()=>{let e=class e extends gm{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275dir=Ze({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&Ae("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[yr([R9]),fn]});let t=e;return t})();var N9={provide:nd,useExisting:Rn(()=>pc),multi:!0};function uO(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function P9(t){return t.split(":")[0]}var pc=(()=>{let e=class e extends gm{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=uO(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=P9(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275dir=Ze({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&Ae("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[yr([N9]),fn]});let t=e;return t})(),_m=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(uO(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(le(mr),le(Qr),le(pc,9))},e.\u0275dir=Ze({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),k9={provide:nd,useExisting:Rn(()=>lO),multi:!0};function X1(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function O9(t){return t.split(":")[0]}var lO=(()=>{let e=class e extends gm{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let c=0;c<a.length;c++){let u=a[c],l=this._getOptionValue(u.value);s.push(l)}}else{let a=i.options;for(let c=0;c<a.length;c++){let u=a[c];if(u.selected){let l=this._getOptionValue(u.value);s.push(l)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=O9(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275dir=Ze({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&Ae("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[yr([k9]),fn]});let t=e;return t})(),vm=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(X1(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(X1(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(le(mr),le(Qr),le(lO,9))},e.\u0275dir=Ze({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();function F9(t){return typeof t=="number"?t:parseInt(t,10)}function dO(t){return typeof t=="number"?t:parseFloat(t)}var wm=(()=>{let e=class e{constructor(){this._validator=q1}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):q1,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ze({type:e,features:[Ii]});let t=e;return t})(),V9={provide:rd,useExisting:Rn(()=>yD),multi:!0},yD=(()=>{let e=class e extends wm{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=r=>dO(r),this.createValidator=r=>o9(r)}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275dir=Ze({type:e,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,s){i&2&&Di("max",s._enabled?s.max:null)},inputs:{max:"max"},features:[yr([V9]),fn]});let t=e;return t})(),L9={provide:rd,useExisting:Rn(()=>_D),multi:!0},_D=(()=>{let e=class e extends wm{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=r=>dO(r),this.createValidator=r=>s9(r)}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275dir=Ze({type:e,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,s){i&2&&Di("min",s._enabled?s.min:null)},inputs:{min:"min"},features:[yr([L9]),fn]});let t=e;return t})(),j9={provide:rd,useExisting:Rn(()=>sd),multi:!0};var sd=(()=>{let e=class e extends wm{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Ti,this.createValidator=r=>a9}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275dir=Ze({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&Di("required",s._enabled?"":null)},inputs:{required:"required"},features:[yr([j9]),fn]});let t=e;return t})();var U9={provide:rd,useExisting:Rn(()=>od),multi:!0},od=(()=>{let e=class e extends wm{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=r=>F9(r),this.createValidator=r=>c9(r)}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Pn(e)))(s||e)}})(),e.\u0275dir=Ze({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,s){i&2&&Di("maxlength",s._enabled?s.maxlength:null)},inputs:{maxlength:"maxlength"},features:[yr([U9]),fn]});let t=e;return t})();var B9=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=je({type:e}),e.\u0275inj=Le({});let t=e;return t})();var hO=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:aO,useValue:r.callSetDisabledState??gD}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=je({type:e}),e.\u0275inj=Le({imports:[B9]});let t=e;return t})();function $9(t,e){if(t&1&&(C(0,"option",19),A(1),D()),t&2){let n=e.$implicit;ke("value",n.id),X(),yt(n.tipo)}}function H9(t,e){if(t&1&&(C(0,"option",19),A(1),D()),t&2){let n=e.$implicit;ke("value",n.id),X(),yt(n.tipo)}}function q9(t,e){if(t&1&&(C(0,"option",19),A(1),D()),t&2){let n=e.$implicit;ke("value",n.id),X(),yt(n.tipo)}}function G9(t,e){if(t&1&&(C(0,"option",19),A(1),D()),t&2){let n=e.$implicit;ke("value",n.id),X(),yt(n.tipo)}}function W9(t,e){if(t&1){let n=Cf();C(0,"tr")(1,"td"),A(2),D(),C(3,"td"),A(4),D(),C(5,"td",20),A(6),D(),C(7,"td")(8,"select",21),qt("ngModelChange",function(i){let s=na(n).$implicit;return on(s.tipo1,i)||(s.tipo1=i),ra(i)}),kn(9,q9,2,2,"option",10),D()(),C(10,"td")(11,"select",21),qt("ngModelChange",function(i){let s=na(n).$implicit;return on(s.tipo2,i)||(s.tipo2=i),ra(i)}),kn(12,G9,2,2,"option",10),D()(),C(13,"td")(14,"button",22),Ae("click",function(){let i=na(n).$implicit,s=ou();return ra(s.selectPokemon(i))}),A(15,"Seleccionar"),D()()()}if(t&2){let n=e.$implicit,r=ou();X(2),yt(n.numero),X(2),yt(n.nombre),X(2),yt(n.descripcion),X(2),Ht("ngModel",n.tipo1),X(),ke("ngForOf",r.tipos),X(2),Ht("ngModel",n.tipo2),X(),ke("ngForOf",r.tipos)}}var pO=(()=>{let e=class e{constructor(r,i){this.pokemonService=r,this.tipoService=i,this.pokemones=[],this.pokemon=new Ps,this.tipos=[],this.tipo=new Xr,this.botonesHabilitados=!1}ngOnInit(){this.tipoService.getTipo().subscribe(r=>{this.tipos=r.map(i=>de(x({},i.payload.doc.data()),{id:i.payload.doc.id}))}),this.pokemonService.getPokemon().subscribe(r=>{this.pokemones=r.map(i=>de(x({},i.payload.doc.data()),{id:i.payload.doc.id}))}),this.pokemon.tipo1="",this.pokemon.tipo2="No tiene"}verificarCamposRequeridos(){this.botonesHabilitados=!!this.pokemon.numero&&!!this.pokemon.nombre&&!!this.pokemon.descripcion&&!!this.pokemon.tipo1,Number(this.pokemon.numero.trim())>0&&Number(this.pokemon.numero.trim())<1e4&&(alert("Inserte un valor mayor a 0"),this.botonesHabilitados=!1),this.pokemon.nombre.trim()==" "&&(alert("Inserte un nombre valido"),this.botonesHabilitados=!1),this.pokemon.descripcion.trim()==""&&(alert("Inserte una descripci\xF3n valida"),this.botonesHabilitados=!1)}insertarPokemon(){this.pokemonService.createPokemon(this.pokemon),this.pokemon=new Ps,this.botonesHabilitados=!1}selectPokemon(r){this.pokemon=r,this.botonesHabilitados=!0}updatePokemon(){this.pokemonService.updatePokemon(this.pokemon),this.pokemon=new Ps,this.botonesHabilitados=!1}deletePokemon(r){this.pokemonService.deletePokemon(r),this.pokemon=new Ps,this.botonesHabilitados=!1}};e.\u0275fac=function(i){return new(i||e)(le($1),le(dm))},e.\u0275cmp=rn({type:e,selectors:[["app-pokemon"]],decls:65,vars:11,consts:[[1,"container","pokemon-container"],[1,"pokemon-title"],[1,"pokemon-subtitle"],[1,"col-sm-12","col-md-6","col-lg-4","pokemon-form"],[1,"pokemon-label"],["type","number","id","numero","placeholder","Ingresa el numero de Pokedex","min","1","max","10000","required","",1,"form-control","pokemon-input",3,"ngModelChange","change","ngModel"],["type","text","id","nombre","placeholder","Ingresa el nombre","maxlength","15","required","",1,"form-control","pokemon-input",3,"ngModelChange","change","ngModel"],["name","","id","","type","text","id","descripcion","placeholder","Ingresa una descripci\xF3n","cols","30","rows","5","maxlength","400","required","",1,"form-control","pokemon-input",3,"ngModelChange","change","ngModel"],["id","tipo1","required","",1,"form-control","pokemon-select",3,"ngModelChange","change","ngModel"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["id","tipo2",1,"form-control","pokemon-select",3,"ngModelChange","ngModel"],["value","No tiene","selected",""],["type","button",1,"btn","btn-primary","pokemon-btn",3,"click","disabled"],["type","button",1,"btn","btn-warning","pokemon-btn",3,"click","disabled"],["type","button",1,"btn","btn-danger","pokemon-btn",3,"click","disabled"],[1,"container"],[1,"table","pokemon-table"],[4,"ngFor","ngForOf"],[3,"value"],[1,"desc"],["disabled","",1,"form-control","pokemon-select",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-primary","pokemon-btn",3,"click"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"h1",1),A(2,"Pok\xE9mon"),D(),C(3,"h4",2),A(4,"Alta de Pok\xE9mon"),D(),C(5,"div",3)(6,"label",4),A(7,"* Obligatorio"),D(),Ge(8,"br")(9,"br"),C(10,"p")(11,"label",4),A(12,"Numero de Pokedex *"),D(),C(13,"input",5),qt("ngModelChange",function(a){return on(s.pokemon.numero,a)||(s.pokemon.numero=a),a}),Ae("change",function(){return s.verificarCamposRequeridos()}),D()(),C(14,"p")(15,"label",4),A(16,"Nombre *"),D(),C(17,"input",6),qt("ngModelChange",function(a){return on(s.pokemon.nombre,a)||(s.pokemon.nombre=a),a}),Ae("change",function(){return s.verificarCamposRequeridos()}),D()(),C(18,"p")(19,"label",4),A(20,"Descripci\xF3n *"),D(),C(21,"textarea",7),qt("ngModelChange",function(a){return on(s.pokemon.descripcion,a)||(s.pokemon.descripcion=a),a}),Ae("change",function(){return s.verificarCamposRequeridos()}),D()(),C(22,"p")(23,"label",4),A(24,"Tipo Principal: *"),D(),C(25,"select",8),qt("ngModelChange",function(a){return on(s.pokemon.tipo1,a)||(s.pokemon.tipo1=a),a}),Ae("change",function(){return s.verificarCamposRequeridos()}),C(26,"option",9),A(27,"Selecciona una opci\xF3n"),D(),kn(28,$9,2,2,"option",10),D()(),C(29,"p")(30,"label",4),A(31,"Tipo Secundario: (Opcional)"),D(),C(32,"select",11),qt("ngModelChange",function(a){return on(s.pokemon.tipo2,a)||(s.pokemon.tipo2=a),a}),C(33,"option",12),A(34,"No tiene"),D(),kn(35,H9,2,2,"option",10),D()(),C(36,"table")(37,"tr")(38,"td")(39,"button",13),Ae("click",function(){return s.insertarPokemon()}),A(40,"Insertar"),D()(),C(41,"td")(42,"button",14),Ae("click",function(){return s.updatePokemon()}),A(43,"Actualizar"),D()(),C(44,"td")(45,"button",15),Ae("click",function(){return s.deletePokemon(s.pokemon.id)}),A(46,"Eliminar"),D()()()()(),Ge(47,"br"),C(48,"div",16)(49,"table",17)(50,"thead")(51,"th"),A(52,"No.Pokedex"),D(),C(53,"th"),A(54,"Nombre"),D(),C(55,"th"),A(56,"descripcion"),D(),C(57,"th"),A(58,"Tipo Principal"),D(),C(59,"th"),A(60,"Tipo Secundario"),D(),C(61,"th"),A(62,"Acciones"),D()(),C(63,"tbody"),kn(64,W9,16,7,"tr",18),D()()()()),i&2&&(X(13),Ht("ngModel",s.pokemon.numero),X(4),Ht("ngModel",s.pokemon.nombre),X(4),Ht("ngModel",s.pokemon.descripcion),X(4),Ht("ngModel",s.pokemon.tipo1),X(3),ke("ngForOf",s.tipos),X(4),Ht("ngModel",s.pokemon.tipo2),X(3),ke("ngForOf",s.tipos),X(4),ke("disabled",!s.botonesHabilitados),X(3),ke("disabled",!s.botonesHabilitados),X(3),ke("disabled",!s.botonesHabilitados),X(19),ke("ngForOf",s.pokemones))},dependencies:[Nf,_m,vm,fc,mD,pc,mm,sd,od,_D,yD,id],styles:[".pokemon-container[_ngcontent-%COMP%]{background-color:#f3f3f3;padding:20px;border-radius:10px}.pokemon-title[_ngcontent-%COMP%]{color:#e51400;text-align:center}.pokemon-subtitle[_ngcontent-%COMP%]{color:#06c;margin-top:20px}.pokemon-form[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:10px;margin-top:20px}.pokemon-label[_ngcontent-%COMP%]{color:#000;font-weight:700}.pokemon-input[_ngcontent-%COMP%], .pokemon-select[_ngcontent-%COMP%]{border:1px solid #999}.desc[_ngcontent-%COMP%]{overflow-y:scroll}.pokemon-table[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #999}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px;text-align:center}.pokemon-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;text-align:center;max-height:15px}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .pokemon-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-right:1px solid #999}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .pokemon-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-left:1px solid #999}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .pokemon-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid #999}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f3f3f3}.pokemon-btn[_ngcontent-%COMP%]{background-color:#ffcb05;color:#000;margin-right:5px}.pokemon-btn[_ngcontent-%COMP%]:hover{background-color:#ffc200}"]});let t=e;return t})();var vD=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=rn({type:e,selectors:[["app-home"]],decls:16,vars:0,consts:[[1,"container"],["src","./assets/pokebola.png","alt","Pok\xE9mon Logo",1,"logo"],["routerLink","/pokemon",1,"btn-start"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"header"),Ge(2,"img",1),D(),C(3,"main")(4,"h1"),A(5,"Bienvenido a la Pok\xE9dex"),D(),C(6,"p"),A(7,"\xA1Bienvenido, Entrenador Pok\xE9mon! En este emocionante proyecto, nos embarcamos en la creaci\xF3n de una Pok\xE9dex virtual, una herramienta indispensable para cualquier aspirante a Maestro Pok\xE9mon."),D(),C(8,"p"),A(9,"La Pok\xE9dex es una enciclopedia electr\xF3nica que contiene informaci\xF3n detallada sobre las diferentes especies de Pok\xE9mon que habitan en el mundo. Desde su n\xFAmero en la Pok\xE9dex hasta sus caracter\xEDsticas, habilidades, evoluciones y h\xE1bitats, la Pok\xE9dex proporciona a los entrenadores Pok\xE9mon datos esenciales para comprender y capturar estas criaturas."),D(),C(10,"p"),A(11,"Nuestro objetivo es crear una Pok\xE9dex interactiva y f\xE1cil de usar, que permita a los usuarios explorar y aprender sobre la amplia variedad de Pok\xE9mon que existen. Con una interfaz intuitiva y rica en contenido, nuestra Pok\xE9dex busca ser la compa\xF1era perfecta para cualquier entrenador en su viaje para convertirse en un verdadero Maestro Pok\xE9mon."),D(),C(12,"p"),A(13,"\xA1\xDAnete a nosotros en esta emocionante aventura para descubrir y capturar a todos los Pok\xE9mon que el mundo tiene para ofrecer!"),D(),C(14,"a",2),A(15,"\xA1Explorar la Pok\xE9dex!"),D()()())},dependencies:[ep],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px;text-align:center}.logo[_ngcontent-%COMP%]{width:200px}h1[_ngcontent-%COMP%]{font-size:2.5em;color:red;margin-bottom:20px}p[_ngcontent-%COMP%]{font-size:1.2em;color:#333;margin-bottom:20px}.btn-start[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#ffcb05;color:#333;text-decoration:none;border-radius:5px;font-weight:700;transition:background-color .3s ease}.btn-start[_ngcontent-%COMP%]:hover{background-color:#ffc200}"]});let t=e;return t})();function z9(t,e){if(t&1&&(C(0,"option",16),A(1),D()),t&2){let n=e.$implicit;ke("value",n.tipo),X(),yt(n.tipo)}}function K9(t,e){if(t&1&&(C(0,"option",16),A(1),D()),t&2){let n=e.$implicit;ke("value",n.tipo),X(),yt(n.tipo)}}function Q9(t,e){if(t&1&&(C(0,"option",16),A(1),D()),t&2){let n=e.$implicit;ke("value",n.tipo),X(),yt(n.tipo)}}function Y9(t,e){if(t&1){let n=Cf();C(0,"tr")(1,"td"),A(2),D(),C(3,"td"),A(4),D(),C(5,"td"),A(6),D(),C(7,"td"),A(8),D(),C(9,"td"),A(10),D(),C(11,"td")(12,"button",17),Ae("click",function(){let i=na(n).$implicit,s=ou();return ra(s.selectTipo(i))}),A(13,"Seleccionar"),D()()()}if(t&2){let n=e.$implicit;X(2),yt(n.tipo),X(2),yt(n.descripcion),X(2),yt(n.fortaleza),X(2),yt(n.debilidad),X(2),yt(n.neutral)}}var gO=(()=>{let e=class e{constructor(r){this.tipoService=r,this.tipos=[],this.tipo=new Xr,this.botonesTipoHabilitados=!1}ngOnInit(){this.tipoService.getTipo().subscribe(r=>{this.tipos=r.map(i=>de(x({},i.payload.doc.data()),{id:i.payload.doc.id}))}),this.tipo.fortaleza="No tiene",this.tipo.debilidad="No tiene",this.tipo.neutral="No tiene"}verificarCamposTipo(){this.botonesTipoHabilitados=!!this.tipo.tipo&&!!this.tipo.descripcion&&!!this.tipo.fortaleza&&!!this.tipo.debilidad&&!!this.tipo.neutral,this.tipo.tipo.trim()==" "&&(alert("Inserte un nombre valido"),this.botonesTipoHabilitados=!1),this.tipo.descripcion.trim()==" "&&(alert("Inserte una descripci\xF3n valida"),this.botonesTipoHabilitados=!1)}insertarTipo(){this.tipoService.createTipo(this.tipo),this.tipo=new Xr,this.botonesTipoHabilitados=!1}selectTipo(r){this.tipo=r,this.botonesTipoHabilitados=!0}updateTipo(){this.tipoService.updateTipo(this.tipo),this.tipo=new Xr,this.botonesTipoHabilitados=!1}deleteTipo(r){this.tipoService.deleteTipo(r),this.tipo=new Xr,this.botonesTipoHabilitados=!1}};e.\u0275fac=function(i){return new(i||e)(le(dm))},e.\u0275cmp=rn({type:e,selectors:[["app-tipo"]],decls:68,vars:12,consts:[[1,"container","pokemon-container"],[1,"pokemon-title"],[1,"pokemon-subtitle"],[1,"col-sm-4","pokemon-form"],[1,"pokemon-label"],["type","text","placeholder","Ingresa el nombre del tipo","maxlength","10","required","",1,"form-control","pokemon-input",3,"ngModelChange","change","ngModel"],["type","text","name","","id","","placeholder","Ingresa una descripci\xF3n","cols","30","rows","5","maxlength","255","required","",1,"form-control","pokemon-input",3,"ngModelChange","change","ngModel"],["required","",1,"form-control","pokemon-select",3,"ngModelChange","change","ngModel"],["value","No tiene","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary","pokemon-btn",3,"click","disabled"],["type","button",1,"btn","btn-warning","pokemon-btn",3,"click","disabled"],["type","button",1,"btn","btn-danger","pokemon-btn",3,"click","disabled"],[1,"row"],[1,"col-12","table","pokemon-table"],[4,"ngFor","ngForOf"],[3,"value"],["type","button",1,"btn","btn-primary","pokemon-btn",3,"click"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"h1",1),A(2,"Tipos de Pok\xE9mon"),D(),C(3,"h4",2),A(4,"Alta de Tipos"),D(),C(5,"div",3)(6,"label",4),A(7,"* Obligatorio"),D(),Ge(8,"br")(9,"br"),C(10,"p")(11,"label",4),A(12,"Tipo*"),D(),C(13,"input",5),qt("ngModelChange",function(a){return on(s.tipo.tipo,a)||(s.tipo.tipo=a),a}),Ae("change",function(){return s.verificarCamposTipo()}),D()(),C(14,"p")(15,"label",4),A(16,"Descripci\xF3n*"),D(),C(17,"textarea",6),qt("ngModelChange",function(a){return on(s.tipo.descripcion,a)||(s.tipo.descripcion=a),a}),Ae("change",function(){return s.verificarCamposTipo()}),D()(),C(18,"p")(19,"label",4),A(20,"Selecciona la Fortaleza: *"),D(),C(21,"select",7),qt("ngModelChange",function(a){return on(s.tipo.fortaleza,a)||(s.tipo.fortaleza=a),a}),Ae("change",function(){return s.verificarCamposTipo()}),C(22,"option",8),A(23,"No tiene"),D(),kn(24,z9,2,2,"option",9),D()(),C(25,"p")(26,"label",4),A(27,"Selecciona la Debilidad: *"),D(),C(28,"select",7),qt("ngModelChange",function(a){return on(s.tipo.debilidad,a)||(s.tipo.debilidad=a),a}),Ae("change",function(){return s.verificarCamposTipo()}),C(29,"option",8),A(30,"No tiene"),D(),kn(31,K9,2,2,"option",9),D()(),C(32,"p")(33,"label",4),A(34,"Selecciona tipo Neutral: *"),D(),C(35,"select",7),qt("ngModelChange",function(a){return on(s.tipo.neutral,a)||(s.tipo.neutral=a),a}),Ae("change",function(){return s.verificarCamposTipo()}),C(36,"option",8),A(37,"No tiene"),D(),kn(38,Q9,2,2,"option",9),D()(),C(39,"table")(40,"tr")(41,"td")(42,"button",10),Ae("click",function(){return s.insertarTipo()}),A(43,"Insertar"),D()(),C(44,"td")(45,"button",11),Ae("click",function(){return s.updateTipo()}),A(46,"Actualizar"),D()(),C(47,"td")(48,"button",12),Ae("click",function(){return s.deleteTipo(s.tipo.id)}),A(49,"Eliminar"),D()()()()(),Ge(50,"br"),C(51,"div",13)(52,"table",14)(53,"thead")(54,"th"),A(55,"Tipo"),D(),C(56,"th"),A(57,"Descripci\xF3n"),D(),C(58,"th"),A(59,"Fortalezas"),D(),C(60,"th"),A(61,"Debilidades"),D(),C(62,"th"),A(63,"Neutral"),D(),C(64,"th"),A(65,"Acciones"),D()(),C(66,"tbody"),kn(67,Y9,14,5,"tr",15),D()()()()),i&2&&(X(13),Ht("ngModel",s.tipo.tipo),X(4),Ht("ngModel",s.tipo.descripcion),X(4),Ht("ngModel",s.tipo.fortaleza),X(3),ke("ngForOf",s.tipos),X(4),Ht("ngModel",s.tipo.debilidad),X(3),ke("ngForOf",s.tipos),X(4),Ht("ngModel",s.tipo.neutral),X(3),ke("ngForOf",s.tipos),X(4),ke("disabled",!s.botonesTipoHabilitados),X(3),ke("disabled",!s.botonesTipoHabilitados),X(3),ke("disabled",!s.botonesTipoHabilitados),X(19),ke("ngForOf",s.tipos))},dependencies:[Nf,_m,vm,fc,pc,mm,sd,od,id],styles:[".pokemon-container[_ngcontent-%COMP%]{background-color:#f3f3f3;padding:20px;border-radius:10px}.pokemon-title[_ngcontent-%COMP%]{color:#e51400;text-align:center}.pokemon-subtitle[_ngcontent-%COMP%]{color:#06c;margin-top:20px}.pokemon-form[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:10px;margin-top:20px}.pokemon-label[_ngcontent-%COMP%]{color:#000;font-weight:700}.pokemon-input[_ngcontent-%COMP%], .pokemon-select[_ngcontent-%COMP%]{border:1px solid #999}.pokemon-table[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #999;width:100%}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .pokemon-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;text-align:center}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, .pokemon-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{border-right:1px solid #999}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, .pokemon-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-left:1px solid #999}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .pokemon-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid #999}.pokemon-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f3f3f3}.pokemon-btn[_ngcontent-%COMP%]{background-color:#ffcb05;color:#000;margin-right:5px}.pokemon-btn[_ngcontent-%COMP%]:hover{background-color:#ffc200}"]});let t=e;return t})();var mO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=rn({type:e,selectors:[["app-about"]],decls:25,vars:0,consts:[[1,"container","pokemon-container"],[1,"pokemon-title"],[1,"creators"],[1,"pokemon-subtitle"],[1,"pokemon-list"],["src","./assets/entrenador.png","alt","Imagen 1"],["src","./assets/entrenador.png","alt","Imagen 2"],["src","./assets/entrenador.png","alt","Imagen 3"],[1,"additional-info"],[1,"pokemon-info"]],template:function(i,s){i&1&&(C(0,"div",0)(1,"h1",1),A(2,"Acerca de"),D(),C(3,"div",2)(4,"h2",3),A(5,"Desarrolladores:"),D(),C(6,"ul",4)(7,"li"),Ge(8,"img",5),A(9," Uriel G\xF3mez Becerril"),D(),C(10,"li"),Ge(11,"img",6),A(12," Diana Paola Hern\xE1ndez Vel\xE1zquez"),D(),C(13,"li"),Ge(14,"img",7),A(15," Oscar Gabriel Res\xE9ndiz Ram\xEDrez"),D()()(),C(16,"div",8)(17,"p",9),A(18,"Esta p\xE1gina fue creada como proyecto final para la materia de Desarrollo y Gesti\xF3n de Software Multiplataforma, impartida en la Universidad Tecnologica de San Juan del R\xEDo. Los estudiantes actualmente se encuentran en el 8vo cuatrimestre de la carrera de Ingenier\xEDa en Desarrollo y Gesti\xF3n de Software Multiplataforma."),D(),C(19,"p",9),A(20,"El objetivo principal del proyecto fue aplicar los conocimientos adquiridos durante el curso, incluyendo el desarrollo de aplicaciones web utilizando tecnolog\xEDas como Angular para el desarrollo de la misma."),D(),C(21,"p",9),A(22,"Nos inspiramos en el fascinante mundo de Pok\xE9mon para crear una Pok\xE9dex virtual, una herramienta que permite a los entrenadores Pok\xE9mon explorar informaci\xF3n detallada sobre diferentes especies de Pok\xE9mon, incluyendo sus caracter\xEDsticas, habilidades y m\xE1s."),D(),C(23,"p",9),A(24,"A lo largo del desarrollo del proyecto, nos esforzamos por crear una experiencia interactiva y atractiva para los usuarios, manteniendo siempre el esp\xEDritu y la esencia de la franquicia Pok\xE9mon."),D()()())},styles:['.pokemon-container[_ngcontent-%COMP%]{background-color:#f3f3f3;padding:20px;border-radius:10px}.pokemon-title[_ngcontent-%COMP%]{color:#e51400;text-align:center}.pokemon-subtitle[_ngcontent-%COMP%]{color:#06c;margin-top:30px}.pokemon-list[_ngcontent-%COMP%]{list-style:none;padding:0;text-align:center;display:flex;flex-direction:column;align-items:center}.pokemon-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:1.2em;color:#000;margin-bottom:10px;display:flex;align-items:center}.pokemon-list[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:30px;margin-right:10px}.pokeball[_ngcontent-%COMP%]{position:relative;width:250px;height:250px;background-color:#f5f5f5;border:10px solid black;border-radius:50%;overflow:hidden}.pokeball[_ngcontent-%COMP%]:before{content:"";position:absolute;background:red;width:100%;height:50%}.pokeball[_ngcontent-%COMP%]:after{content:"";position:absolute;top:calc(50% - 5px);width:100%;height:50%;background:#f5f5f5;border-top:10px solid}.pokeball-centro[_ngcontent-%COMP%]{position:absolute;width:50px;height:50px;border:10px solid;border-radius:50%;top:calc(50% - 24px);left:calc(50% - 24px);z-index:10;box-shadow:0 0 0 2px #000;background:#fff}']});let t=e;return t})();var Z9=[{path:"pokemon",component:pO},{path:"tipo",component:gO},{path:"home",component:vD},{path:"about",component:mO},{path:"**",component:vD}],yO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=je({type:e}),e.\u0275inj=Le({imports:[Uw.forRoot(Z9),Uw]});let t=e;return t})();var _O=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=rn({type:e,selectors:[["app-menu"]],decls:17,vars:0,consts:[[1,"nav","nav-tabs","nav-justified","pokemon-nav"],[1,"nav-item"],["routerLink","/home",1,"nav-link"],["src","./assets/inicio_icono.png","alt","Inicio",1,"nav-icon"],["routerLink","/pokemon",1,"nav-link"],["src","./assets/pokemon_icono.png","alt","Pok\xE9mon",1,"nav-icon"],["routerLink","/tipo",1,"nav-link"],["src","./assets/tipos_icono.png","alt","Tipos",1,"nav-icon"],["routerLink","/about",1,"nav-link"],["src","./assets/psyduck.png","alt","Tipos",1,"nav-icon"]],template:function(i,s){i&1&&(C(0,"ul",0)(1,"li",1)(2,"a",2),Ge(3,"img",3),A(4," Inicio "),D()(),C(5,"li",1)(6,"a",4),Ge(7,"img",5),A(8," Pok\xE9mon "),D()(),C(9,"li",1)(10,"a",6),Ge(11,"img",7),A(12," Tipos "),D()(),C(13,"li",1)(14,"a",8),Ge(15,"img",9),A(16," Acerca de... "),D()()())},dependencies:[ep],styles:[".pokemon-nav[_ngcontent-%COMP%]{background-color:#f3f3f3;border:2px solid #ffcb05;border-radius:10px;padding:10px}.nav-item[_ngcontent-%COMP%]{margin-right:10px}.nav-link[_ngcontent-%COMP%]{color:#333;font-weight:700;text-transform:uppercase}.nav-icon[_ngcontent-%COMP%]{width:24px;height:24px;margin-right:5px}"]});let t=e;return t})();var vO=(()=>{let e=class e{constructor(){this.title="pokemon"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=rn({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(i,s){i&1&&Ge(0,"app-menu")(1,"router-outlet")},dependencies:[Pw,_O]});let t=e;return t})();var J3="auth";var Em=class{constructor(){return Nu(J3)}};var ad=class{constructor(e){return e}},wO="firestore",wD=class{constructor(){return Nu(wO)}};var ED=new k("angularfire2.firestore-instances");function e5(t,e){let n=Hw(wO,t,e);return n&&new ad(n)}function t5(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new ad(r)}}var n5={provide:wD,deps:[[new nn,ED]]},r5={provide:ad,useFactory:e5,deps:[[new nn,ED],Os]},i5=(()=>{class t{constructor(){gt("angularfire",mn.full,"fst")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=je({type:t});static \u0275inj=Le({providers:[r5,n5]})}return t})();function EO(t,...e){return{ngModule:i5,providers:[{provide:ED,useFactory:t5(t),multi:!0,deps:[ie,$t,Zn,ku,[new nn,Em],[new nn,Fn],...e]}]}}var IO=Pu(w1,!0);var CO="@firebase/database",DO="1.0.3";var PT="";function kT(t){PT=t}var xD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),nt(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Wd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var MD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Dn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var tF=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new xD(e)}}catch{}return new MD},mo=tF("localStorage"),RD=tF("sessionStorage");var _c=new hi("@firebase/database"),nF=function(){let t=1;return function(){return t++}}(),rF=function(t){let e=Ab(t),n=new Sb;n.update(e);let r=n.digest();return Hd.encodeByteArray(r)},Rd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Rd.apply(null,r):typeof r=="object"?e+=nt(r):e+=r,e+=" "}return e},yo=null,TO=!0,iF=function(t,e){b(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(_c.logLevel=Tn.VERBOSE,yo=_c.log.bind(_c),e&&RD.set("logging_enabled",!0)):typeof t=="function"?yo=t:(yo=null,RD.remove("logging_enabled"))},Ct=function(...t){if(TO===!0&&(TO=!1,yo===null&&RD.get("logging_enabled")===!0&&iF(!0)),yo){let e=Rd.apply(null,t);yo(e)}},Nd=function(t){return function(...e){Ct(t,...e)}},ND=function(...t){let e="FIREBASE INTERNAL ERROR: "+Rd(...t);_c.error(e)},Lr=function(...t){let e=`FIREBASE FATAL ERROR: ${Rd(...t)}`;throw _c.error(e),new Error(e)},Vt=function(...t){let e="FIREBASE WARNING: "+Rd(...t);_c.warn(e)},s5=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Vt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Qm=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},o5=function(t){if(ar()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},is="[MIN_NAME]",ui="[MAX_NAME]",vo=function(t,e){if(t===e)return 0;if(t===is||e===ui)return-1;if(e===is||t===ui)return 1;{let n=bO(t),r=bO(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},a5=function(t,e){return t===e?0:t<e?-1:1},cd=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+nt(e))},OT=function(t){if(typeof t!="object"||t===null)return nt(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=nt(e[r]),n+=":",n+=OT(t[e[r]]);return n+="}",n},sF=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Dt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var oF=function(t){b(!Qm(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let l=u.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(l.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},c5=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},u5=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function l5(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var d5=new RegExp("^-?(0*)\\d{1,10}$"),h5=-2147483648,f5=2147483647,bO=function(t){if(d5.test(t)){let e=Number(t);if(e>=h5&&e<=f5)return e}return null},Sc=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Vt("Exception was thrown by user callback.",n),e},Math.floor(0))}},p5=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},hd=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var PD=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Vt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var kD=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Vt(e)}},fd=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Cm="5",aF="v",cF="s",uF="r",lF="f",dF=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,hF="ls",fF="p",OD="ac",pF="websocket",gF="long_polling";var Dm=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=mo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&mo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function g5(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function mF(t,e,n){b(typeof e=="string","typeof type must == string"),b(typeof n=="object","typeof params must == object");let r;if(e===pF)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===gF)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);g5(t)&&(n.ns=t.namespace);let i=[];return Dt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var FD=class{constructor(){this.counters_={}}incrementCounter(e,n=1){Dn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return wb(this.counters_)}};var ID={},CD={};function FT(t){let e=t.toString();return ID[e]||(ID[e]=new FD),ID[e]}function m5(t,e){let n=t.toString();return CD[n]||(CD[n]=e()),CD[n]}var VD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Sc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var SO="start",y5="close",_5="pLPCommand",v5="pRTLPCB",yF="id",_F="pw",vF="ser",w5="cb",E5="seg",I5="ts",C5="d",D5="dframe",wF=1870,EF=30,T5=wF-EF,b5=25e3,S5=3e4,yd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Nd(e),this.stats_=FT(n),this.urlFn=c=>(this.appCheckToken&&(c[OD]=this.appCheckToken),mF(n,gF,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new VD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(S5)),o5(()=>{if(this.isClosed_)return;this.scriptTagHolder=new LD((...s)=>{let[o,a,c,u,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===SO)this.id=a,this.password=c;else if(o===y5)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[SO]="t",r[vF]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[w5]=this.scriptTagHolder.uniqueCallbackIdentifier),r[aF]=Cm,this.transportSessionId&&(r[cF]=this.transportSessionId),this.lastSessionId&&(r[hF]=this.lastSessionId),this.applicationId&&(r[fF]=this.applicationId),this.appCheckToken&&(r[OD]=this.appCheckToken),typeof location<"u"&&location.hostname&&dF.test(location.hostname)&&(r[uF]=lF);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ar()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!c5()&&!u5()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=nt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=vb(n),i=sF(r,T5);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(ar())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[D5]="t",r[yF]=e,r[_F]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=nt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},LD=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ar())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=nF(),window[_5+this.uniqueCallbackIdentifier]=e,window[v5+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ct("frame writing exception"),a.stack&&Ct(a.stack),Ct(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ct("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[yF]=this.myID,e[_F]=this.myPW,e[vF]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+EF+r.length<=wF;){let o=this.pendingSegs.shift();r=r+"&"+E5+i+"="+o.seg+"&"+I5+i+"="+o.ts+"&"+C5+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(b5)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){ar()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var A5=16384,x5=45e3,Tm=null;typeof MozWebSocket<"u"?Tm=MozWebSocket:typeof WebSocket<"u"&&(Tm=WebSocket);var mc=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Nd(this.connId),this.stats_=FT(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[aF]=Cm,!ar()&&typeof location<"u"&&location.hostname&&dF.test(location.hostname)&&(a[uF]=lF),r&&(a[cF]=r),i&&(a[hF]=i),s&&(a[OD]=s),o&&(a[fF]=o),mF(n,pF,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,mo.set("previous_websocket_failure",!0);try{let i;if(ar()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Cm}/${PT}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Tm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Tm!==null&&!t.forceDisallow_}static previouslyFailed(){return mo.isInMemoryStorage||mo.get("previous_websocket_failure")===!0}markConnectionHealthy(){mo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Wd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(b(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=nt(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=sF(r,A5);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(x5))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),IF=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[yd,mc]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=mc&&mc.isAvailable(),i=r&&!mc.previouslyFailed();if(n.webSocketOnly&&(r||Vt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[mc];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),M5=6e4,R5=5e3,N5=10*1024,P5=100*1024,DD="t",AO="d",k5="s",xO="r",O5="e",MO="o",RO="a",NO="n",PO="p",F5="h",jD=class{constructor(e,n,r,i,s,o,a,c,u,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Nd("c:"+this.id+":"),this.transportManager_=new IF(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=hd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>P5?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>N5?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(DD in e){let n=e[DD];n===RO?this.upgradeIfSecondaryHealthy_():n===xO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===MO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=cd("t",e),r=cd("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:RO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:NO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=cd("t",e),r=cd("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=cd(DD,e);if(AO in e){let r=e[AO];if(n===F5){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===NO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===k5?this.onConnectionShutdown_(r):n===xO?this.onReset_(r):n===O5?ND("Server Error: "+r):n===MO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ND("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Cm!==r&&Vt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),hd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(M5))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):hd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(R5))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(mo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var bm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Sm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},b(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){b(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Am=class t extends Sm{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!yy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return b(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var kO=32,OO=768,we=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function ve(){return new we("")}function se(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ss(t){return t.pieces_.length-t.pieceNum_}function Me(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new we(t.pieces_,e)}function VT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function V5(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function _d(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function CF(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new we(e,0)}function Be(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof we)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new we(n,0)}function oe(t){return t.pieceNum_>=t.pieces_.length}function Qt(t,e){let n=se(t),r=se(e);if(n===null)return e;if(n===r)return Qt(Me(t),Me(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function L5(t,e){let n=_d(t,0),r=_d(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=vo(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function LT(t,e){if(ss(t)!==ss(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function $n(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(ss(t)>ss(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var UD=class{constructor(e,n){this.errorPrefix_=n,this.parts_=_d(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=kc(this.parts_[r]);DF(this)}};function j5(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=kc(e),DF(t)}function U5(t){let e=t.parts_.pop();t.byteLength_-=kc(e),t.parts_.length>0&&(t.byteLength_-=1)}function DF(t){if(t.byteLength_>OO)throw new Error(t.errorPrefix_+"has a key path longer than "+OO+" bytes ("+t.byteLength_+").");if(t.parts_.length>kO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+kO+") or object contains a cycle "+go(t))}function go(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var BD=class t extends Sm{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return b(e==="visible","Unknown event type: "+e),[this.visible_]}};var ud=1e3,B5=60*5*1e3,FO=30*1e3,$5=1.3,H5=3e4,q5="server_kill",VO=3,jT=(()=>{class t extends bm{constructor(n,r,i,s,o,a,c,u){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=t.nextPersistentConnectionId_++,this.log_=Nd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ud,this.maxReconnectDelay_=B5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!ar())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");BD.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Am.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(nt(o)),b(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new pt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),b(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),b(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,l=c.s;t.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,u))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&Dn(n,"w")){let i=di(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Vt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Tb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=FO)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=Db(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),b(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+nt(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):ND("Unrecognized action received from server: "+nt(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){b(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ud,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=ud,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>H5&&(this.reconnectDelay_=ud),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*$5)}this.onConnectStatus_(!1)}establishConnection_(){return _(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},l=function(h){b(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:u,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Ct("getToken() completed but was canceled"):(Ct("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new jD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Vt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(q5)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Vt(h),u())}}})}interrupt(n){Ct("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Ct("Resuming connection for reason: "+n),delete this.interruptReasons_[n],zd(this.interruptReasons_)&&(this.reconnectDelay_=ud,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>OT(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new we(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Ct("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=VO&&(this.reconnectDelay_=FO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Ct("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=VO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";ar()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+PT.replace(/\./g,"-")]=1,yy()?n["framework.cordova"]=1:Eb()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Am.getInstance().currentlyOnline();return zd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ce=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var vc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ce(is,e),i=new ce(is,n);return this.compare(r,i)!==0}minPost(){return ce.MIN}};var Im,xm=class extends vc{static get __EMPTY_NODE(){return Im}static set __EMPTY_NODE(e){Im=e}compare(e,n){return vo(e.name,n.name)}isDefinedOn(e){throw Do("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ce.MIN}maxPost(){return new ce(ui,Im)}makePost(e,n){return b(typeof e=="string","KeyIndex indexValue must always be a string."),new ce(e,Im)}toString(){return".key"}},Vr=new xm;var yc=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},sr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Hn.EMPTY_NODE,this.right=o??Hn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Hn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Hn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),$D=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new sr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Hn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,sr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,sr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new yc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new yc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new yc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new yc(this.root_,null,this.comparator_,!0,e)}};Hn.EMPTY_NODE=new $D;function G5(t,e){return vo(t.name,e.name)}function UT(t,e){return vo(t,e)}var HD;function W5(t){HD=t}var TF=function(t){return typeof t=="number"?"number:"+oF(t):"string:"+t},bF=function(t){if(t.isLeafNode()){let e=t.val();b(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Dn(e,".sv"),"Priority must be a string or number.")}else b(t===HD||t.isEmpty(),"priority of unexpected type.");b(t===HD||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var LO,wc=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,b(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),bF(this.priorityNode_)}static set __childrenNodeConstructor(n){LO=n}static get __childrenNodeConstructor(){return LO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return oe(n)?this:se(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=se(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(b(i!==".priority"||ss(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Me(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+TF(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=oF(this.value_):n+=this.value_,this.lazyHash_=rF(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(b(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return b(s>=0,"Unknown leaf type: "+r),b(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),SF,AF;function z5(t){SF=t}function K5(t){AF=t}var qD=class extends vc{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?vo(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ce.MIN}maxPost(){return new ce(ui,new wc("[PRIORITY-POST]",AF))}makePost(e,n){let r=SF(e);return new ce(n,new wc("[PRIORITY-POST]",r))}toString(){return".priority"}},Ne=new qD;var Q5=Math.log(2),GD=class{constructor(e){let n=s=>parseInt(Math.log(s)/Q5,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Mm=function(t,e,n,r){t.sort(e);let i=function(c,u){let l=u-c,d,h;if(l===0)return null;if(l===1)return d=t[c],h=n?n(d):d,new sr(h,d.node,sr.BLACK,null,null);{let f=parseInt(l/2,10)+c,p=i(c,f),g=i(f+1,u);return d=t[f],h=n?n(d):d,new sr(h,d.node,sr.BLACK,p,g)}},s=function(c){let u=null,l=null,d=t.length,h=function(p,g){let v=d-p,T=d;d-=p;let F=i(v+1,T),S=t[v],H=n?n(S):S;f(new sr(H,S.node,g,null,F))},f=function(p){u?(u.left=p,u=p):(l=p,u=p)};for(let p=0;p<c.count;++p){let g=c.nextBitIsOne(),v=Math.pow(2,c.count-(p+1));g?h(v,sr.BLACK):(h(v,sr.BLACK),h(v,sr.RED))}return l},o=new GD(t.length),a=s(o);return new Hn(r||e,a)};var TD,gc={},Ec=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return b(gc&&Ne,"ChildrenNode.ts has not been loaded"),TD=TD||new t({".priority":gc},{".priority":Ne}),TD}get(e){let n=di(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Hn?n:null}hasIndex(e){return Dn(this.indexSet_,e.toString())}addIndex(e,n){b(e!==Vr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ce.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Mm(r,e.getCompare()):a=gc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let l=Object.assign({},this.indexes_);return l[c]=a,new t(l,u)}addToIndexes(e,n){let r=Pc(this.indexes_,(i,s)=>{let o=di(this.indexSet_,s);if(b(o,"Missing index implementation for "+s),i===gc)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(ce.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),Mm(a,o.getCompare())}else return gc;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new ce(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Pc(this.indexes_,i=>{if(i===gc)return i;{let s=n.get(e.name);return s?i.remove(new ce(e.name,s)):i}});return new t(r,this.indexSet_)}};var ld,ee=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&bF(this.priorityNode_),this.children_.isEmpty()&&b(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ld||(ld=new t(new Hn(UT),null,Ec.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ld}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?ld:r}}getChild(n){let r=se(n);return r===null?this:this.getImmediateChild(r).getChild(Me(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(b(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ce(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?ld:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=se(n);if(i===null)return r;{b(se(n)!==".priority"||ss(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Me(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ne,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+TF(this.getPriority().val())+":"),this.forEachChild(Ne,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":rF(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ce(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ce(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ce(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ce.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Pd?-1:0}withIndex(n){if(n===Vr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Vr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ne),s=r.getIterator(Ne),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Vr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),WD=class extends ee{constructor(){super(new Hn(UT),ee.EMPTY_NODE,Ec.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ee.EMPTY_NODE}isEmpty(){return!1}},Pd=new WD;Object.defineProperties(ce,{MIN:{value:new ce(is,ee.EMPTY_NODE)},MAX:{value:new ce(ui,Pd)}});xm.__EMPTY_NODE=ee.EMPTY_NODE;wc.__childrenNodeConstructor=ee;W5(Pd);K5(Pd);var Y5=!0;function He(t,e=null){if(t===null)return ee.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),b(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new wc(n,He(e))}if(!(t instanceof Array)&&Y5){let n=[],r=!1;if(Dt(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=He(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ce(o,c)))}}),n.length===0)return ee.EMPTY_NODE;let s=Mm(n,G5,o=>o.name,UT);if(r){let o=Mm(n,Ne.getCompare());return new ee(s,He(e),new Ec({".priority":o},{".priority":Ne}))}else return new ee(s,He(e),Ec.Default)}else{let n=ee.EMPTY_NODE;return Dt(t,(r,i)=>{if(Dn(t,r)&&r.substring(0,1)!=="."){let s=He(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(He(e))}}z5(He);var vd=class extends vc{constructor(e){super(),this.indexPath_=e,b(!oe(e)&&se(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?vo(e.name,n.name):s}makePost(e,n){let r=He(e),i=ee.EMPTY_NODE.updateChild(this.indexPath_,r);return new ce(n,i)}maxPost(){let e=ee.EMPTY_NODE.updateChild(this.indexPath_,Pd);return new ce(ui,e)}toString(){return _d(this.indexPath_,0).join("/")}};var zD=class extends vc{compare(e,n){let r=e.node.compareTo(n.node);return r===0?vo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ce.MIN}maxPost(){return ce.MAX}makePost(e,n){let r=He(e);return new ce(n,r)}toString(){return".value"}},BT=new zD;function xF(t){return{type:"value",snapshotNode:t}}function Ic(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function wd(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ed(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Z5(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Id=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){b(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(wd(n,a)):b(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ic(n,r)):o.trackChildChange(Ed(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ne,(i,s)=>{n.hasChild(i)||r.trackChildChange(wd(i,s))}),n.isLeafNode()||n.forEachChild(Ne,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Ed(i,s,o))}else r.trackChildChange(Ic(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ee.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Rm=class t{constructor(e){this.indexedFilter_=new Id(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ce(n,r))||(r=ee.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=ee.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ee.EMPTY_NODE);let s=this;return n.forEachChild(Ne,(o,a)=>{s.matches(new ce(o,a))||(i=i.updateImmediateChild(o,ee.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var KD=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Rm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ce(n,r))||(r=ee.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=ee.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ee.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ee.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ee.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;b(a.numChildren()===this.limit_,"");let c=new ce(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(Ed(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(wd(n,d));let g=a.updateImmediateChild(n,ee.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(Ic(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(u,c)>=0?(s!=null&&(s.trackChildChange(wd(u.name,u.node)),s.trackChildChange(Ic(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,ee.EMPTY_NODE)):e}};var Cd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ne}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return b(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return b(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:is}hasEnd(){return this.endSet_}getIndexEndValue(){return b(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return b(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ui}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return b(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ne}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function X5(t){return t.loadsAllData()?new Id(t.getIndex()):t.hasLimit()?new KD(t):new Rm(t)}function J5(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function e6(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function QD(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function t6(t,e,n){let r;return t.index_===Vr||n?r=QD(t,e,n):r=QD(t,e,ui),r.startAfterSet_=!0,r}function YD(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function n6(t,e,n){let r;return t.index_===Vr||n?r=YD(t,e,n):r=YD(t,e,is),r.endBeforeSet_=!0,r}function Ym(t,e){let n=t.copy();return n.index_=e,n}function jO(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Ne?n="$priority":t.index_===BT?n="$value":t.index_===Vr?n="$key":(b(t.index_ instanceof vd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=nt(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=nt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+nt(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=nt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+nt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function UO(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ne&&(e.i=t.index_.toString()),e}var ZD=class t extends bm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Nd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(b(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=jO(e._queryParams);this.restRequest_(s+".json",c,(u,l)=>{let d=l;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(s,d,!1,r),di(this.listens_,o)===a){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=jO(e._queryParams),r=e._path.toString(),i=new pt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+bb(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Wd(a.responseText)}catch{Vt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Vt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var XD=class{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Nm(){return{value:null,children:new Map}}function Ac(t,e,n){if(oe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=se(e);t.children.has(r)||t.children.set(r,Nm());let i=t.children.get(r);e=Me(e),Ac(i,e,n)}}function JD(t,e){if(oe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Ne,(r,i)=>{Ac(t,new we(r),i)}),JD(t,e)}}else if(t.children.size>0){let n=se(e);return e=Me(e),t.children.has(n)&&JD(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function eT(t,e,n){t.value!==null?n(e,t.value):r6(t,(r,i)=>{let s=new we(e.toString()+"/"+r);eT(i,s,n)})}function r6(t,e){t.children.forEach((n,r)=>{e(r,n)})}var tT=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Dt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var BO=10*1e3,i6=30*1e3,s6=5*60*1e3,nT=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new tT(e);let r=BO+(i6-BO)*Math.random();hd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;Dt(e,(i,s)=>{s>0&&Dn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),hd(this.reportStats_.bind(this),Math.floor(Math.random()*2*s6))}};var Fr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Fr||{});function $T(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function HT(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function qT(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var rT=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Fr.ACK_USER_WRITE,this.source=$T()}operationForChild(e){if(oe(this.path)){if(this.affectedTree.value!=null)return b(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new we(e));return new t(ve(),n,this.revert)}}else return b(se(this.path)===e,"operationForChild called for unrelated child."),new t(Me(this.path),this.affectedTree,this.revert)}};var Pm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Fr.LISTEN_COMPLETE}operationForChild(e){return oe(this.path)?new t(this.source,ve()):new t(this.source,Me(this.path))}};var Cc=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Fr.OVERWRITE}operationForChild(e){return oe(this.path)?new t(this.source,ve(),this.snap.getImmediateChild(e)):new t(this.source,Me(this.path),this.snap)}};var Dd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Fr.MERGE}operationForChild(e){if(oe(this.path)){let n=this.children.subtree(new we(e));return n.isEmpty()?null:n.value?new Cc(this.source,ve(),n.value):new t(this.source,ve(),n)}else return b(se(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Me(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var jr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(oe(e))return this.isFullyInitialized()&&!this.filtered_;let n=se(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var iT=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function o6(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(Z5(o.childName,o.snapshotNode))}),dd(t,i,"child_removed",e,r,n),dd(t,i,"child_added",e,r,n),dd(t,i,"child_moved",s,r,n),dd(t,i,"child_changed",e,r,n),dd(t,i,"value",e,r,n),i}function dd(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>c6(t,a,c)),o.forEach(a=>{let c=a6(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,t.query_))})})}function a6(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function c6(t,e,n){if(e.childName==null||n.childName==null)throw Do("Should only compare child_ events.");let r=new ce(e.childName,e.snapshotNode),i=new ce(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Zm(t,e){return{eventCache:t,serverCache:e}}function pd(t,e,n,r){return Zm(new jr(e,n,r),t.serverCache)}function MF(t,e,n,r){return Zm(t.eventCache,new jr(e,n,r))}function km(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function _o(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var bD,u6=()=>(bD||(bD=new Hn(a5)),bD),Yt=class t{constructor(e,n=u6()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return Dt(e,(r,i)=>{n=n.set(new we(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ve(),value:this.value};if(oe(e))return null;{let r=se(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Me(e),n);return s!=null?{path:Be(new we(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(oe(e))return this;{let n=se(e),r=this.children.get(n);return r!==null?r.subtree(Me(e)):new t(null)}}set(e,n){if(oe(e))return new t(n,this.children);{let r=se(e),s=(this.children.get(r)||new t(null)).set(Me(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(oe(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=se(e),r=this.children.get(n);if(r){let i=r.remove(Me(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(oe(e))return this.value;{let n=se(e),r=this.children.get(n);return r?r.get(Me(e)):null}}setTree(e,n){if(oe(e))return n;{let r=se(e),s=(this.children.get(r)||new t(null)).setTree(Me(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(ve(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Be(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,ve(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(oe(e))return null;{let s=se(e),o=this.children.get(s);return o?o.findOnPath_(Me(e),Be(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ve(),n)}foreachOnPath_(e,n,r){if(oe(e))return this;{this.value&&r(n,this.value);let i=se(e),s=this.children.get(i);return s?s.foreachOnPath_(Me(e),Be(n,i),r):new t(null)}}foreach(e){this.foreach_(ve(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Be(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var or=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Yt(null))}};function gd(t,e,n){if(oe(e))return new or(new Yt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Qt(i,e);return s=s.updateChild(o,n),new or(t.writeTree_.set(i,s))}else{let i=new Yt(n),s=t.writeTree_.setTree(e,i);return new or(s)}}}function sT(t,e,n){let r=t;return Dt(n,(i,s)=>{r=gd(r,Be(e,i),s)}),r}function $O(t,e){if(oe(e))return or.empty();{let n=t.writeTree_.setTree(e,new Yt(null));return new or(n)}}function oT(t,e){return wo(t,e)!=null}function wo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Qt(n.path,e)):null}function HO(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ne,(r,i)=>{e.push(new ce(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ce(r,i.value))}),e}function ns(t,e){if(oe(e))return t;{let n=wo(t,e);return n!=null?new or(new Yt(n)):new or(t.writeTree_.subtree(e))}}function aT(t){return t.writeTree_.isEmpty()}function Dc(t,e){return RF(ve(),t.writeTree_,e)}function RF(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(b(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=RF(Be(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Be(t,".priority"),r)),n}}function Xm(t,e){return OF(e,t)}function l6(t,e,n,r,i){b(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=gd(t.visibleWrites,e,n)),t.lastWriteId=r}function d6(t,e,n,r){b(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=sT(t.visibleWrites,e,n),t.lastWriteId=r}function h6(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function f6(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);b(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&p6(a,r.path)?i=!1:$n(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return g6(t),!0;if(r.snap)t.visibleWrites=$O(t.visibleWrites,r.path);else{let a=r.children;Dt(a,c=>{t.visibleWrites=$O(t.visibleWrites,Be(r.path,c))})}return!0}else return!1}function p6(t,e){if(t.snap)return $n(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&$n(Be(t.path,n),e))return!0;return!1}function g6(t){t.visibleWrites=NF(t.allWrites,m6,ve()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function m6(t){return t.visible}function NF(t,e,n){let r=or.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)$n(n,o)?(a=Qt(n,o),r=gd(r,a,s.snap)):$n(o,n)&&(a=Qt(o,n),r=gd(r,ve(),s.snap.getChild(a)));else if(s.children){if($n(n,o))a=Qt(n,o),r=sT(r,a,s.children);else if($n(o,n))if(a=Qt(o,n),oe(a))r=sT(r,ve(),s.children);else{let c=di(s.children,se(a));if(c){let u=c.getChild(Me(a));r=gd(r,ve(),u)}}}else throw Do("WriteRecord should have .snap or .children")}}return r}function PF(t,e,n,r,i){if(!r&&!i){let s=wo(t.visibleWrites,e);if(s!=null)return s;{let o=ns(t.visibleWrites,e);if(aT(o))return n;if(n==null&&!oT(o,ve()))return null;{let a=n||ee.EMPTY_NODE;return Dc(o,a)}}}else{let s=ns(t.visibleWrites,e);if(!i&&aT(s))return n;if(!i&&n==null&&!oT(s,ve()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&($n(u.path,e)||$n(e,u.path))},a=NF(t.allWrites,o,e),c=n||ee.EMPTY_NODE;return Dc(a,c)}}}function y6(t,e,n){let r=ee.EMPTY_NODE,i=wo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ne,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=ns(t.visibleWrites,e);return n.forEachChild(Ne,(o,a)=>{let c=Dc(ns(s,new we(o)),a);r=r.updateImmediateChild(o,c)}),HO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=ns(t.visibleWrites,e);return HO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function _6(t,e,n,r,i){b(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Be(e,n);if(oT(t.visibleWrites,s))return null;{let o=ns(t.visibleWrites,s);return aT(o)?i.getChild(n):Dc(o,i.getChild(n))}}function v6(t,e,n,r){let i=Be(e,n),s=wo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=ns(t.visibleWrites,i);return Dc(o,r.getNode().getImmediateChild(n))}else return null}function w6(t,e){return wo(t.visibleWrites,e)}function E6(t,e,n,r,i,s,o){let a,c=ns(t.visibleWrites,e),u=wo(c,ve());if(u!=null)a=u;else if(n!=null)a=Dc(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function I6(){return{visibleWrites:or.empty(),allWrites:[],lastWriteId:-1}}function Om(t,e,n,r){return PF(t.writeTree,t.treePath,e,n,r)}function GT(t,e){return y6(t.writeTree,t.treePath,e)}function qO(t,e,n,r){return _6(t.writeTree,t.treePath,e,n,r)}function Fm(t,e){return w6(t.writeTree,Be(t.treePath,e))}function C6(t,e,n,r,i,s){return E6(t.writeTree,t.treePath,e,n,r,i,s)}function WT(t,e,n){return v6(t.writeTree,t.treePath,e,n)}function kF(t,e){return OF(Be(t.treePath,e),t.writeTree)}function OF(t,e){return{treePath:t,writeTree:e}}var cT=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;b(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),b(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Ed(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,wd(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,Ic(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Ed(r,e.snapshotNode,i.oldSnap));else throw Do("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var uT=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},FF=new uT,Td=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new jr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return WT(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:_o(this.viewCache_),s=C6(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function D6(t){return{filter:t}}function T6(t,e){b(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),b(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function b6(t,e,n,r,i){let s=new cT,o,a;if(n.type===Fr.OVERWRITE){let u=n;u.source.fromUser?o=lT(t,e,u.path,u.snap,r,i,s):(b(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!oe(u.path),o=Vm(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Fr.MERGE){let u=n;u.source.fromUser?o=A6(t,e,u.path,u.children,r,i,s):(b(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=dT(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Fr.ACK_USER_WRITE){let u=n;u.revert?o=R6(t,e,u.path,r,i,s):o=x6(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Fr.LISTEN_COMPLETE)o=M6(t,e,n.path,r,s);else throw Do("Unknown operation type: "+n.type);let c=s.getChanges();return S6(e,o,c),{viewCache:o,changes:c}}function S6(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=km(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(xF(km(e)))}}function VF(t,e,n,r,i,s){let o=e.eventCache;if(Fm(r,n)!=null)return e;{let a,c;if(oe(n))if(b(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=_o(e),l=u instanceof ee?u:ee.EMPTY_NODE,d=GT(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let u=Om(r,_o(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=se(n);if(u===".priority"){b(ss(n)===1,"Can't have a priority with additional path components");let l=o.getNode();c=e.serverCache.getNode();let d=qO(r,n,l,c);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Me(n),d;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let h=qO(r,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(u).updateChild(l,h):d=o.getNode().getImmediateChild(u)}else d=WT(r,u,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),u,d,l,i,s):a=o.getNode()}}return pd(e,a,o.isFullyInitialized()||oe(n),t.filter.filtersNodes())}}function Vm(t,e,n,r,i,s,o,a){let c=e.serverCache,u,l=o?t.filter:t.filter.getIndexedFilter();if(oe(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),f,null)}else{let f=se(n);if(!c.isCompleteForPath(n)&&ss(n)>1)return e;let p=Me(n),v=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?u=l.updatePriority(c.getNode(),v):u=l.updateChild(c.getNode(),f,v,p,FF,null)}let d=MF(e,u,c.isFullyInitialized()||oe(n),l.filtersNodes()),h=new Td(i,d,s);return VF(t,d,n,i,h,a)}function lT(t,e,n,r,i,s,o){let a=e.eventCache,c,u,l=new Td(i,e,s);if(oe(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=pd(e,u,!0,t.filter.filtersNodes());else{let d=se(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),c=pd(e,u,a.isFullyInitialized(),a.isFiltered());else{let h=Me(n),f=a.getNode().getImmediateChild(d),p;if(oe(h))p=r;else{let g=l.getCompleteChild(d);g!=null?VT(h)===".priority"&&g.getChild(CF(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=ee.EMPTY_NODE}if(f.equals(p))c=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);c=pd(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function GO(t,e){return t.eventCache.isCompleteForChild(e)}function A6(t,e,n,r,i,s,o){let a=e;return r.foreach((c,u)=>{let l=Be(n,c);GO(e,se(l))&&(a=lT(t,a,l,u,i,s,o))}),r.foreach((c,u)=>{let l=Be(n,c);GO(e,se(l))||(a=lT(t,a,l,u,i,s,o))}),a}function WO(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function dT(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;oe(n)?u=r:u=new Yt(null).setTree(n,r);let l=e.serverCache.getNode();return u.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=WO(t,f,h);c=Vm(t,c,new we(d),p,i,s,o,a)}}),u.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=WO(t,p,h);c=Vm(t,c,new we(d),g,i,s,o,a)}}),c}function x6(t,e,n,r,i,s,o){if(Fm(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(oe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Vm(t,e,n,c.getNode().getChild(n),i,s,a,o);if(oe(n)){let u=new Yt(null);return c.getNode().forEachChild(Vr,(l,d)=>{u=u.set(new we(l),d)}),dT(t,e,n,u,i,s,a,o)}else return e}else{let u=new Yt(null);return r.foreach((l,d)=>{let h=Be(n,l);c.isCompleteForPath(h)&&(u=u.set(l,c.getNode().getChild(h)))}),dT(t,e,n,u,i,s,a,o)}}function M6(t,e,n,r,i){let s=e.serverCache,o=MF(e,s.getNode(),s.isFullyInitialized()||oe(n),s.isFiltered());return VF(t,o,n,r,FF,i)}function R6(t,e,n,r,i,s){let o;if(Fm(r,n)!=null)return e;{let a=new Td(r,e,i),c=e.eventCache.getNode(),u;if(oe(n)||se(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=Om(r,_o(e));else{let d=e.serverCache.getNode();b(d instanceof ee,"serverChildren would be complete if leaf node"),l=GT(r,d)}l=l,u=t.filter.updateFullNode(c,l,s)}else{let l=se(n),d=WT(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=c.getImmediateChild(l)),d!=null?u=t.filter.updateChild(c,l,d,Me(n),a,s):e.eventCache.getNode().hasChild(l)?u=t.filter.updateChild(c,l,ee.EMPTY_NODE,Me(n),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Om(r,_o(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||Fm(r,ve())!=null,pd(e,u,o,t.filter.filtersNodes())}}var hT=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Id(r.getIndex()),s=X5(r);this.processor_=D6(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(ee.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(ee.EMPTY_NODE,a.getNode(),null),l=new jr(c,o.isFullyInitialized(),i.filtersNodes()),d=new jr(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Zm(d,l),this.eventGenerator_=new iT(this.query_)}get query(){return this.query_}};function N6(t){return t.viewCache_.serverCache.getNode()}function P6(t){return km(t.viewCache_)}function k6(t,e){let n=_o(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!oe(e)&&!n.getImmediateChild(se(e)).isEmpty())?n.getChild(e):null}function zO(t){return t.eventRegistrations_.length===0}function O6(t,e){t.eventRegistrations_.push(e)}function KO(t,e,n){let r=[];if(n){b(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function QO(t,e,n,r){e.type===Fr.MERGE&&e.source.queryId!==null&&(b(_o(t.viewCache_),"We should always have a full cache before handling merges"),b(km(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=b6(t.processor_,i,e,n,r);return T6(t.processor_,s.viewCache),b(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,LF(t,s.changes,s.viewCache.eventCache.getNode(),null)}function F6(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ne,(s,o)=>{r.push(Ic(s,o))}),n.isFullyInitialized()&&r.push(xF(n.getNode())),LF(t,r,n.getNode(),e)}function LF(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return o6(t.eventGenerator_,e,n,i)}var Lm,jm=class{constructor(){this.views=new Map}};function V6(t){b(!Lm,"__referenceConstructor has already been defined"),Lm=t}function L6(){return b(Lm,"Reference.ts has not been loaded"),Lm}function j6(t){return t.views.size===0}function zT(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return b(s!=null,"SyncTree gave us an op for an invalid query."),QO(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(QO(o,e,n,r));return s}}function jF(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Om(n,i?r:null),c=!1;a?c=!0:r instanceof ee?(a=GT(n,r),c=!1):(a=ee.EMPTY_NODE,c=!1);let u=Zm(new jr(a,c,!1),new jr(r,i,!1));return new hT(e,u)}return o}function U6(t,e,n,r,i,s){let o=jF(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),O6(o,n),F6(o,n)}function B6(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=os(t);if(i==="default")for(let[c,u]of t.views.entries())o=o.concat(KO(u,n,r)),zO(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{let c=t.views.get(i);c&&(o=o.concat(KO(c,n,r)),zO(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!os(t)&&s.push(new(L6())(e._repo,e._path)),{removed:s,events:o}}function UF(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function rs(t,e){let n=null;for(let r of t.views.values())n=n||k6(r,e);return n}function BF(t,e){if(e._queryParams.loadsAllData())return Jm(t);{let r=e._queryIdentifier;return t.views.get(r)}}function $F(t,e){return BF(t,e)!=null}function os(t){return Jm(t)!=null}function Jm(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Um;function $6(t){b(!Um,"__referenceConstructor has already been defined"),Um=t}function H6(){return b(Um,"Reference.ts has not been loaded"),Um}var q6=1,Bm=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Yt(null),this.pendingWriteTree_=I6(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function KT(t,e,n,r,i){return l6(t.pendingWriteTree_,e,n,r,i),i?xc(t,new Cc($T(),e,n)):[]}function G6(t,e,n,r){d6(t.pendingWriteTree_,e,n,r);let i=Yt.fromObject(n);return xc(t,new Dd($T(),e,i))}function ts(t,e,n=!1){let r=h6(t.pendingWriteTree_,e);if(f6(t.pendingWriteTree_,e)){let s=new Yt(null);return r.snap!=null?s=s.set(ve(),!0):Dt(r.children,o=>{s=s.set(new we(o),!0)}),xc(t,new rT(r.path,s,n))}else return[]}function kd(t,e,n){return xc(t,new Cc(HT(),e,n))}function W6(t,e,n){let r=Yt.fromObject(n);return xc(t,new Dd(HT(),e,r))}function z6(t,e){return xc(t,new Pm(HT(),e))}function K6(t,e,n){let r=QT(t,n);if(r){let i=YT(r),s=i.path,o=i.queryId,a=Qt(s,e),c=new Pm(qT(o),a);return ZT(t,s,c)}else return[]}function $m(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||$F(o,e))){let c=B6(o,e,n,r);j6(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let u=c.removed;if(a=c.events,!i){let l=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>os(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=Z6(h);for(let p=0;p<f.length;++p){let g=f[p],v=g.query,T=WF(t,g);t.listenProvider_.startListening(md(v),bd(t,v),T.hashFn,T.onComplete)}}}!d&&u.length>0&&!r&&(l?t.listenProvider_.stopListening(md(e),null):u.forEach(h=>{let f=t.queryToTagMap.get(ty(h));t.listenProvider_.stopListening(md(h),f)}))}X6(t,u)}return a}function HF(t,e,n,r){let i=QT(t,r);if(i!=null){let s=YT(i),o=s.path,a=s.queryId,c=Qt(o,e),u=new Cc(qT(a),c,n);return ZT(t,o,u)}else return[]}function Q6(t,e,n,r){let i=QT(t,r);if(i){let s=YT(i),o=s.path,a=s.queryId,c=Qt(o,e),u=Yt.fromObject(n),l=new Dd(qT(a),c,u);return ZT(t,o,l)}else return[]}function fT(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Qt(h,i);s=s||rs(f,p),o=o||os(f)});let a=t.syncPointTree_.get(i);a?(o=o||os(a),s=s||rs(a,ve())):(a=new jm,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=ee.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=rs(p,ve());g&&(s=s.updateImmediateChild(f,g))}));let u=$F(a,e);if(!u&&!e._queryParams.loadsAllData()){let h=ty(e);b(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=J6();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=Xm(t.pendingWriteTree_,i),d=U6(a,e,n,l,s,c);if(!u&&!o&&!r){let h=BF(a,e);d=d.concat(e8(t,e,h))}return d}function ey(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=Qt(o,e),u=rs(a,c);if(u)return u});return PF(i,e,s,n,!0)}function Y6(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(u,l)=>{let d=Qt(u,n);r=r||rs(l,d)});let i=t.syncPointTree_.get(n);i?r=r||rs(i,ve()):(i=new jm,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new jr(r,!0,!1):null,a=Xm(t.pendingWriteTree_,e._path),c=jF(i,e,a,s?o.getNode():ee.EMPTY_NODE,s);return P6(c)}function xc(t,e){return qF(e,t.syncPointTree_,null,Xm(t.pendingWriteTree_,ve()))}function qF(t,e,n,r){if(oe(t.path))return GF(t,e,n,r);{let i=e.get(ve());n==null&&i!=null&&(n=rs(i,ve()));let s=[],o=se(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let u=n?n.getImmediateChild(o):null,l=kF(r,o);s=s.concat(qF(a,c,u,l))}return i&&(s=s.concat(zT(i,t,r,n))),s}}function GF(t,e,n,r){let i=e.get(ve());n==null&&i!=null&&(n=rs(i,ve()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,u=kF(r,o),l=t.operationForChild(o);l&&(s=s.concat(GF(l,a,c,u)))}),i&&(s=s.concat(zT(i,t,r,n))),s}function WF(t,e){let n=e.query,r=bd(t,n);return{hashFn:()=>(N6(e)||ee.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?K6(t,n._path,r):z6(t,n._path);{let s=l5(i,n);return $m(t,n,null,s)}}}}function bd(t,e){let n=ty(e);return t.queryToTagMap.get(n)}function ty(t){return t._path.toString()+"$"+t._queryIdentifier}function QT(t,e){return t.tagToQueryMap.get(e)}function YT(t){let e=t.indexOf("$");return b(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new we(t.substr(0,e))}}function ZT(t,e,n){let r=t.syncPointTree_.get(e);b(r,"Missing sync point for query tag that we're tracking");let i=Xm(t.pendingWriteTree_,e);return zT(r,n,i,null)}function Z6(t){return t.fold((e,n,r)=>{if(n&&os(n))return[Jm(n)];{let i=[];return n&&(i=UF(n)),Dt(r,(s,o)=>{i=i.concat(o)}),i}})}function md(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(H6())(t._repo,t._path):t}function X6(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=ty(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function J6(){return q6++}function e8(t,e,n){let r=e._path,i=bd(t,e),s=WF(t,n),o=t.listenProvider_.startListening(md(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)b(!os(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((u,l,d)=>{if(!oe(u)&&l&&os(l))return[Jm(l).query];{let h=[];return l&&(h=h.concat(UF(l).map(f=>f.query))),Dt(d,(f,p)=>{h=h.concat(p)}),h}});for(let u=0;u<c.length;++u){let l=c[u];t.listenProvider_.stopListening(md(l),bd(t,l))}}return o}var pT=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},gT=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Be(this.path_,e);return new t(this.syncTree_,n)}node(){return ey(this.syncTree_,this.path_)}},t8=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},YO=function(t,e,n){if(!t||typeof t!="object")return t;if(b(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return n8(t[".sv"],e,n);if(typeof t[".sv"]=="object")return r8(t[".sv"],e);b(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},n8=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:b(!1,"Unexpected server value: "+t)}},r8=function(t,e,n){t.hasOwnProperty("increment")||b(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&b(!1,"Unexpected increment value: "+r);let i=e.node();if(b(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},zF=function(t,e,n,r){return JT(e,new gT(n,t),r)},XT=function(t,e,n){return JT(t,new pT(e),n)};function JT(t,e,n){let r=t.getPriority().val(),i=YO(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=YO(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new wc(a,He(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new wc(i))),o.forEachChild(Ne,(a,c)=>{let u=JT(c,e.getImmediateChild(a),n);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var Sd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function ny(t,e){let n=e instanceof we?e:new we(e),r=t,i=se(n);for(;i!==null;){let s=di(r.node.children,i)||{children:{},childCount:0};r=new Sd(i,r,s),n=Me(n),i=se(n)}return r}function Eo(t){return t.node.value}function eb(t,e){t.node.value=e,mT(t)}function KF(t){return t.node.childCount>0}function i8(t){return Eo(t)===void 0&&!KF(t)}function ry(t,e){Dt(t.node.children,(n,r)=>{e(new Sd(n,t,r))})}function QF(t,e,n,r){n&&!r&&e(t),ry(t,i=>{QF(i,e,!0,r)}),n&&r&&e(t)}function s8(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Od(t){return new we(t.parent===null?t.name:Od(t.parent)+"/"+t.name)}function mT(t){t.parent!==null&&o8(t.parent,t.name,t)}function o8(t,e,n){let r=i8(n),i=Dn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,mT(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,mT(t))}var a8=/[\[\].#$\/\u0000-\u001F\u007F]/,c8=/[\[\].#$\u0000-\u001F\u007F]/,SD=10*1024*1024,iy=function(t){return typeof t=="string"&&t.length!==0&&!a8.test(t)},YF=function(t){return typeof t=="string"&&t.length!==0&&!c8.test(t)},u8=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),YF(t)},Ad=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Qm(t)||t&&typeof t=="object"&&Dn(t,".sv")},Ur=function(t,e,n,r){r&&e===void 0||Fd(Jt(t,"value"),e,n)},Fd=function(t,e,n){let r=n instanceof we?new UD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+go(r));if(typeof e=="function")throw new Error(t+"contains a function "+go(r)+" with contents = "+e.toString());if(Qm(e))throw new Error(t+"contains "+e.toString()+" "+go(r));if(typeof e=="string"&&e.length>SD/3&&kc(e)>SD)throw new Error(t+"contains a string greater than "+SD+" utf8 bytes "+go(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Dt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!iy(o)))throw new Error(t+" contains an invalid key ("+o+") "+go(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);j5(r,o),Fd(t,a,r),U5(r)}),i&&s)throw new Error(t+' contains ".value" child '+go(r)+" in addition to actual children.")}},l8=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=_d(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!iy(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(L5);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&$n(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},ZF=function(t,e,n,r){if(r&&e===void 0)return;let i=Jt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Dt(e,(o,a)=>{let c=new we(o);if(Fd(i,a,Be(n,c)),VT(c)===".priority"&&!Ad(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),l8(i,s)},tb=function(t,e,n){if(!(n&&e===void 0)){if(Qm(e))throw new Error(Jt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ad(e))throw new Error(Jt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Vd=function(t,e,n,r){if(!(r&&n===void 0)&&!iy(n))throw new Error(Jt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Mc=function(t,e,n,r){if(!(r&&n===void 0)&&!YF(n))throw new Error(Jt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},d8=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Mc(t,e,n,r)},wn=function(t,e){if(se(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},XF=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!iy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!u8(n))throw new Error(Jt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var yT=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function sy(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!LT(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function JF(t,e,n){sy(t,n),eV(t,r=>LT(r,e))}function En(t,e,n){sy(t,n),eV(t,r=>$n(r,e)||$n(e,r))}function eV(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(h8(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function h8(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();yo&&Ct("event: "+n.toString()),Sc(r)}}}var tV="repo_interrupt",f8=25,_T=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new yT,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Nm(),this.transactionQueueTree_=new Sd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function p8(t,e,n){if(t.stats_=FT(t.repoInfo_),t.forceRestClient_||p5())t.server_=new ZD(t.repoInfo_,(r,i,s,o)=>{ZO(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>XO(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{nt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new jT(t.repoInfo_,e,(r,i,s,o)=>{ZO(t,r,i,s,o)},r=>{XO(t,r)},r=>{g8(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=m5(t.repoInfo_,()=>new nT(t.stats_,t.server_)),t.infoData_=new XD,t.infoSyncTree_=new Bm({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=kd(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),nb(t,"connected",!1),t.serverSyncTree_=new Bm({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);En(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function nV(t){let n=t.infoData_.getNode(new we(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Ld(t){return t8({timestamp:nV(t)})}function ZO(t,e,n,r,i){t.dataUpdateCount++;let s=new we(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=Pc(n,u=>He(u));o=Q6(t.serverSyncTree_,s,c,i)}else{let c=He(n);o=HF(t.serverSyncTree_,s,c,i)}else if(r){let c=Pc(n,u=>He(u));o=W6(t.serverSyncTree_,s,c)}else{let c=He(n);o=kd(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Tc(t,s)),En(t.eventQueue_,a,o)}function XO(t,e){nb(t,"connected",e),e===!1&&_8(t)}function g8(t,e){Dt(e,(n,r)=>{nb(t,n,r)})}function nb(t,e,n){let r=new we("/.info/"+e),i=He(n);t.infoData_.updateSnapshot(r,i);let s=kd(t.infoSyncTree_,r,i);En(t.eventQueue_,r,s)}function oy(t){return t.nextWriteId_++}function m8(t,e,n){let r=Y6(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=He(i).withIndex(e._queryParams.getIndex());fT(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=kd(t.serverSyncTree_,e._path,s);else{let a=bd(t.serverSyncTree_,e);o=HF(t.serverSyncTree_,e._path,s,a)}return En(t.eventQueue_,e._path,o),$m(t.serverSyncTree_,e,n,null,!0),s},i=>(Rc(t,"get for query "+nt(e)+" failed: "+i),Promise.reject(new Error(i))))}function rb(t,e,n,r,i){Rc(t,"set",{path:e.toString(),value:n,priority:r});let s=Ld(t),o=He(n,r),a=ey(t.serverSyncTree_,e),c=XT(o,a,s),u=oy(t),l=KT(t.serverSyncTree_,e,c,u,!0);sy(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Vt("set at "+e+" failed: "+h);let g=ts(t.serverSyncTree_,u,!p);En(t.eventQueue_,e,g),as(t,i,h,f)});let d=sb(t,e);Tc(t,d),En(t.eventQueue_,d,[])}function y8(t,e,n,r){Rc(t,"update",{path:e.toString(),value:n});let i=!0,s=Ld(t),o={};if(Dt(n,(a,c)=>{i=!1,o[a]=zF(Be(e,a),He(c),t.serverSyncTree_,s)}),i)Ct("update() called with empty data.  Don't do anything."),as(t,r,"ok",void 0);else{let a=oy(t),c=G6(t.serverSyncTree_,e,o,a);sy(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,l)=>{let d=u==="ok";d||Vt("update at "+e+" failed: "+u);let h=ts(t.serverSyncTree_,a,!d),f=h.length>0?Tc(t,e):e;En(t.eventQueue_,f,h),as(t,r,u,l)}),Dt(n,u=>{let l=sb(t,Be(e,u));Tc(t,l)}),En(t.eventQueue_,e,[])}}function _8(t){Rc(t,"onDisconnectEvents");let e=Ld(t),n=Nm();eT(t.onDisconnect_,ve(),(i,s)=>{let o=zF(i,s,t.serverSyncTree_,e);Ac(n,i,o)});let r=[];eT(n,ve(),(i,s)=>{r=r.concat(kd(t.serverSyncTree_,i,s));let o=sb(t,i);Tc(t,o)}),t.onDisconnect_=Nm(),En(t.eventQueue_,ve(),r)}function v8(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&JD(t.onDisconnect_,e),as(t,n,r,i)})}function JO(t,e,n,r){let i=He(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Ac(t.onDisconnect_,e,i),as(t,r,s,o)})}function w8(t,e,n,r,i){let s=He(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Ac(t.onDisconnect_,e,s),as(t,i,o,a)})}function E8(t,e,n,r){if(zd(n)){Ct("onDisconnect().update() called with empty data.  Don't do anything."),as(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&Dt(n,(o,a)=>{let c=He(a);Ac(t.onDisconnect_,Be(e,o),c)}),as(t,r,i,s)})}function I8(t,e,n){let r;se(e._path)===".info"?r=fT(t.infoSyncTree_,e,n):r=fT(t.serverSyncTree_,e,n),JF(t.eventQueue_,e._path,r)}function vT(t,e,n){let r;se(e._path)===".info"?r=$m(t.infoSyncTree_,e,n):r=$m(t.serverSyncTree_,e,n),JF(t.eventQueue_,e._path,r)}function rV(t){t.persistentConnection_&&t.persistentConnection_.interrupt(tV)}function C8(t){t.persistentConnection_&&t.persistentConnection_.resume(tV)}function Rc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ct(n,...e)}function as(t,e,n,r){e&&Sc(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function D8(t,e,n,r,i,s){Rc(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:nF(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=ib(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Fd("transaction failed: Data returned ",c,o.path),o.status=0;let u=ny(t.transactionQueueTree_,e),l=Eo(u)||[];l.push(o),eb(u,l);let d;typeof c=="object"&&c!==null&&Dn(c,".priority")?(d=di(c,".priority"),b(Ad(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(ey(t.serverSyncTree_,e)||ee.EMPTY_NODE).getPriority().val();let h=Ld(t),f=He(c,d),p=XT(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=oy(t);let g=KT(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);En(t.eventQueue_,e,g),ay(t,t.transactionQueueTree_)}}function ib(t,e,n){return ey(t.serverSyncTree_,e,n)||ee.EMPTY_NODE}function ay(t,e=t.transactionQueueTree_){if(e||cy(t,e),Eo(e)){let n=sV(t,e);b(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&T8(t,Od(e),n)}else KF(e)&&ry(e,n=>{ay(t,n)})}function T8(t,e,n){let r=n.map(u=>u.currentWriteId),i=ib(t,e,r),s=i,o=i.hash();for(let u=0;u<n.length;u++){let l=n[u];b(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Qt(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,u=>{Rc(t,"transaction put response",{path:c.toString(),status:u});let l=[];if(u==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(ts(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();cy(t,ny(t.transactionQueueTree_,e)),ay(t,t.transactionQueueTree_),En(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)Sc(d[h])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Vt("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}Tc(t,e)}},o)}function Tc(t,e){let n=iV(t,e),r=Od(n),i=sV(t,n);return b8(t,i,r),r}function b8(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=Qt(n,c.path),l=!1,d;if(b(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)l=!0,d=c.abortReason,i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=f8)l=!0,d="maxretry",i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0));else{let h=ib(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Fd("transaction failed: Data returned ",f,c.path);let p=He(f);typeof f=="object"&&f!=null&&Dn(f,".priority")||(p=p.updatePriority(h.getPriority()));let v=c.currentWriteId,T=Ld(t),F=XT(p,h,T);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=F,c.currentWriteId=oy(t),o.splice(o.indexOf(v),1),i=i.concat(KT(t.serverSyncTree_,c.path,F,c.currentWriteId,c.applyLocally)),i=i.concat(ts(t.serverSyncTree_,v,!0))}else l=!0,d="nodata",i=i.concat(ts(t.serverSyncTree_,c.currentWriteId,!0))}En(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}cy(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Sc(r[a]);ay(t,t.transactionQueueTree_)}function iV(t,e){let n,r=t.transactionQueueTree_;for(n=se(e);n!==null&&Eo(r)===void 0;)r=ny(r,n),e=Me(e),n=se(e);return r}function sV(t,e){let n=[];return oV(t,e,n),n.sort((r,i)=>r.order-i.order),n}function oV(t,e,n){let r=Eo(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);ry(e,i=>{oV(t,i,n)})}function cy(t,e){let n=Eo(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,eb(e,n.length>0?n:void 0)}ry(e,r=>{cy(t,r)})}function sb(t,e){let n=Od(iV(t,e)),r=ny(t.transactionQueueTree_,e);return s8(r,i=>{AD(t,i)}),AD(t,r),QF(r,i=>{AD(t,i)}),n}function AD(t,e){let n=Eo(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(b(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(b(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ts(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?eb(e,void 0):n.length=s+1,En(t.eventQueue_,Od(e),i);for(let o=0;o<r.length;o++)Sc(r[o])}}function S8(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function A8(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Vt(`Invalid query segment '${n}' in query '${t}'`)}return e}var wT=function(t,e){let n=x8(t),r=n.namespace;n.domain==="firebase.com"&&Lr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Lr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||s5();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Dm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new we(n.pathString)}},x8=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=S8(t.substring(l,d)));let h=A8(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let f=e.slice(0,u);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var eF="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",M8=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=eF.charAt(n%64),n=Math.floor(n/64);b(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=eF.charAt(e[i]);return b(o.length===20,"nextPushId: Length should be 20."),o}}();var Hm=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+nt(this.snapshot.exportVal())}},qm=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var xd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return b(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Gm=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new pt;return v8(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){wn("OnDisconnect.remove",this._path);let e=new pt;return JO(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){wn("OnDisconnect.set",this._path),Ur("OnDisconnect.set",e,this._path,!1);let n=new pt;return JO(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){wn("OnDisconnect.setWithPriority",this._path),Ur("OnDisconnect.setWithPriority",e,this._path,!1),tb("OnDisconnect.setWithPriority",n,!1);let r=new pt;return w8(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){wn("OnDisconnect.update",this._path),ZF("OnDisconnect.update",e,this._path,!1);let n=new pt;return E8(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Zt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return oe(this._path)?null:VT(this._path)}get ref(){return new In(this._repo,this._path)}get _queryIdentifier(){let e=UO(this._queryParams),n=OT(e);return n==="{}"?"default":n}get _queryObject(){return UO(this._queryParams)}isEqual(e){if(e=ue(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=LT(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+V5(this._path)}};function uy(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function us(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Vr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==is)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==ui)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ne){if(e!=null&&!Ad(e)||n!=null&&!Ad(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(b(t.getIndex()instanceof vd||t.getIndex()===BT,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function ly(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var In=class t extends Zt{constructor(e,n){super(e,n,new Cd,!1)}get parent(){let e=CF(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},bc=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new we(e),r=cs(this.ref,e);return new t(this._node.getChild(n),r,Ne)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,cs(this.ref,r),Ne)))}hasChild(e){let n=new we(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function ob(t,e){return t=ue(t),t._checkNotDeleted("ref"),e!==void 0?cs(t._root,e):t._root}function ab(t,e){t=ue(t),t._checkNotDeleted("refFromURL");let n=wT(e,t._repo.repoInfo_.nodeAdmin);XF("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Lr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),ob(t,n.path.toString())}function cs(t,e){return t=ue(t),se(t._path)===null?d8("child","path",e,!1):Mc("child","path",e,!1),new In(t._repo,Be(t._path,e))}function aV(t,e){t=ue(t),wn("push",t._path),Ur("push",e,t._path,!0);let n=nV(t._repo),r=M8(n),i=cs(t,r),s=cs(t,r),o;return e!=null?o=dy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function cV(t){return wn("remove",t._path),dy(t,null)}function dy(t,e){t=ue(t),wn("set",t._path),Ur("set",e,t._path,!1);let n=new pt;return rb(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function uV(t,e){t=ue(t),wn("setPriority",t._path),tb("setPriority",e,!1);let n=new pt;return rb(t._repo,Be(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function lV(t,e,n){if(wn("setWithPriority",t._path),Ur("setWithPriority",e,t._path,!1),tb("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new pt;return rb(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function dV(t,e){ZF("update",e,t._path,!1);let n=new pt;return y8(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function hV(t){t=ue(t);let e=new xd(()=>{}),n=new Md(e);return m8(t._repo,t,n).then(r=>new bc(r,new In(t._repo,t._path),t._queryParams.getIndex()))}var Md=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Hm("value",this,new bc(e.snapshotNode,new In(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new qm(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Wm=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new qm(this,e,n):null}createEvent(e,n){b(e.childName!=null,"Child events should have a childName.");let r=cs(new In(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Hm(e.type,this,new bc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function jd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,u=(l,d)=>{vT(t._repo,t,a),c(l,d)};u.userCallback=n.userCallback,u.context=n.context,n=u}let o=new xd(n,s||void 0),a=e==="value"?new Md(o):new Wm(e,o);return I8(t._repo,t,a),()=>vT(t._repo,t,a)}function hy(t,e,n,r){return jd(t,"value",e,n,r)}function cb(t,e,n,r){return jd(t,"child_added",e,n,r)}function ub(t,e,n,r){return jd(t,"child_changed",e,n,r)}function lb(t,e,n,r){return jd(t,"child_moved",e,n,r)}function db(t,e,n,r){return jd(t,"child_removed",e,n,r)}function hb(t,e,n){let r=null,i=n?new xd(n):null;e==="value"?r=new Md(i):e&&(r=new Wm(e,i)),vT(t._repo,t,r)}var Cn=class{},zm=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Ur("endAt",this._value,e._path,!0);let n=YD(e._queryParams,this._value,this._key);if(ly(n),us(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function fV(t,e){return Vd("endAt","key",e,!0),new zm(t,e)}var ET=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Ur("endBefore",this._value,e._path,!1);let n=n6(e._queryParams,this._value,this._key);if(ly(n),us(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function pV(t,e){return Vd("endBefore","key",e,!0),new ET(t,e)}var Km=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Ur("startAt",this._value,e._path,!0);let n=QD(e._queryParams,this._value,this._key);if(ly(n),us(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function gV(t=null,e){return Vd("startAt","key",e,!0),new Km(t,e)}var IT=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Ur("startAfter",this._value,e._path,!1);let n=t6(e._queryParams,this._value,this._key);if(ly(n),us(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Zt(e._repo,e._path,n,e._orderByCalled)}};function mV(t,e){return Vd("startAfter","key",e,!0),new IT(t,e)}var CT=class extends Cn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zt(e._repo,e._path,J5(e._queryParams,this._limit),e._orderByCalled)}};function yV(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new CT(t)}var DT=class extends Cn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zt(e._repo,e._path,e6(e._queryParams,this._limit),e._orderByCalled)}};function _V(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new DT(t)}var TT=class extends Cn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){uy(e,"orderByChild");let n=new we(this._path);if(oe(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new vd(n),i=Ym(e._queryParams,r);return us(i),new Zt(e._repo,e._path,i,!0)}};function vV(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Mc("orderByChild","path",t,!1),new TT(t)}var bT=class extends Cn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){uy(e,"orderByKey");let n=Ym(e._queryParams,Vr);return us(n),new Zt(e._repo,e._path,n,!0)}};function wV(){return new bT}var ST=class extends Cn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){uy(e,"orderByPriority");let n=Ym(e._queryParams,Ne);return us(n),new Zt(e._repo,e._path,n,!0)}};function EV(){return new ST}var AT=class extends Cn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){uy(e,"orderByValue");let n=Ym(e._queryParams,BT);return us(n),new Zt(e._repo,e._path,n,!0)}};function IV(){return new AT}var xT=class extends Cn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Ur("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new zm(this._value,this._key)._apply(new Km(this._value,this._key)._apply(e))}};function CV(t,e){return Vd("equalTo","key",e,!0),new xT(t,e)}function qn(t,...e){let n=ue(t);for(let r of e)n=r._apply(n);return n}V6(In);$6(In);var R8="FIREBASE_DATABASE_EMULATOR_HOST",MT={},N8=!1;function P8(t,e,n,r){t.repoInfo_=new Dm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function fb(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Lr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ct("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=wT(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[R8]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=wT(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let l=i&&c?new fd(fd.OWNER):new kD(t.name,t.options,e);XF("Invalid Firebase Database URL",o),oe(o.path)||Lr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=O8(a,t,l,new PD(t.name,n));return new RT(d,t)}function k8(t,e){let n=MT[e];(!n||n[t.key]!==t)&&Lr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),rV(t),delete n[t.key]}function O8(t,e,n,r){let i=MT[e.name];i||(i={},MT[e.name]=i);let s=i[t.toURLString()];return s&&Lr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new _T(t,N8,n,r),i[t.toURLString()]=s,s}var RT=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(p8(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new In(this._repo,ve())),this._rootInternal}_delete(){return this._rootInternal!==null&&(k8(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Lr("Cannot call "+e+" on a deleted database.")}};function DV(){IF.IS_TRANSPORT_INITIALIZED&&Vt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function TV(){DV(),yd.forceDisallow()}function bV(){DV(),mc.forceDisallow(),yd.forceAllow()}function SV(t,e,n,r={}){t=ue(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Lr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Lr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new fd(fd.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:qd(r.mockUserToken,t.app.options.projectId);s=new fd(o)}P8(i,e,n,s)}function AV(t){t=ue(t),t._checkNotDeleted("goOffline"),rV(t._repo)}function xV(t){t=ue(t),t._checkNotDeleted("goOnline"),C8(t._repo)}function MV(t,e){iF(t,e)}function F8(t){kT(Yd),ls(new un("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return fb(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),gt(CO,DO,t),gt(CO,DO,"esm2017")}var V8={".sv":"timestamp"};function RV(){return V8}function NV(t){return{".sv":{increment:t}}}var NT=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function PV(t,e,n){var r;if(t=ue(t),wn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new pt,o=(c,u,l)=>{let d=null;c?s.reject(c):(d=new bc(l,new In(t._repo,t._path),Ne),s.resolve(new NT(u,d)))},a=hy(t,()=>{});return D8(t._repo,t._path,e,o,a,i),s.promise}jT.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};jT.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};F8();var L8="@firebase/database-compat",j8="1.0.3";var U8=new hi("@firebase/database-compat"),kV=function(t){let e="FIREBASE WARNING: "+t;U8.warn(e)};var B8=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Jt(t,e)+"must be a boolean.")},$8=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Jt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var pb=class{constructor(e){this._delegate=e}cancel(e){q("OnDisconnect.cancel",0,1,arguments.length),ut("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){q("OnDisconnect.remove",0,1,arguments.length),ut("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){q("OnDisconnect.set",1,2,arguments.length),ut("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("OnDisconnect.setWithPriority",2,3,arguments.length),ut("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(q("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,kV("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ut("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var gb=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Io=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return q("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return q("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return q("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return q("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return q("DataSnapshot.child",0,1,arguments.length),e=String(e),Mc("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return q("DataSnapshot.hasChild",1,1,arguments.length),Mc("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return q("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return q("DataSnapshot.forEach",1,1,arguments.length),ut("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return q("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return q("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return q("DataSnapshot.ref",0,0,arguments.length),new li(this._database,this._delegate.ref)}get ref(){return this.getRef()}},fy=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;q("Query.on",2,4,arguments.length),ut("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(u,l)=>{n.call(o.context,new Io(this.database,u),l)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return hy(this._delegate,a,c),n;case"child_added":return cb(this._delegate,a,c),n;case"child_removed":return db(this._delegate,a,c),n;case"child_changed":return ub(this._delegate,a,c),n;case"child_moved":return lb(this._delegate,a,c),n;default:throw new Error(Jt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(q("Query.off",0,3,arguments.length),$8("Query.off",e,!0),ut("Query.off","callback",n,!0),wy("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,hb(this._delegate,e,i)}else hb(this._delegate,e)}get(){return hV(this._delegate).then(e=>new Io(this.database,e))}once(e,n,r,i){q("Query.once",1,4,arguments.length),ut("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new pt,a=(u,l)=>{let d=new Io(this.database,u);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":hy(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":cb(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":db(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":ub(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":lb(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Jt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return q("Query.limitToFirst",1,1,arguments.length),new t(this.database,qn(this._delegate,yV(e)))}limitToLast(e){return q("Query.limitToLast",1,1,arguments.length),new t(this.database,qn(this._delegate,_V(e)))}orderByChild(e){return q("Query.orderByChild",1,1,arguments.length),new t(this.database,qn(this._delegate,vV(e)))}orderByKey(){return q("Query.orderByKey",0,0,arguments.length),new t(this.database,qn(this._delegate,wV()))}orderByPriority(){return q("Query.orderByPriority",0,0,arguments.length),new t(this.database,qn(this._delegate,EV()))}orderByValue(){return q("Query.orderByValue",0,0,arguments.length),new t(this.database,qn(this._delegate,IV()))}startAt(e=null,n){return q("Query.startAt",0,2,arguments.length),new t(this.database,qn(this._delegate,gV(e,n)))}startAfter(e=null,n){return q("Query.startAfter",0,2,arguments.length),new t(this.database,qn(this._delegate,mV(e,n)))}endAt(e=null,n){return q("Query.endAt",0,2,arguments.length),new t(this.database,qn(this._delegate,fV(e,n)))}endBefore(e=null,n){return q("Query.endBefore",0,2,arguments.length),new t(this.database,qn(this._delegate,pV(e,n)))}equalTo(e,n){return q("Query.equalTo",1,2,arguments.length),new t(this.database,qn(this._delegate,CV(e,n)))}toString(){return q("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return q("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(q("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,ut(e,"cancel",i.cancel,!0),i.context=r,wy(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Jt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new li(this.database,new In(this._delegate._repo,this._delegate._path))}},li=class t extends fy{constructor(e,n){super(e,new Zt(n._repo,n._path,new Cd,!1)),this.database=e,this._delegate=n}getKey(){return q("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return q("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,cs(this._delegate,e))}getParent(){q("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return q("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){q("Reference.set",1,2,arguments.length),ut("Reference.set","onComplete",n,!0);let r=dy(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(q("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,kV("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wn("Reference.update",this._delegate._path),ut("Reference.update","onComplete",n,!0);let r=dV(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("Reference.setWithPriority",2,3,arguments.length),ut("Reference.setWithPriority","onComplete",r,!0);let i=lV(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){q("Reference.remove",0,1,arguments.length),ut("Reference.remove","onComplete",e,!0);let n=cV(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){q("Reference.transaction",1,3,arguments.length),ut("Reference.transaction","transactionUpdate",e,!1),ut("Reference.transaction","onComplete",n,!0),B8("Reference.transaction","applyLocally",r,!0);let i=PV(this._delegate,e,{applyLocally:r}).then(s=>new gb(s.committed,new Io(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){q("Reference.setPriority",1,2,arguments.length),ut("Reference.setPriority","onComplete",n,!0);let r=uV(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){q("Reference.push",0,2,arguments.length),ut("Reference.push","onComplete",n,!0);let r=aV(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return wn("Reference.onDisconnect",this._delegate._path),new pb(new Gm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Co=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:TV,forceLongPolling:bV}}useEmulator(e,n,r={}){SV(this._delegate,e,n,r)}ref(e){if(q("database.ref",0,1,arguments.length),e instanceof li){let n=ab(this._delegate,e.toString());return new li(this,n)}else{let n=ob(this._delegate,e);return new li(this,n)}}refFromURL(e){q("database.refFromURL",1,1,arguments.length);let r=ab(this._delegate,e);return new li(this,r)}goOffline(){return q("database.goOffline",0,0,arguments.length),AV(this._delegate)}goOnline(){return q("database.goOnline",0,0,arguments.length),xV(this._delegate)}};Co.ServerValue={TIMESTAMP:RV(),increment:t=>NV(t)};function H8({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){kT(n);let a=new Ey("database-standalone"),c=new Kd("auth-internal",a);c.setComponent(new un("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new Kd("app-check-internal",a),u.setComponent(new un("app-check-internal",()=>i,"PRIVATE"))),{instance:new Co(fb(t,c,u,e,o),t),namespace:s}}var q8=Object.freeze({__proto__:null,initStandalone:H8});var G8=Co.ServerValue;function W8(t){t.INTERNAL.registerComponent(new un("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Co(i,r)},"PUBLIC").setServiceProps({Reference:li,Query:fy,Database:Co,DataSnapshot:Io,enableLogging:MV,INTERNAL:q8,ServerValue:G8}).setMultipleInstances(!0)),t.registerVersion(L8,j8)}W8(Tt);function Ud(t,e,n="on",r=gs){return new ne(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(j(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Bc())}function z8(t){return typeof t=="string"}function K8(t){return typeof t.exportVal=="function"}function jV(t){return t==null}function UV(t){return typeof t.set=="function"}function OV(t,e){return UV(e)?e:t.ref(e)}function BV(t,e){if(z8(t))return e.stringCase();if(UV(t))return e.firebaseCase();if(K8(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function $V(t){return(jV(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function HV(t,e,n){e=$V(e);let r=e.map(i=>Ud(t,i,"on",n));return Lo(...r)}function Q8(t,e,n){let r=HV(t,e).pipe(ur((i,s)=>[...i,s],[]));return Z8(t,r,n)}function Y8(t,e){return Ud(t,"value","on",e).pipe(j(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function Z8(t,e,n){return Y8(t,n).pipe(Gy(e),j(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Hy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),j(i=>i.actions))}function FV(t,e){return function(r,i){return BV(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function X8(t){return function(n){return n?BV(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function J8(t,e,n){return Ud(t,"value","once",n).pipe(Ve(r=>{let i=[U(r)];return e.forEach(s=>i.push(Ud(t,s,"on",n))),Lo(...i).pipe(ur(tK,[]))}),Lc())}function qV(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function eK(t,e){if(jV(e))return 0;{let n=qV(t,e);return n===-1?t.length:n+1}}function tK(t,e){let{payload:n,prevKey:r,key:i}=e,s=qV(t,i),o=eK(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let u={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,u],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function VV(t,e,n){return e=$V(e),J8(t,e,n)}function nK(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:FV(r,"update"),set:FV(r,"set"),push:i=>r.push(i),remove:X8(r),snapshotChanges(i){return VV(t,i,n).pipe(We)},stateChanges(i){return HV(t,i,n).pipe(We)},auditTrail(i){return Q8(t,i,n).pipe(We)},valueChanges(i,s){return VV(t,i,n).pipe(j(a=>a.map(c=>s&&s.idField?de(x({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),We)}}}function LV(t,e){return function(){return Ud(t,"value","on",e)}}function rK(t,e){return{query:t,snapshotChanges(){return LV(t,e.schedulers.outsideAngular)().pipe(We)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return LV(t,e.schedulers.outsideAngular)().pipe(We,j(r=>r.payload.exists()?r.payload.val():null))}}}var iK=new k("angularfire2.realtimeDatabaseURL"),sK=new k("angularfire2.database.use-emulator"),oK=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,g,v){this.schedulers=a;let T=c,F=Fs(n,o,r);u&&$u(F,o,l,h,f,p,d,g),this.database=_a(`${F.name}.database.${i}`,"AngularFireDatabase",F.name,()=>{let S=o.runOutsideAngular(()=>F.database(i||void 0));return T&&S.useEmulator(...T),S},[T])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>OV(this.database,n)),s=i;return r&&(s=r(i)),nK(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>OV(this.database,n));return rK(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(E(Ni),E(Pi,8),E(iK,8),E(mt),E(ie),E(Zn),E(sK,8),E(sp,8),E(Fu,8),E(Vu,8),E(Lu,8),E(ju,8),E(Uu,8),E(Bu,8),E(Fn,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),GV=(()=>{class t{constructor(){Tt.registerVersion("angularfire",mn.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=je({type:t});static \u0275inj=Le({providers:[oK]})}return t})();var WV={production:!1,firebaseConfig:{apiKey:"AIzaSyDjZTRQ6TiLyBYyDlDXgOMPQjONeyCxNBY",authDomain:"pokemon-c3f5f.firebaseapp.com",projectId:"pokemon-c3f5f",storageBucket:"pokemon-c3f5f.appspot.com",messagingSenderId:"904972192928",appId:"1:904972192928:web:00b861e795f045a6de4dc5"}};var zV=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=je({type:e,bootstrap:[vO]}),e.\u0275inj=Le({imports:[mM,yO,hO,IR.initializeApp(WV.firebaseConfig),GV,aR(()=>cR({projectId:"pokemon-c3f5f",appId:"1:904972192928:web:00b861e795f045a6de4dc5",storageBucket:"pokemon-c3f5f.appspot.com",apiKey:"AIzaSyDjZTRQ6TiLyBYyDlDXgOMPQjONeyCxNBY",authDomain:"pokemon-c3f5f.firebaseapp.com",messagingSenderId:"904972192928"})),EO(()=>IO())]});let t=e;return t})();gM().bootstrapModule(zV).catch(t=>console.error(t));
